{"id":"coding_agent_session_search-001","title":"TUI style system spec","description":"Create docs/tui_style_spec.md: palettes (dark/light), role colors, spacing scales, gradients, motion rules, density presets, iconography grid, animation opt-out policy.","notes":"Spec drafted and checked against acceptance (colors, gradients, density, motion, accessibility, opt-out, perf guards).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.488928548Z","updated_at":"2025-11-29T06:16:18.675764962Z","closed_at":"2025-11-29T06:16:18.675773862Z"}
{"id":"coding_agent_session_search-002","title":"Interaction model \u0026 keymap RFC","description":"Audit current shortcuts; define normalized chords and fallbacks; document rationale and terminal-compat constraints.","notes":"Keymap/interaction RFC drafted; bindings, fallbacks, safety. Ready for implementation in 003/004/005.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.506467068Z","updated_at":"2025-11-29T06:16:24.354878612Z","closed_at":"2025-11-29T06:16:24.354887412Z","dependencies":[{"issue_id":"coding_agent_session_search-002","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:50:34.579678659Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-003","title":"Command palette (Ctrl+P) with fuzzy actions","description":"Non-blocking palette; categories; last-5 history; keyboard+mouse; safe when no matches.","notes":"Palette overlay complete: actions wired (theme/density/help toggle, time presets, saved view save/load slots 1-9), persisted state, help auto-hide aware, clippy/fmt/check clean.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.509223703Z","updated_at":"2025-11-29T07:11:48.205006257Z","closed_at":"2025-11-29T07:11:48.205073957Z","dependencies":[{"issue_id":"coding_agent_session_search-003","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:50:39.962705981Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-004","title":"Contextual help strip","description":"Focus-aware shortcut strip; idle fade; no flicker; respects nowrap/minimal mode.","notes":"Contextual help strip done: two-line footer with focus/palette/modal-aware shortcuts, idle auto-hide with pin, persisted pin flag.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.458444965Z","updated_at":"2025-11-29T07:11:56.104075213Z","closed_at":"2025-11-29T07:11:56.104085313Z","dependencies":[{"issue_id":"coding_agent_session_search-004","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:50:56.631761034Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-005","title":"Editable filter pills","description":"Pills for agent/workspace/time/ranking; inline edit/delete; keyboard+mouse parity; syncs with query state.","notes":"Filter pills complete: render agent/ws/time; click opens edit modes; backspace clears last filter; click hit-testing; state synced; formatting/check/clippy clean.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.462363215Z","updated_at":"2025-11-29T07:12:08.339965251Z","closed_at":"2025-11-29T07:12:08.340008651Z","dependencies":[{"issue_id":"coding_agent_session_search-005","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:51:17.606142759Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-005","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:51:17.620115952Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-006","title":"Breadcrumb / locality bar","description":"Header Agent › Workspace › Date (and ranking); crumb choosers; single source of truth with pills.","notes":"Implementing breadcrumb/locality bar in TUI (Agent › Workspace › Date › Ranking) with mouse/keyboard actions, synced to filters.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.467014373Z","updated_at":"2025-12-01T20:45:56.602460254Z","closed_at":"2025-12-01T20:45:56.602460254Z","dependencies":[{"issue_id":"coding_agent_session_search-006","depends_on_id":"coding_agent_session_search-005","type":"blocks","created_at":"2025-11-29T05:51:24.262094102Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-007","title":"Result drill-in modal","description":"Overlay full thread with role gutters; quick actions (open, copy path, copy snippet); preserves selection; ESC-safe.","notes":"Released by BlueCastle due to file reservation conflict with OrangeCastle on tui.rs","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.451013572Z","updated_at":"2025-11-30T05:28:00.074702576Z","closed_at":"2025-11-30T05:28:00.074702576Z","dependencies":[{"issue_id":"coding_agent_session_search-007","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:51:43.728331638Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-008","title":"Role-aware theming \u0026 gradients","description":"Apply role palettes; subtle gradients on headers/pills; adaptive borders by width; contrast-checked.","notes":"BlueCastle: Starting role-aware theming with palettes, gradients, adaptive borders","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.484134288Z","updated_at":"2025-11-30T14:58:33.410813753Z","closed_at":"2025-11-30T14:58:33.410813753Z","dependencies":[{"issue_id":"coding_agent_session_search-008","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:51:49.610473984Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-009","title":"Density toggle (Compact/Cozy/Spacious)","description":" cycles density presets; persisted; size-aware defaults; works with wrap on/off.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.409176247Z","updated_at":"2025-11-30T00:05:21.983784076Z","closed_at":"2025-11-30T00:05:21.983784076Z","dependencies":[{"issue_id":"coding_agent_session_search-009","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:52:11.570541101Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-009","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:52:11.577918606Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-010","title":"Syntax-highlighted snippets in results","description":"Highlight via syntect (or existing); bold hits, dim context; cached themes; auto-fallback on narrow/slow terminals.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.443549778Z","updated_at":"2025-11-30T04:00:41.734853886Z","closed_at":"2025-11-30T04:00:41.734853886Z","dependencies":[{"issue_id":"coding_agent_session_search-010","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:52:18.194683745Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-011","title":"Icons \u0026 status badges","description":"Glyphs for agent/file/workspace; latency + cache badges; truncation- and no-color-safe.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.479321927Z","updated_at":"2025-11-30T05:20:47.417317915Z","closed_at":"2025-11-30T05:20:47.417317915Z","dependencies":[{"issue_id":"coding_agent_session_search-011","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:52:35.930713403Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-011","depends_on_id":"coding_agent_session_search-010","type":"blocks","created_at":"2025-11-29T05:52:35.941379847Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-012","title":"Indexer HUD + sparkline","description":"Footer micro-panel for phase/progress/rebuild + tiny throughput sparkline; respects quiet/minimal modes.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.501718608Z","updated_at":"2025-11-30T14:42:32.584327551Z","dependencies":[{"issue_id":"coding_agent_session_search-012","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:52:56.101706795Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-013","title":"Staggered reveal animations","description":"Lightweight fade/slide on top results; env flag to disable; no frame drops on 80x24.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.493265402Z","updated_at":"2025-12-01T01:39:54.814260028Z","closed_at":"2025-12-01T01:39:54.814260028Z","dependencies":[{"issue_id":"coding_agent_session_search-013","depends_on_id":"coding_agent_session_search-001","type":"blocks","created_at":"2025-11-29T05:53:01.584200328Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-014","title":"Smart empty states","description":"Contextual empty copy + quick actions (today, wildcard, index); safe for robot/json modes; no focus traps.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.471109824Z","updated_at":"2025-11-30T04:08:10.280013815Z","closed_at":"2025-11-30T04:08:10.280013815Z","dependencies":[{"issue_id":"coding_agent_session_search-014","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:53:18.884766447Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-015","title":"Multi-select + bulk actions","description":"Space toggles selection; A bulk menu (open, copy paths, export JSON, tag); visual count; robot-safe.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.436989296Z","updated_at":"2025-11-30T06:22:22.984218977Z","closed_at":"2025-11-30T06:22:22.984218977Z","dependencies":[{"issue_id":"coding_agent_session_search-015","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:53:24.90500176Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-015","depends_on_id":"coding_agent_session_search-007","type":"blocks","created_at":"2025-11-29T05:53:24.917531629Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-016","title":"Saved views (slots 1–9)","description":"Ctrl+\u003cn\u003e saves filters/ranking; Shift+\u003cn\u003e recalls; persisted; toast on save/load.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.430295712Z","updated_at":"2025-12-01T21:29:38.497763-05:00","closed_at":"2025-12-01T21:29:38.497763-05:00","dependencies":[{"issue_id":"coding_agent_session_search-016","depends_on_id":"coding_agent_session_search-005","type":"blocks","created_at":"2025-11-29T05:53:43.013323619Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-016","depends_on_id":"coding_agent_session_search-006","type":"blocks","created_at":"2025-11-29T05:53:43.026562499Z","created_by":"ubuntu"}],"comments":[{"id":18,"issue_id":"coding_agent_session_search-016","author":"jemanuel","text":"Starting work: Implementing saved views feature with Ctrl+n save, Shift+n recall, persistence, and toast notifications.","created_at":"2025-12-02T00:39:33Z"}]}
{"id":"coding_agent_session_search-017","title":"Per-pane search (/)","description":"Local filter within results/detail; highlight matches; no Tantivy hit; ESC clears.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.447504328Z","updated_at":"2025-11-30T04:00:45.168366424Z","closed_at":"2025-11-30T04:00:45.168366424Z","dependencies":[{"issue_id":"coding_agent_session_search-017","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:53:48.404475897Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-018","title":"Update assistant banner","description":"Startup/hourly release check; banner with U upgrade, s skip, d notes; remembers skip-this-version; offline-friendly messaging; no auto-download.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.498278265Z","updated_at":"2025-12-01T02:06:33.415149017Z","closed_at":"2025-12-01T02:06:33.415149017Z","dependencies":[{"issue_id":"coding_agent_session_search-018","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:54:06.827611159Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-019","title":"First-run / anytime tour (?)","description":"Single-page overlay covering layout, key binds, data dirs, update toggle; dismissible and replayable.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.455037423Z","updated_at":"2025-12-01T02:17:09.895356193Z","closed_at":"2025-12-01T02:17:09.895356193Z","dependencies":[{"issue_id":"coding_agent_session_search-019","depends_on_id":"coding_agent_session_search-002","type":"blocks","created_at":"2025-11-29T05:54:34.106171708Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-020","title":"Local UI metrics (privacy-safe)","description":"Emit local-only metrics to trace/log (palette use, pill edits, highlight timing, latency badge, HUD phases, animation opt-outs); gated by env flag; no PII.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-29T06:00:53.475355378Z","updated_at":"2025-11-29T06:00:53.475355378Z","dependencies":[{"issue_id":"coding_agent_session_search-020","depends_on_id":"coding_agent_session_search-003","type":"blocks","created_at":"2025-11-29T05:54:55.341242382Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-020","depends_on_id":"coding_agent_session_search-005","type":"blocks","created_at":"2025-11-29T05:54:55.352018424Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-020","depends_on_id":"coding_agent_session_search-010","type":"blocks","created_at":"2025-11-29T05:54:55.359852827Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-020","depends_on_id":"coding_agent_session_search-011","type":"blocks","created_at":"2025-11-29T05:54:55.363596776Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-020","depends_on_id":"coding_agent_session_search-012","type":"blocks","created_at":"2025-11-29T05:54:55.367202123Z","created_by":"ubuntu"},{"issue_id":"coding_agent_session_search-020","depends_on_id":"coding_agent_session_search-013","type":"blocks","created_at":"2025-11-29T05:54:55.370235763Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-09h","title":"TST.7 Unit: CLI introspect schemas (no mocks)","description":"Add tests to assert clap-derived command/arg schemas match introspect JSON; cover hidden/help exclusion, enum/path/int detection, repeatable options, defaults; rely on real clap metadata, no mocks.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T18:56:47.532198705Z","updated_at":"2025-12-01T19:14:07.950119754Z","closed_at":"2025-12-01T19:14:07.950119754Z","dependencies":[{"issue_id":"coding_agent_session_search-09h","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-12-01T18:57:58.677988532Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-0go","title":"P7.3 Integration tests for multi-source indexing","description":"# P7.3 Integration tests for multi-source indexing\n\n## Overview\nIntegration tests that verify the full indexing pipeline handles multiple\nsources correctly, including provenance attribution and deduplication.\n\n## Test Cases\n\n### Multi-Source Indexing\n```rust\n#[tokio::test]\nasync fn test_index_local_and_remote_sources() {\n    let temp_dir = tempdir().unwrap();\n    let db = setup_test_db(\u0026temp_dir).await;\n    \n    // Create local session fixture\n    let local_sessions = create_fixture_sessions(\u0026temp_dir, \"local\", 5);\n    \n    // Create remote session fixture (simulating synced data)\n    let remote_sessions = create_fixture_sessions(\u0026temp_dir, \"remote/laptop\", 3);\n    \n    // Index both\n    let mut indexer = Indexer::new(\u0026db);\n    indexer.add_root(\u0026local_sessions, Provenance::local());\n    indexer.add_root(\u0026remote_sessions, Provenance::remote(\"laptop\".into()));\n    indexer.index_all().await.unwrap();\n    \n    // Verify counts\n    let stats = db.get_stats().await.unwrap();\n    assert_eq!(stats.total_conversations, 8);\n    assert_eq!(stats.local_conversations, 5);\n    assert_eq!(stats.remote_conversations, 3);\n}\n\n#[tokio::test]\nasync fn test_search_filters_by_source() {\n    // ... setup with mixed sources\n    \n    // Search all\n    let all_results = searcher.search(\"test query\", None).await.unwrap();\n    assert_eq!(all_results.len(), 8);\n    \n    // Search local only\n    let local_results = searcher.search(\"test query\", Some(SourceFilter::Local)).await.unwrap();\n    assert_eq!(local_results.len(), 5);\n    assert!(local_results.iter().all(|r| !r.provenance.is_remote()));\n    \n    // Search remote only\n    let remote_results = searcher.search(\"test query\", Some(SourceFilter::Remote)).await.unwrap();\n    assert_eq!(remote_results.len(), 3);\n    assert!(remote_results.iter().all(|r| r.provenance.is_remote()));\n}\n```\n\n### Incremental Indexing\n```rust\n#[tokio::test]\nasync fn test_incremental_index_new_remote_source() {\n    // Index initial local sessions\n    let mut indexer = Indexer::new(\u0026db);\n    indexer.add_root(\u0026local_sessions, Provenance::local());\n    indexer.index_all().await.unwrap();\n    \n    let initial_count = db.conversation_count().await.unwrap();\n    \n    // Simulate adding new remote source\n    indexer.add_root(\u0026remote_sessions, Provenance::remote(\"laptop\".into()));\n    indexer.index_incremental().await.unwrap();\n    \n    let final_count = db.conversation_count().await.unwrap();\n    assert_eq!(final_count, initial_count + remote_sessions.len());\n}\n```\n\n## Dependencies\n- Requires P2.2 (multi-root indexing)\n- Requires P1.3 (provenance in storage)\n\n## Acceptance Criteria\n- [ ] Multi-source indexing preserves provenance\n- [ ] Source filtering works in search\n- [ ] Incremental indexing adds new sources correctly\n- [ ] Stats reflect source distribution","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:12:25.565102-05:00","updated_at":"2025-12-16T01:12:25.565102-05:00","dependencies":[{"issue_id":"coding_agent_session_search-0go","depends_on_id":"coding_agent_session_search-1mv","type":"blocks","created_at":"2025-12-16T01:13:16.650961-05:00","created_by":"jemanuel"},{"issue_id":"coding_agent_session_search-0go","depends_on_id":"coding_agent_session_search-d4b","type":"blocks","created_at":"2025-12-16T01:13:21.915601-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-0jt","title":"TST.11 Integration: search/index e2e (real fixtures, logging)","description":"Scripted flow: temp data-dir, cass index --full, cass search hello --json; assert hits/match_type/aggregations; cover watch-once env path; capture trace-file + logs (no mocks).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T18:57:19.046306299Z","updated_at":"2025-12-01T22:50:33.402863-05:00","closed_at":"2025-12-01T22:50:33.402863-05:00","dependencies":[{"issue_id":"coding_agent_session_search-0jt","depends_on_id":"coding_agent_session_search-bhk","type":"blocks","created_at":"2025-12-01T18:58:24.123479544Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-0ly","title":"P4 Inline filter chips","description":"Render filters as chips inside search bar; intuitive removal/edit; tests.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:58:03.677572681Z","updated_at":"2025-12-01T22:19:26.825366-05:00","closed_at":"2025-12-01T22:19:26.825366-05:00","dependencies":[{"issue_id":"coding_agent_session_search-0ly","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T13:58:26.765832731Z","created_by":"daemon"}],"comments":[{"id":1,"issue_id":"coding_agent_session_search-0ly","author":"ubuntu","text":"Kept P4 Inline filter chips epic (0ly). Deleted accidental duplicate epic pc9 and its tasks to avoid split tracking.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-0ly.3","title":"B4.1 Chips in search bar","description":"Render filters as chips inside bar; backspace removes last; Enter on empty edits last chip; help/legend reflect chips.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T14:18:33.077538391Z","updated_at":"2025-11-24T14:19:11.424054451Z","closed_at":"2025-11-24T14:19:11.424054451Z"}
{"id":"coding_agent_session_search-0ly.4","title":"B4.2 Chip tests","description":"UI component tests for chip rendering/removal/edit triggers.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T14:18:37.631869077Z","updated_at":"2025-11-24T14:19:11.425776069Z","closed_at":"2025-11-24T14:19:11.425776069Z","dependencies":[{"issue_id":"coding_agent_session_search-0ly.4","depends_on_id":"coding_agent_session_search-0ly.3","type":"blocks","created_at":"2025-11-24T14:18:43.980750717Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-0mn","title":"bd-installer-spec","description":"Write concise spec for UBS-style curl|bash installer: goals, UX, safety invariants, modes (normal/easy), checksum/signature policy, toolchain expectations","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:00.262736083Z","updated_at":"2025-11-23T20:20:13.821531275Z","closed_at":"2025-11-23T20:20:13.821531275Z"}
{"id":"coding_agent_session_search-115","title":"P1.2 Add sources table to SQLite","description":"# Add sources Table to SQLite Storage\n\n## Context\nWe need a place to persist Source configurations. Each source (local, work-laptop, etc.) has metadata that should survive restarts.\n\n## Location\nsrc/storage/sqlite.rs\n\n## Schema\n\\`\\`\\`sql\nCREATE TABLE IF NOT EXISTS sources (\n    id TEXT PRIMARY KEY,           -- source_id (e.g., \"local\", \"work-laptop\")\n    kind TEXT NOT NULL,            -- \"local\", \"ssh\", etc.\n    host_label TEXT,               -- display label\n    machine_id TEXT,               -- optional stable machine id\n    platform TEXT,                 -- \"macos\", \"linux\", \"windows\"\n    config_json TEXT,              -- JSON blob for extra config (SSH params, path rewrites)\n    created_at INTEGER NOT NULL,\n    updated_at INTEGER NOT NULL\n);\n\\`\\`\\`\n\n## Bootstrap\nOn DB creation, automatically insert the \"local\" source:\n\\`\\`\\`sql\nINSERT OR IGNORE INTO sources (id, kind, host_label, created_at, updated_at)\nVALUES ('local', 'local', NULL, strftime('%s','now')*1000, strftime('%s','now')*1000);\n\\`\\`\\`\n\n## API Methods\nAdd to SqliteStorage:\n\n\\`\\`\\`rust\n/// Get source by ID\npub fn get_source(\u0026self, id: \u0026str) -\u003e Result\u003cOption\u003cSource\u003e\u003e;\n\n/// List all sources\npub fn list_sources(\u0026self) -\u003e Result\u003cVec\u003cSource\u003e\u003e;\n\n/// Create or update a source\npub fn upsert_source(\u0026self, source: \u0026Source) -\u003e Result\u003c()\u003e;\n\n/// Delete a source (and optionally cascade to conversations)\npub fn delete_source(\u0026self, id: \u0026str, cascade: bool) -\u003e Result\u003c()\u003e;\n\\`\\`\\`\n\n## Migration\nThis is a new table, so it's additive. The migration path is:\n1. Check if sources table exists\n2. If not, create it\n3. Insert \"local\" source if not present\n\nNo need for table rewrite - this is purely additive.\n\n## Schema Version\nBump SCHEMA_VERSION in sqlite.rs\n\n## Dependencies\n- P1.1 (Source types must exist)\n\n## Acceptance Criteria\n- [ ] sources table created on init\n- [ ] \"local\" source auto-created\n- [ ] CRUD methods implemented\n- [ ] Schema version bumped\n- [ ] Tests for source CRUD","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:54:30.5029-05:00","updated_at":"2025-12-16T01:59:27.571095-05:00","closed_at":"2025-12-16T01:59:27.571095-05:00","close_reason":"Added sources table to SQLite with MIGRATION_V4. Schema version bumped to 4. Implemented get_source, list_sources, upsert_source, delete_source methods. Local source auto-created on DB init. 28 storage tests pass, all 281 tests pass.","dependencies":[{"issue_id":"coding_agent_session_search-115","depends_on_id":"coding_agent_session_search-2w4","type":"blocks","created_at":"2025-12-16T00:56:08.597008-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-18u","title":"Enhance CLI Error Reporting for Agents","description":"Ensure all CLI errors in robot mode return structured JSON with 'did_you_mean', examples, and schema hints.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-01T23:04:07.011854-05:00","updated_at":"2025-12-01T23:06:52.036782-05:00","closed_at":"2025-12-01T23:06:52.036782-05:00"}
{"id":"coding_agent_session_search-1hk","title":"Phase 6: Workspace Path Rewriting (Optional Enhancement)","description":"# Phase 6: Workspace Path Rewriting (Optional Enhancement)\n\n## Overview\nWhen sessions are synced from remote machines, the workspace paths in conversations\nrefer to the remote filesystem (e.g., /home/user/projects/foo on remote, but\n/Users/me/projects/foo on local). This phase adds optional path rewriting rules\nso that file references in search results point to valid local paths.\n\n## Goals\n1. Define path mapping rules in source configuration\n2. Apply mappings when displaying results (not when indexing)\n3. Provide fallback behavior when mapping unavailable\n\n## Example Configuration\n```toml\n[[sources]]\nname = \"laptop\"\nhost = \"user@laptop.local\"\n[sources.path_mappings]\n\"/home/user/projects\" = \"/Users/me/projects\"\n\"/opt/work\" = \"/Volumes/Work\"\n```\n\n## Technical Considerations\n- Mappings applied at display time, not storage (preserve original data)\n- Multiple mappings may match; use longest prefix match\n- Unmapped paths displayed as-is with visual indicator\n\n## Why Optional\nThis feature is complex and may not be needed by all users. Some users may prefer\nto see original paths. Making it opt-in reduces confusion.\n\n## Dependencies\n- Requires Phase 5 completion (sources config exists)\n- Could be deferred to post-MVP\n\n## Acceptance Criteria\n- [ ] Path mappings configurable per source\n- [ ] Mappings applied to displayed workspace paths\n- [ ] Unmapped paths clearly indicated\n- [ ] Original paths preserved in storage\n- [ ] Documentation explains mapping syntax","status":"open","priority":2,"issue_type":"epic","created_at":"2025-12-16T01:01:13.943175-05:00","updated_at":"2025-12-16T01:01:13.943175-05:00","dependencies":[{"issue_id":"coding_agent_session_search-1hk","depends_on_id":"coding_agent_session_search-bgi","type":"blocks","created_at":"2025-12-16T01:01:49.364373-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-1mv","title":"P2.2 Indexer multi-root orchestration","description":"# Indexer Multi-Root Orchestration\n\n## Context\nThe indexer needs to build a list of scan roots and orchestrate scanning across them, injecting provenance appropriately.\n\n## Location\nsrc/indexer/mod.rs\n\n## Current Flow\n1. Build single ScanContext with data_dir\n2. For each connector, call scan()\n3. Persist results\n\n## New Flow\n1. Build list of scan roots:\n   - Local roots (from watch_roots() or equivalent)\n   - Remote mirror roots (from sources table)\n2. Group roots by connector affinity\n3. For each connector:\n   - For each relevant root:\n     - Create ScanContext with that root\n     - Call scan()\n     - Inject provenance into results\n     - Persist with source_id\n\n## Implementation\n\n### Build Scan Roots List\n\\`\\`\\`rust\nfn build_scan_roots(storage: \u0026SqliteStorage) -\u003e Vec\u003cScanRoot\u003e {\n    let mut roots = Vec::new();\n    \n    // Add local roots (existing logic from watch_roots())\n    for local_root in local_default_roots() {\n        roots.push(ScanRoot {\n            path: local_root,\n            origin: Origin::local(),\n            platform: Some(Platform::current()),\n            workspace_rewrites: vec![],\n        });\n    }\n    \n    // Add remote mirror roots\n    for source in storage.list_sources()? {\n        if source.kind == SourceKind::Ssh {\n            let mirror_root = data_dir.join(\"remotes\").join(\u0026source.id).join(\"mirror\");\n            if mirror_root.exists() {\n                roots.push(ScanRoot {\n                    path: mirror_root,\n                    origin: Origin {\n                        source_id: source.id.clone(),\n                        kind: source.kind,\n                        host: source.host_label.clone(),\n                    },\n                    platform: source.platform,\n                    workspace_rewrites: parse_rewrites(\u0026source.config),\n                });\n            }\n        }\n    }\n    \n    roots\n}\n\\`\\`\\`\n\n### Connector Affinity\nNot all roots apply to all connectors. For example:\n- ClaudeCodeConnector cares about ~/.claude or remotes/*/mirror/**/.claude\n- AiderConnector cares about .aider.chat.history.md anywhere\n\nFor now: let connectors handle root relevance via their detect() logic.\n\n### Provenance Injection\nAfter connector.scan() returns:\n\\`\\`\\`rust\nfor conv in conversations.iter_mut() {\n    conv.metadata[\"cass\"] = json!({\n        \"origin\": {\n            \"source_id\": scan_root.origin.source_id,\n            \"kind\": scan_root.origin.kind.as_str(),\n            \"host\": scan_root.origin.host,\n        }\n    });\n}\n\\`\\`\\`\n\n## Dependencies\n- P2.1 (ScanContext extended)\n- P1.3 (storage accepts source_id)\n\n## Acceptance Criteria\n- [ ] Indexer builds list of scan roots\n- [ ] Local roots work as before\n- [ ] Provenance injected into metadata\n- [ ] Results persisted with correct source_id\n- [ ] Tests verify multi-root behavior","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:57:31.805169-05:00","updated_at":"2025-12-16T11:33:11.166283-05:00","closed_at":"2025-12-16T11:33:11.166283-05:00","close_reason":"Implemented multi-root orchestration with build_scan_roots(), inject_provenance(), and provenance extraction in persist::map_to_internal(). All 294 tests pass.","dependencies":[{"issue_id":"coding_agent_session_search-1mv","depends_on_id":"coding_agent_session_search-1v7","type":"blocks","created_at":"2025-12-16T00:58:17.128097-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-1v7","title":"P2.1 Extend ScanContext with scan roots","description":"# Extend ScanContext with Multi-Root Support\n\n## Context\nCurrently ScanContext has just data_root (single path) and since_ts. For remote support, we need multiple scan roots, each with provenance.\n\n## Location\nsrc/connectors/mod.rs (ScanContext definition)\nsrc/indexer/mod.rs (ScanContext usage)\n\n## Current Structure\n\\`\\`\\`rust\npub struct ScanContext {\n    pub data_root: PathBuf,\n    pub since_ts: Option\u003ci64\u003e,\n}\n\\`\\`\\`\n\n## New Structure\n\n### Option A: Add scan_roots alongside data_root (backward compatible)\n\\`\\`\\`rust\npub struct ScanContext {\n    /// Primary data directory (cass internal state)\n    pub data_dir: PathBuf,\n    \n    /// Scan roots to search for agent logs\n    /// If empty, connectors use their default detection logic\n    pub scan_roots: Vec\u003cScanRoot\u003e,\n    \n    /// High-water mark for incremental indexing\n    pub since_ts: Option\u003ci64\u003e,\n}\n\npub struct ScanRoot {\n    /// Path to scan (e.g., ~/.claude, or /data/remotes/work-laptop/mirror/home/.claude)\n    pub path: PathBuf,\n    \n    /// Provenance for conversations found under this root\n    pub origin: Origin,\n    \n    /// Optional platform hint (affects path interpretation)\n    pub platform: Option\u003cPlatform\u003e,\n    \n    /// Optional path rewrite rules (src_prefix -\u003e dst_prefix)\n    pub workspace_rewrites: Vec\u003c(String, String)\u003e,\n}\n\\`\\`\\`\n\n### Option B: Keep ScanContext simple, pass provenance separately\nKeep ScanContext as-is, but indexer tracks provenance externally and injects after scan.\n\n## Recommendation\nOption A is cleaner - ScanRoot bundles everything needed for a scan pass.\n\n## Migration Path for Connectors\nMost connectors currently check ctx.data_root for tests/overrides. Update them to:\n1. If scan_roots is non-empty, iterate over matching roots\n2. If scan_roots is empty, use existing default detection logic (maintains backward compat)\n\n## Dependencies\n- P1.1 (Origin type)\n\n## Acceptance Criteria\n- [ ] ScanContext extended with scan_roots\n- [ ] ScanRoot struct defined with provenance\n- [ ] Backward compatibility: empty scan_roots = old behavior\n- [ ] At least one connector updated to use new structure\n- [ ] Tests pass","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:57:06.602228-05:00","updated_at":"2025-12-16T10:36:13.711982-05:00","closed_at":"2025-12-16T10:36:13.711982-05:00","close_reason":"Added ScanRoot struct with origin, platform, workspace_rewrites. Extended ScanContext with scan_roots vec and data_dir. Connectors updated to use data_dir. Backward compatible via local_default() and use_default_detection(). 5 new unit tests.","dependencies":[{"issue_id":"coding_agent_session_search-1v7","depends_on_id":"coding_agent_session_search-bfk","type":"blocks","created_at":"2025-12-16T00:58:11.903856-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-1z2","title":"P1 Stabilize current UX","description":"Stabilize new TUI features (prefix default, context sizes, space peek, persisted state); align docs, tests, and behavior.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:57:10.26861639Z","updated_at":"2025-12-01T22:16:20.834091-05:00","closed_at":"2025-12-01T22:16:20.834091-05:00"}
{"id":"coding_agent_session_search-1z2.1","title":"B1.1 Document new controls","description":"README + inline comments for F1/F2/F7/F9/F11, Space peek, prefix default, recency sort, tui_state.json reset.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:57:13.375293524Z","updated_at":"2025-11-24T14:03:08.773078926Z","closed_at":"2025-11-24T14:03:08.773078926Z"}
{"id":"coding_agent_session_search-1z2.2","title":"B1.2 Persisted-state tests","description":"Add tests verifying match_mode/context_window load/save in tui_state.json.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:57:17.091683888Z","updated_at":"2025-11-24T14:03:08.792469542Z","closed_at":"2025-11-24T14:03:08.792469542Z","dependencies":[{"issue_id":"coding_agent_session_search-1z2.2","depends_on_id":"coding_agent_session_search-1z2.1","type":"blocks","created_at":"2025-11-24T13:57:30.597192594Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-1z2.3","title":"B1.3 Snippet edge-case tests","description":"Tests for contextual_snippet with multibyte text, empty query, short strings.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:57:22.947671575Z","updated_at":"2025-11-24T14:03:08.799174016Z","closed_at":"2025-11-24T14:03:08.799174016Z","dependencies":[{"issue_id":"coding_agent_session_search-1z2.3","depends_on_id":"coding_agent_session_search-1z2.2","type":"blocks","created_at":"2025-11-24T13:57:35.375482065Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-2d0","title":"bd-installer-script","description":"Implement Bash installer (bash4+) patterned on UBS: normal + --easy-mode, checksum required, optional minisign, supports ARTIFACT_URL/CHECKSUM/CHECKSUM_URL, installs nightly rustup+components if missing, lock file + temp workdir, PATH guidance, self-test flag, system/user dest.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:11.478994854Z","updated_at":"2025-11-23T20:20:19.616316737Z","closed_at":"2025-11-23T20:20:19.616316737Z","dependencies":[{"issue_id":"coding_agent_session_search-2d0","depends_on_id":"coding_agent_session_search-0mn","type":"blocks","created_at":"2025-11-23T20:14:11.480483469Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-2g4","title":"Investigate and fix Command::new usage","description":"Audit and sanitize Command::new calls in TUI and update checker.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T22:19:13.510594-05:00","updated_at":"2025-12-01T22:20:12.639636-05:00","closed_at":"2025-12-01T22:20:12.639636-05:00"}
{"id":"coding_agent_session_search-2jy","title":"Fix UBS Findings","description":"Fix syntax error in query.rs and address clippy/check failures.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-01T18:26:29.272626-05:00","updated_at":"2025-12-01T18:27:09.412112-05:00","closed_at":"2025-12-01T18:27:09.412112-05:00"}
{"id":"coding_agent_session_search-2w4","title":"P1.1 Define Source/Origin Rust types","description":"# Define Source/Origin Rust Types\n\n## Context\nWe need Rust types to represent \"where a conversation came from\" - the provenance system. These types will be used throughout cass: storage, indexing, search, CLI, TUI.\n\n## Location\nCreate new module: src/model/source.rs (or src/sources.rs if we prefer top-level)\n\n## Types to Define\n\n### SourceKind enum\n\\`\\`\\`rust\n#[derive(Debug, Clone, Copy, PartialEq, Eq, Hash, Serialize, Deserialize)]\n#[serde(rename_all = \"lowercase\")]\npub enum SourceKind {\n    Local,\n    Ssh,\n    // Future: S3, Git, Http\n}\n\\`\\`\\`\n\n### Source struct (configuration-level)\n\\`\\`\\`rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct Source {\n    /// Stable, user-friendly identifier (e.g., \"local\", \"work-laptop\", \"home-server\")\n    pub id: String,\n    \n    /// What type of source this is\n    pub kind: SourceKind,\n    \n    /// Display label for UI (often SSH alias or hostname)\n    pub host_label: Option\u003cString\u003e,\n    \n    /// Optional stable machine identifier (hashed if desired)\n    pub machine_id: Option\u003cString\u003e,\n    \n    /// Platform hint for path defaults\n    pub platform: Option\u003cPlatform\u003e,\n    \n    /// Arbitrary config (SSH params, path rewrites, etc)\n    pub config: serde_json::Value,\n    \n    pub created_at: Option\u003ci64\u003e,\n    pub updated_at: Option\u003ci64\u003e,\n}\n\n#[derive(Debug, Clone, Copy, PartialEq, Eq, Serialize, Deserialize)]\n#[serde(rename_all = \"lowercase\")]\npub enum Platform {\n    Macos,\n    Linux,\n    Windows,\n}\n\\`\\`\\`\n\n### Origin struct (per-conversation metadata)\n\\`\\`\\`rust\n#[derive(Debug, Clone, Default, Serialize, Deserialize)]\npub struct Origin {\n    /// References Source.id\n    pub source_id: String,\n    \n    /// Denormalized for convenience\n    pub kind: SourceKind,\n    \n    /// Display host label (may differ from source's host_label)\n    pub host: Option\u003cString\u003e,\n}\n\nimpl Default for Origin {\n    fn default() -\u003e Self {\n        Self {\n            source_id: \"local\".into(),\n            kind: SourceKind::Local,\n            host: None,\n        }\n    }\n}\n\\`\\`\\`\n\n## Constants\n\\`\\`\\`rust\npub const LOCAL_SOURCE_ID: \u0026str = \"local\";\n\\`\\`\\`\n\n## Considerations\n- Use serde for JSON serialization (robot output compatibility)\n- Derive common traits: Debug, Clone, PartialEq, Eq, Hash where appropriate\n- Document public types with doc comments\n- Consider implementing Display for user-friendly formatting\n\n## Wire into lib.rs\nExport these types from the crate root so they're accessible:\n\\`\\`\\`rust\npub mod sources;\npub use sources::{Source, SourceKind, Origin, Platform, LOCAL_SOURCE_ID};\n\\`\\`\\`\n\n## Acceptance Criteria\n- [ ] Types defined with proper derives\n- [ ] Doc comments on all public items\n- [ ] Unit tests for Default impls and serialization\n- [ ] Exported from crate root\n- [ ] cargo check passes\n- [ ] cargo clippy passes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:54:10.1145-05:00","updated_at":"2025-12-16T01:51:13.559723-05:00","closed_at":"2025-12-16T01:51:13.559723-05:00","close_reason":"Implemented SourceKind, Source, Origin, SourceFilter types with LOCAL_SOURCE_ID constant in src/sources/provenance.rs. Refactored config.rs to use shared SourceKind instead of duplicate SourceConnectionType. 34 unit tests pass. cargo check/clippy/fmt all pass.","dependencies":[{"issue_id":"coding_agent_session_search-2w4","depends_on_id":"coding_agent_session_search-495","type":"blocks","created_at":"2025-12-16T00:56:03.359071-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-34t","title":"TUI performance polish","description":"Add skeleton loaders, search-in-progress indicator, async detail loading cache, and pagination guards.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-23T07:56:53.203024574Z","updated_at":"2025-11-23T14:38:17.785150208Z","closed_at":"2025-11-23T14:38:17.785150208Z","labels":["performance","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-34t","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:56:53.213129889Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-3mm","title":"bd-e2e-watch-incremental","description":"Watch mode: touch fixture, targeted reindex, watch_state bump; shorten debounce","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:34.603328041Z","updated_at":"2025-11-23T20:06:18.042316256Z","closed_at":"2025-11-23T20:06:18.042316256Z","dependencies":[{"issue_id":"coding_agent_session_search-3mm","depends_on_id":"coding_agent_session_search-dja","type":"blocks","created_at":"2025-11-23T17:35:34.61836412Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-3q6","title":"P7.7 E2E tests for sources CLI commands","description":"# P7.7 E2E tests for sources CLI commands\n\n## Overview\nEnd-to-end tests for the `cass sources` CLI commands using mock SSH\nand realistic scenarios.\n\n## Test Cases\n\n### Sources Add E2E\n```rust\n#[tokio::test]\nasync fn test_sources_add_e2e() {\n    let temp_dir = setup_test_env();\n    \n    // Mock SSH that succeeds\n    mock_ssh_success();\n    \n    // Run command\n    let output = Command::new(\"cass\")\n        .args([\"sources\", \"add\", \"user@laptop.local\", \"--name\", \"laptop\"])\n        .env(\"CASS_CONFIG_DIR\", temp_dir.path())\n        .output()\n        .await\n        .unwrap();\n    \n    assert!(output.status.success());\n    assert!(output.stdout_str().contains(\"Added source 'laptop'\"));\n    \n    // Verify config was written\n    let config = SourcesConfig::load_from(\u0026temp_dir.path().join(\"sources.toml\")).unwrap();\n    assert_eq!(config.sources.len(), 1);\n    assert_eq!(config.sources[0].name, \"laptop\");\n}\n\n#[tokio::test]\nasync fn test_sources_add_connectivity_failure() {\n    let temp_dir = setup_test_env();\n    \n    // Mock SSH that fails\n    mock_ssh_failure(\"Connection refused\");\n    \n    let output = Command::new(\"cass\")\n        .args([\"sources\", \"add\", \"user@unreachable.local\"])\n        .env(\"CASS_CONFIG_DIR\", temp_dir.path())\n        .output()\n        .await\n        .unwrap();\n    \n    assert!(!output.status.success());\n    assert!(output.stderr_str().contains(\"Connection refused\"));\n}\n```\n\n### Sources Sync E2E\n```rust\n#[tokio::test]\nasync fn test_sources_sync_e2e() {\n    let temp_dir = setup_test_env();\n    \n    // Setup source config\n    create_source_config(\u0026temp_dir, \"laptop\", \"user@laptop.local\");\n    \n    // Create mock remote data\n    let mock_remote = create_mock_remote_sessions(5);\n    mock_rsync_with_data(\u0026mock_remote);\n    \n    // Run sync\n    let output = Command::new(\"cass\")\n        .args([\"sources\", \"sync\"])\n        .env(\"CASS_CONFIG_DIR\", temp_dir.path())\n        .output()\n        .await\n        .unwrap();\n    \n    assert!(output.status.success());\n    assert!(output.stdout_str().contains(\"5 sessions\"));\n    \n    // Verify sessions indexed\n    let search_output = Command::new(\"cass\")\n        .args([\"search\", \"--source=laptop\", \"test\"])\n        .env(\"CASS_CONFIG_DIR\", temp_dir.path())\n        .output()\n        .await\n        .unwrap();\n    \n    assert!(search_output.status.success());\n}\n```\n\n### Sources List E2E\n```rust\n#[tokio::test]\nasync fn test_sources_list_e2e() {\n    let temp_dir = setup_test_env();\n    \n    // Add multiple sources\n    create_source_config(\u0026temp_dir, \"laptop\", \"user@laptop.local\");\n    create_source_config(\u0026temp_dir, \"workstation\", \"user@work.example\");\n    \n    let output = Command::new(\"cass\")\n        .args([\"sources\", \"list\"])\n        .env(\"CASS_CONFIG_DIR\", temp_dir.path())\n        .output()\n        .await\n        .unwrap();\n    \n    assert!(output.status.success());\n    let stdout = output.stdout_str();\n    assert!(stdout.contains(\"laptop\"));\n    assert!(stdout.contains(\"workstation\"));\n}\n```\n\n### Sources Doctor E2E\n```rust\n#[tokio::test]\nasync fn test_sources_doctor_e2e() {\n    let temp_dir = setup_test_env();\n    create_source_config(\u0026temp_dir, \"laptop\", \"user@laptop.local\");\n    \n    // Mock partial connectivity (SSH works, one path missing)\n    mock_ssh_success();\n    mock_remote_path_exists(\"~/.claude/projects\");\n    mock_remote_path_missing(\"~/.cursor\");\n    \n    let output = Command::new(\"cass\")\n        .args([\"sources\", \"doctor\", \"--source\", \"laptop\"])\n        .env(\"CASS_CONFIG_DIR\", temp_dir.path())\n        .output()\n        .await\n        .unwrap();\n    \n    assert!(output.status.success());\n    let stdout = output.stdout_str();\n    assert!(stdout.contains(\"✓ SSH Connectivity\"));\n    assert!(stdout.contains(\"✓ Remote Path: ~/.claude/projects\"));\n    assert!(stdout.contains(\"✗ Remote Path: ~/.cursor\"));\n}\n```\n\n## Dependencies\n- Requires P5.2-P5.6 (sources commands implemented)\n- Requires P7.6 (fixtures for mock data)\n\n## Acceptance Criteria\n- [ ] All sources subcommands tested E2E\n- [ ] Success and failure paths covered\n- [ ] Mock SSH/rsync used (no actual network)\n- [ ] Output format verified\n- [ ] Config file side effects verified","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:12:51.908935-05:00","updated_at":"2025-12-16T01:12:51.908935-05:00","dependencies":[{"issue_id":"coding_agent_session_search-3q6","depends_on_id":"coding_agent_session_search-d6o","type":"blocks","created_at":"2025-12-16T01:13:48.193274-05:00","created_by":"jemanuel"},{"issue_id":"coding_agent_session_search-3q6","depends_on_id":"coding_agent_session_search-80s","type":"blocks","created_at":"2025-12-16T01:13:53.455738-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-422","title":"P11 Visual contrast polish","description":"Audit pane colors for WCAG; adjust if needed.","status":"open","priority":2,"issue_type":"epic","created_at":"2025-11-24T14:00:54.151921611Z","updated_at":"2025-11-24T14:00:54.151921611Z","dependencies":[{"issue_id":"coding_agent_session_search-422","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T14:01:02.810576597Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-422.1","title":"B11.1 WCAG pass","description":"Audit pane fg/bg contrasts; adjust palette if needed.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-24T14:00:59.171945672Z","updated_at":"2025-11-24T14:00:59.171945672Z"}
{"id":"coding_agent_session_search-46t","title":"P9 Persist new knobs","description":"Persist pane count and weighting presets; add reset path.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:59:41.333063745Z","updated_at":"2025-12-01T21:35:38.865647-05:00","closed_at":"2025-12-01T21:35:38.865647-05:00","dependencies":[{"issue_id":"coding_agent_session_search-46t","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T14:00:05.608904428Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-46t.1","title":"B9.1 Persist pane count \u0026 weighting","description":"Store per-pane cap and recency-weight preset in tui_state.json.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:59:46.592929028Z","updated_at":"2025-12-01T21:33:10.626992-05:00","closed_at":"2025-12-01T21:33:10.626992-05:00","dependencies":[{"issue_id":"coding_agent_session_search-46t.1","depends_on_id":"coding_agent_session_search-uha.1","type":"blocks","created_at":"2025-11-24T13:59:54.523545214Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-46t.1","depends_on_id":"coding_agent_session_search-uha.2","type":"blocks","created_at":"2025-11-24T14:00:00.973309949Z","created_by":"daemon"}],"comments":[{"id":21,"issue_id":"coding_agent_session_search-46t.1","author":"jemanuel","text":"Starting work: Adding persistence for per_pane_limit and ranking_mode to TuiStatePersisted","created_at":"2025-12-02T02:30:48Z"}]}
{"id":"coding_agent_session_search-46t.2","title":"B9.2 Reset path","description":"Key/flag to wipe tui_state.json gracefully.","notes":"Implemented cass tui --reset-state and Ctrl+Shift+Del hotkey to delete tui_state.json and reload defaults; updated help/shortcuts and troubleshooting doc.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:59:50.134974428Z","updated_at":"2025-12-01T21:35:17.777308-05:00","closed_at":"2025-12-01T21:35:17.777308-05:00"}
{"id":"coding_agent_session_search-495","title":"Phase 1: Provenance Data Model \u0026 Storage","description":"# Phase 1: Provenance Data Model \u0026 Storage Foundation\n\n## Overview\nEstablish the core data model and storage infrastructure for tracking where conversations come from. This is the foundation that all other remote features depend on.\n\n## Why This Must Come First\n- All other features (sync, filtering, UI) depend on these structures\n- Schema changes are disruptive; better to get them right early\n- Identity collision fix is a correctness prerequisite for remote ingestion\n\n## Key Deliverables\n\n### 1. Source/Origin Type Definitions\nNew Rust types in a new module (suggest: src/sources.rs or src/model/source.rs):\n- Source struct: source_id, kind, host_label, machine_id, config\n- SourceKind enum: Local, Ssh (future: S3, Git)\n- Origin struct: source_id, kind, host (for per-conversation provenance)\n\n### 2. SQLite Schema Changes\n- New sources table\n- New columns on conversations: source_id, origin_host\n- Updated uniqueness: UNIQUE(source_id, agent_id, external_id)\n- Migration handling (backup + rebuild strategy for incompatible changes)\n\n### 3. Tantivy Schema Changes\n- New fields: source_id (STRING|STORED), origin_kind (STRING|STORED), origin_host (STRING|STORED)\n- Schema hash bump to trigger rebuild\n- Backward compatibility handling\n\n## Technical Notes\n\n### Migration Strategy\nTreat the search DB + Tantivy index as rebuildable caches:\n- On schema incompatibility: backup old DB, create fresh, trigger full reindex\n- User-authored state (bookmarks, UI prefs) already separate\n- This avoids brittle table-rewrite migrations\n\n### Uniqueness Fix\nCurrent: UNIQUE(agent_id, external_id)\nProblem: Aider uses filename as external_id → guaranteed collision across machines\nFix: UNIQUE(source_id, agent_id, external_id)\n\n## Dependencies\nNone - this is the foundation\n\n## Acceptance Criteria\n- [ ] Source/Origin types compile and are well-documented\n- [ ] sources table created with migration\n- [ ] conversations has source_id column (defaults to \"local\")\n- [ ] Tantivy fields added and schema hash bumped\n- [ ] Existing users can upgrade (DB backup + rebuild path works)\n- [ ] Unit tests for new types","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-16T00:53:45.135519-05:00","updated_at":"2025-12-16T01:45:08.476613-05:00","closed_at":"2025-12-16T01:45:08.476613-05:00","close_reason":"Phase 1 epic - organizational container, tasks can proceed independently","dependencies":[{"issue_id":"coding_agent_session_search-495","depends_on_id":"coding_agent_session_search-4f6","type":"blocks","created_at":"2025-12-16T00:55:58.120799-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-4f6","title":"Remote Sources \u0026 Provenance Epic","description":"# Remote Sources \u0026 Provenance System\n\n## Vision\nEnable cass to ingest, search, and display agent conversation history from multiple machines, making it the canonical \"agent history search layer\" for multi-machine workflows.\n\n## Problem Statement\nDevelopers work across multiple machines (laptop, desktop, cloud dev environments). Agent history is currently siloed per machine:\n- Solutions discovered on work laptop are invisible when searching from home desktop\n- No cross-machine knowledge discovery\n- CMS and other tools need a unified search layer\n\n## Core Capabilities\n1. **Remote session ingestion** via SSH using existing SSH configs/keys\n2. **First-class provenance metadata** (source_id, origin_kind, origin_host) stored as queryable fields\n3. **Filtering** by source/origin in CLI, TUI, and robot outputs\n4. **Visual distinction** for remote-origin records (darker shade + badge)\n\n## Architecture Decisions\n\n### Mirror vs Direct Query\nChosen: Local mirroring. Rationale:\n- cass view needs local file access for source context\n- Offline access is valuable\n- Search performance depends on local index\n- Incremental sync more efficient than per-query fetches\n\n### Provenance as First-Class Fields\nNot just metadata_json - enables:\n- Efficient Tantivy filtering\n- Clean CLI/robot output\n- Type-safe code handling\n\n### Workspace Path Rewriting\nEnables cross-machine workspace filtering:\n- /home/user/projects → /Users/user/projects mapping\n- Makes workspace filters meaningful across machines\n\n## Success Criteria\n- [ ] Can add SSH source and sync logs from remote machine\n- [ ] Search results show provenance (source_id, host)\n- [ ] CLI --source filter works correctly\n- [ ] TUI shows visual distinction for remote results\n- [ ] Robot output includes provenance fields\n- [ ] No identity collisions across sources\n- [ ] Existing users can upgrade without data loss\n\n## References\n- SUGGESTED_IMPROVEMENTS_TO_CASS_BASED_ON_CMS.md\n- README.md \"Roadmap \u0026 Future Directions\" → \"Collaborative Features\"","status":"in_progress","priority":1,"issue_type":"epic","created_at":"2025-12-16T00:53:16.799-05:00","updated_at":"2025-12-16T01:38:15.850143-05:00"}
{"id":"coding_agent_session_search-4ga","title":"P7.4 Collision and deduplication tests","description":"# P7.4 Collision and deduplication tests\n\n## Overview\nTests for edge cases where the same session might appear from multiple sources\nor where session IDs collide across sources.\n\n## Test Cases\n\n### Same Session from Multiple Sources\n```rust\n#[tokio::test]\nasync fn test_same_session_different_sources() {\n    // Scenario: User syncs from laptop, then laptop syncs same session later\n    // Each should be treated as separate if sync timestamps differ\n    \n    let session_id = \"conv_abc123\";\n    \n    // First sync\n    let first_sync = create_session_fixture(session_id, \"laptop\", Utc::now() - Duration::hours(2));\n    indexer.add_root(\u0026first_sync, Provenance::remote_with_timestamp(\"laptop\".into(), Utc::now() - Duration::hours(2)));\n    indexer.index_all().await.unwrap();\n    \n    // Second sync (updated content)\n    let second_sync = create_session_fixture(session_id, \"laptop\", Utc::now());\n    indexer.add_root(\u0026second_sync, Provenance::remote_with_timestamp(\"laptop\".into(), Utc::now()));\n    indexer.index_incremental().await.unwrap();\n    \n    // Should have only one entry (updated)\n    let results = searcher.search_by_id(session_id).await.unwrap();\n    assert_eq!(results.len(), 1);\n    assert_eq!(results[0].sync_timestamp, Some(Utc::now()));  // Latest sync\n}\n\n#[tokio::test]\nasync fn test_same_id_different_sources_are_distinct() {\n    // Scenario: Two different machines happen to have sessions with same ID\n    // (unlikely with UUIDs but possible with sequential IDs)\n    \n    let session_id = \"session_001\";\n    \n    // Local session\n    let local = create_session_fixture(session_id, \"local\", Utc::now());\n    indexer.add_root(\u0026local, Provenance::local());\n    \n    // Remote session with same ID but different content\n    let remote = create_session_fixture_with_content(session_id, \"remote\", \"different content\");\n    indexer.add_root(\u0026remote, Provenance::remote(\"laptop\".into()));\n    \n    indexer.index_all().await.unwrap();\n    \n    // Should have TWO entries (distinguished by source)\n    let results = searcher.search_all_by_id(session_id).await.unwrap();\n    assert_eq!(results.len(), 2);\n    \n    // Filter should work\n    let local_only = searcher.search_by_id_and_source(session_id, SourceFilter::Local).await.unwrap();\n    assert_eq!(local_only.len(), 1);\n}\n```\n\n### Deduplication Respects Sources\n```rust\n#[tokio::test]\nasync fn test_dedup_within_source_not_across() {\n    // Same session file indexed twice from same source should dedup\n    indexer.add_root(\u0026sessions, Provenance::remote(\"laptop\".into()));\n    indexer.index_all().await.unwrap();\n    \n    // Index again (simulating re-sync)\n    indexer.add_root(\u0026sessions, Provenance::remote(\"laptop\".into()));\n    indexer.index_all().await.unwrap();\n    \n    // Should still have same count (deduplicated)\n    assert_eq!(db.conversation_count().await.unwrap(), sessions.len());\n}\n```\n\n## Dependencies\n- Requires P2.3 (deduplication logic)\n- Requires P7.3 (basic multi-source tests)\n\n## Acceptance Criteria\n- [ ] Updated sessions replace old versions\n- [ ] Same ID from different sources kept separate\n- [ ] Re-sync doesn't create duplicates\n- [ ] Composite key (id + source) is unique constraint","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:12:32.873769-05:00","updated_at":"2025-12-16T01:12:32.873769-05:00","dependencies":[{"issue_id":"coding_agent_session_search-4ga","depends_on_id":"coding_agent_session_search-8ej","type":"blocks","created_at":"2025-12-16T01:13:27.166594-05:00","created_by":"jemanuel"},{"issue_id":"coding_agent_session_search-4ga","depends_on_id":"coding_agent_session_search-0go","type":"blocks","created_at":"2025-12-16T01:13:32.427597-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-4ua","title":"P3.6 Update robot-docs schema and introspect command","description":"# P3.6 Update robot-docs schema and introspect command\n\n## Overview\nUpdate the robot-docs schema documentation and `cass introspect --json` output\nto include the new provenance fields.\n\n## Implementation Details\n\n### robot-docs Schema Update\nIn `src/lib.rs`, update `robot_docs_schema`:\n```rust\nconst ROBOT_DOCS_SCHEMA: \u0026str = r#\"\n# CASS Robot Output Schema\n\n## Search Result Fields\n\n### Required Fields\n- `agent`: Agent slug (e.g., \"claude-code\", \"cursor\")\n- `source_path`: Path to session file\n- `line_number`: Line number in source file\n- `content`: Matched content text\n- `score`: Relevance score (0.0 - 1.0)\n\n### Optional Fields (new)\n- `source_id`: Provenance source identifier (e.g., \"local\", \"work-laptop\")\n- `origin_kind`: \"local\" or \"ssh\"\n- `origin_host`: Display hostname for remote sources\n- `workspace_original`: Original workspace path before rewriting (if mapped)\n\n### Backward Compatibility\nNew fields are optional and absent when not available (pre-provenance data).\nConsumers should handle missing fields gracefully.\n\"#;\n```\n\n### introspect --json Update\nExtend introspect output with schema info:\n```rust\n#[derive(Serialize)]\nstruct IntrospectOutput {\n    version: String,\n    schema_version: u32,\n    agents: Vec\u003cAgentInfo\u003e,\n    // NEW: field documentation\n    search_result_fields: Vec\u003cFieldInfo\u003e,\n}\n\n#[derive(Serialize)]\nstruct FieldInfo {\n    name: String,\n    field_type: String,  // \"string\", \"number\", \"boolean\"\n    required: bool,\n    description: String,\n}\n\nfn search_result_field_info() -\u003e Vec\u003cFieldInfo\u003e {\n    vec![\n        FieldInfo {\n            name: \"source_id\".into(),\n            field_type: \"string\".into(),\n            required: false,\n            description: \"Provenance source identifier\".into(),\n        },\n        // ... other fields\n    ]\n}\n```\n\n### CLI Help Update\n```\ncass robot-docs --help\n\n  --schemas    Print the output schema documentation\n  --fields     List available fields in search results\n```\n\n## Dependencies\n- Requires P3.3 (SearchHit has provenance fields)\n- Part of Phase 3\n\n## Acceptance Criteria\n- [ ] robot-docs schema includes new fields\n- [ ] introspect --json includes field documentation\n- [ ] Schema documentation is accurate\n- [ ] Backward compatibility noted in docs","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:28:07.616717-05:00","updated_at":"2025-12-16T12:59:13.627765-05:00","closed_at":"2025-12-16T12:59:13.627765-05:00","close_reason":"Schema updates completed via P3.4: source_id, origin_kind, origin_host added to search response schema in build_response_schemas(). Introspect --json includes full schema with provenance fields. robot-docs schemas shows simplified view.","dependencies":[{"issue_id":"coding_agent_session_search-4ua","depends_on_id":"coding_agent_session_search-alb","type":"blocks","created_at":"2025-12-16T01:28:28.863427-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-59a","title":"bd-ci-e2e-job","description":"Add CI job to run e2e smoke (optional watch gated)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:58.954916519Z","updated_at":"2025-11-23T20:05:34.030488863Z","closed_at":"2025-11-23T20:05:34.030488863Z","dependencies":[{"issue_id":"coding_agent_session_search-59a","depends_on_id":"coding_agent_session_search-618","type":"blocks","created_at":"2025-11-23T17:35:58.956588654Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-59a","depends_on_id":"coding_agent_session_search-5la","type":"blocks","created_at":"2025-11-23T17:35:58.958496993Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-5kr","title":"Phase 7: Testing \u0026 Fixture Coverage for Provenance","description":"# Phase 7: Testing \u0026 Fixture Coverage for Provenance\n\n## Overview\nComprehensive test coverage for the entire remote sources and provenance feature.\nThis phase ensures all new functionality is thoroughly tested with unit tests,\nintegration tests, and realistic fixtures.\n\n## Goals\n1. Unit tests for provenance types and source configuration parsing\n2. Integration tests for sync engine (mocked SSH)\n3. Collision/deduplication tests across sources\n4. Migration tests (schema upgrade paths)\n5. Test fixtures simulating multi-machine scenarios\n\n## Test Categories\n\n### Unit Tests\n- Source/SourceType enum serialization\n- Provenance struct construction\n- Path mapping logic\n- Config file parsing\n\n### Integration Tests\n- Full index with mixed local/remote sessions\n- Search filtering by source\n- Timeline filtering by source\n- Deduplication with same session from multiple sources\n\n### E2E Tests\n- `cass sources add` with mock SSH\n- `cass sources sync` with fixture data\n- `cass sources doctor` output validation\n\n### Fixture Requirements\n- Multi-source fixture set (local + 2 remotes)\n- Sessions with overlapping IDs across sources\n- Various agent types from each source\n\n## Dependencies\n- Should be developed incrementally alongside Phases 1-5\n- Final validation after Phase 5 completion\n\n## Acceptance Criteria\n- [ ] \u003e80% code coverage for new provenance code\n- [ ] No regressions in existing test suite\n- [ ] Collision edge cases documented and tested\n- [ ] CI runs full provenance test suite","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-16T01:01:19.302581-05:00","updated_at":"2025-12-16T01:01:19.302581-05:00","dependencies":[{"issue_id":"coding_agent_session_search-5kr","depends_on_id":"coding_agent_session_search-bgi","type":"blocks","created_at":"2025-12-16T01:01:54.609007-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-5kz","title":"bd-docs-oneliner","description":"Update README with installer one-liners (bash/pwsh), flags/env docs, safety notes, quickstart steps, TUI_HEADLESS usage.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:36.311428605Z","updated_at":"2025-11-23T20:20:39.653751467Z","closed_at":"2025-11-23T20:20:39.653751467Z","dependencies":[{"issue_id":"coding_agent_session_search-5kz","depends_on_id":"coding_agent_session_search-2d0","type":"blocks","created_at":"2025-11-23T20:14:36.312720318Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-5kz","depends_on_id":"coding_agent_session_search-zwe","type":"blocks","created_at":"2025-11-23T20:14:36.314674338Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-5kz","depends_on_id":"coding_agent_session_search-xgx","type":"blocks","created_at":"2025-11-23T20:14:36.316068752Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-5la","title":"bd-e2e-install-scripts","description":"Checksum pass/fail tests for install.sh/install.ps1 using local file:// artifacts","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:39.249387828Z","updated_at":"2025-11-23T20:05:24.753662725Z","closed_at":"2025-11-23T20:05:24.753662725Z"}
{"id":"coding_agent_session_search-618","title":"bd-e2e-index-tui-smoke","description":"Seed fixtures, run index --full, launch tui noninteractive, assert logs/doc count","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:29.995711414Z","updated_at":"2025-11-23T20:05:28.45153648Z","closed_at":"2025-11-23T20:05:28.45153648Z","dependencies":[{"issue_id":"coding_agent_session_search-618","depends_on_id":"coding_agent_session_search-c7b","type":"blocks","created_at":"2025-11-23T17:35:29.997261222Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-618","depends_on_id":"coding_agent_session_search-dja","type":"blocks","created_at":"2025-11-23T17:35:29.999007131Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-61q","title":"bd-watch-e2e","description":"Optional: watch-mode e2e smoke (touch fixture -\u003e reindex) integrated into easy-mode demo.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-23T20:14:46.855239305Z","updated_at":"2025-11-30T05:30:33.572816676Z","closed_at":"2025-11-30T05:30:33.572816676Z","dependencies":[{"issue_id":"coding_agent_session_search-61q","depends_on_id":"coding_agent_session_search-xgx","type":"blocks","created_at":"2025-11-23T20:14:46.856619018Z","created_by":"daemon"}],"comments":[{"id":2,"issue_id":"coding_agent_session_search-61q","author":"ubuntu","text":"Added watch_e2e.rs smoke (ignored by default) that starts cass index --watch in isolated data dir with CODEX_HOME fixture, touches rollout file, and asserts watch_state.json updated for Codex. Marked ignored due to flaky notify in CI; keeps manual coverage. fmt/check/clippy clean.","created_at":"2025-12-01T23:22:10Z"},{"id":3,"issue_id":"coding_agent_session_search-61q","author":"ubuntu","text":"Revised watch-mode smoke: added env hook CASS_TEST_WATCH_PATHS to force single reindex callback in watch_sources (deterministic for manual runs). watch_e2e.rs updated to use hook and still ignored (notify flaky in CI). Tests fmt/check/clippy clean.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-66o","title":"TST.8 Unit: global flags \u0026 defaults coverage","description":"Tests verifying global flags propagate and introspect shows defaults: limit/offset/context/stale-threshold, color/progress/wrap/nowrap/db; assert no regressions from dynamic schema builder.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-01T18:56:54.019937463Z","updated_at":"2025-12-01T18:56:54.019937463Z","dependencies":[{"issue_id":"coding_agent_session_search-66o","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-12-01T18:58:05.582637993Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-67r","title":"P4.2 Source badge/tag in result rows","description":"# P4.2 Source badge/tag in result rows\n\n## Overview\nAdd a compact badge or tag showing the source hostname for each result row,\nproviding at-a-glance source identification.\n\n## Implementation Details\n\n### Badge Format\n- Local sessions: `[local]` or just omit badge\n- Remote sessions: `[hostname]` abbreviated if needed (e.g., `[laptop]`, `[work-pc]`)\n- Badge appears after agent name or in dedicated column\n\n### Abbreviation Logic\n```rust\nfn abbreviate_hostname(hostname: \u0026str, max_len: usize) -\u003e String {\n    if hostname.len() \u003c= max_len {\n        hostname.to_string()\n    } else {\n        // Take first part before dots, truncate if needed\n        let first_part = hostname.split('.').next().unwrap_or(hostname);\n        if first_part.len() \u003c= max_len {\n            first_part.to_string()\n        } else {\n            format!(\"{}…\", \u0026first_part[..max_len-1])\n        }\n    }\n}\n```\n\n### Row Layout Update\n```\n┌────────────────────────────────────────────────────────────┐\n│ claude-code [laptop]  /projects/myapp  \"Fixed auth\"  0.95 │\n│ cursor      [local]   /projects/other  \"API refactor\" 0.87│\n└────────────────────────────────────────────────────────────┘\n```\n\n### Badge Styling\n```rust\nlet badge_style = match source_type {\n    SourceType::Remote =\u003e Style::new().fg(Color::Cyan).add_modifier(Modifier::DIM),\n    SourceType::Local =\u003e Style::new().fg(Color::DarkGray),\n};\n```\n\n## Dependencies\n- Requires P3.3 (SearchHit has source_hostname)\n- Can be done in parallel with P4.1\n\n## Acceptance Criteria\n- [ ] Badge visible for all results with provenance\n- [ ] Hostname abbreviated appropriately (max ~10 chars)\n- [ ] Badge doesn't crowd other columns\n- [ ] Consistent styling with overall TUI theme","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:04:47.272673-05:00","updated_at":"2025-12-16T14:12:06.320665-05:00","closed_at":"2025-12-16T14:12:06.320665-05:00","close_reason":"Implemented as part of P4.1: Source badge [hostname] added to location line for remote sessions. Uses purple styling with italic modifier. Badge omitted for local sessions.","dependencies":[{"issue_id":"coding_agent_session_search-67r","depends_on_id":"coding_agent_session_search-alb","type":"blocks","created_at":"2025-12-16T01:07:02.001482-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-6hx","title":"TUI experience (ratatui)","description":"Three-pane UI, filters, hotkeys, theming, detail view wired to live search results.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-21T01:27:33.20245957Z","updated_at":"2025-11-23T14:36:59.120005075Z","closed_at":"2025-11-23T14:36:59.120005075Z","dependencies":[{"issue_id":"coding_agent_session_search-6hx","depends_on_id":"coding_agent_session_search-lz1","type":"blocks","created_at":"2025-11-21T01:27:33.205252584Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-6hx","depends_on_id":"coding_agent_session_search-974","type":"blocks","created_at":"2025-11-21T01:27:33.206138489Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-6hx.1","title":"TUI skeleton layout (search bar + results + detail)","description":"Implement ratatui layout and navigation with mock data; focus on top bar, list pane, detail pane, status line.","notes":"TUI shell stub using ratatui/crossterm; basic frame and quit key; wiring from CLI.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:29:27.345909506Z","updated_at":"2025-11-23T14:34:05.818036885Z","closed_at":"2025-11-23T14:34:05.818036885Z","dependencies":[{"issue_id":"coding_agent_session_search-6hx.1","depends_on_id":"coding_agent_session_search-lz1.4","type":"blocks","created_at":"2025-11-21T01:29:27.347729667Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-6hx.2","title":"Wire TUI to search engine (debounced queries, pagination)","description":"Connect input to search API, show live results, handle empty/error states, debounce keystrokes ~100-150ms.","notes":"Tantivy search client returns real docs (agent/time filters, snippets, source path) using TantivyDocument; wired TUI to live search results with status messaging and error handling; clippy/fmt/check clean.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:29:31.354069136Z","updated_at":"2025-11-21T18:09:31.286026038Z","closed_at":"2025-11-21T18:09:31.286034539Z","dependencies":[{"issue_id":"coding_agent_session_search-6hx.2","depends_on_id":"coding_agent_session_search-6hx.1","type":"blocks","created_at":"2025-11-21T01:29:31.356056654Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-6hx.2","depends_on_id":"coding_agent_session_search-974.1","type":"blocks","created_at":"2025-11-21T01:29:31.357847571Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-6hx.3","title":"Filters UI (agent/time/workspace) + config toggles","description":"Implement modals/popovers for agent selection, time ranges, workspaces; persist selection; integrate with search filters.","notes":"Filters UI + pagination wired in TUI; SQLite FTS5 mirror with migration/backfill + insert hooks; added Tantivy search integration test covering filters/pagination.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:29:34.517433745Z","updated_at":"2025-11-21T18:41:04.617314873Z","closed_at":"2025-11-21T18:41:04.617325273Z","dependencies":[{"issue_id":"coding_agent_session_search-6hx.3","depends_on_id":"coding_agent_session_search-6hx.2","type":"blocks","created_at":"2025-11-21T01:29:34.51920136Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-6hx.4","title":"Conversation detail view (messages/snippets/raw)","description":"Render selected conversation with role coloring, timestamps, tabs for snippets and raw JSON references; open-source log path shortcut.","notes":"Added Codex connector fixture test; TUI detail pane with selection and hotkeys (j/k, arrows) and pagination-aware selection.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:29:39.639071357Z","updated_at":"2025-11-21T18:46:26.968523971Z","closed_at":"2025-11-21T18:46:26.968523971Z","dependencies":[{"issue_id":"coding_agent_session_search-6hx.4","depends_on_id":"coding_agent_session_search-6hx.2","type":"blocks","created_at":"2025-11-21T01:29:39.641922183Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-6hx.5","title":"TUI polish: theming, hotkeys, performance","description":"Add dark/light themes, hotkey legend, accessibility tweaks, reduce allocations/redraws for smooth 60fps terminal experience.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-21T01:29:42.892781635Z","updated_at":"2025-11-23T14:34:17.647766052Z","closed_at":"2025-11-23T14:34:17.647766052Z","dependencies":[{"issue_id":"coding_agent_session_search-6hx.5","depends_on_id":"coding_agent_session_search-6hx.3","type":"blocks","created_at":"2025-11-21T01:29:42.895823379Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-6hx.5","depends_on_id":"coding_agent_session_search-6hx.4","type":"blocks","created_at":"2025-11-21T01:29:42.897105998Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-6k7","title":"Update contract golden files for capabilities/introspect tests","description":"Tests failing due to contract drift:\n- capabilities_matches_golden_contract (connectors list changed, new features added, limits changed)\n- introspect_matches_golden_contract (similar changes)\n\nNeed to update the expected golden contract values in tests/cli_robot.rs to match current implementation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T18:36:14.941362-05:00","updated_at":"2025-12-01T18:41:08.363866-05:00","closed_at":"2025-12-01T18:41:08.363866-05:00"}
{"id":"coding_agent_session_search-73c","title":"TUI detail pane: full conversation rendering","description":"Render full conversation timeline with role labels, timestamps, search term highlighting, and code block styling in detail pane.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-23T07:51:23.177621101Z","updated_at":"2025-11-23T07:55:45.275528398Z","closed_at":"2025-11-23T07:55:45.275528398Z","labels":["detail","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-73c","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:51:23.190367063Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-77b","title":"Distribution \u0026 installers","description":"Build \u0026 release automation, curl|bash installer, PowerShell installer, cross-platform binaries via cargo-dist.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-21T01:27:38.505945954Z","updated_at":"2025-11-23T14:36:58.128283855Z","closed_at":"2025-11-23T14:36:58.128283855Z","dependencies":[{"issue_id":"coding_agent_session_search-77b","depends_on_id":"coding_agent_session_search-acz","type":"blocks","created_at":"2025-11-21T01:27:38.512816485Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-77b.1","title":"Release pipeline with cargo-dist (multi-platform binaries)","description":"Set up GitHub Actions to build nightly-based binaries for linux/macos/windows (x86_64/arm64), upload artifacts.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:29:47.010380164Z","updated_at":"2025-11-23T14:34:15.453408686Z","closed_at":"2025-11-23T14:34:15.453408686Z","dependencies":[{"issue_id":"coding_agent_session_search-77b.1","depends_on_id":"coding_agent_session_search-acz.1","type":"blocks","created_at":"2025-11-21T01:29:47.011947987Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-77b.2","title":"curl|bash + PowerShell installers (easy-mode, checksum verification)","description":"Author install.sh and install.ps1 modeled on UBS: os/arch detection, checksum verification, PATH guidance, --easy-mode automation.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:29:55.161241897Z","updated_at":"2025-11-23T14:34:16.549220909Z","closed_at":"2025-11-23T14:34:16.549220909Z","dependencies":[{"issue_id":"coding_agent_session_search-77b.2","depends_on_id":"coding_agent_session_search-77b.1","type":"blocks","created_at":"2025-11-21T01:29:55.163349616Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-77b.3","title":"Packaging polish (shell completions, Homebrew tap stubs, version metadata)","description":"Generate completions/man pages, prep Homebrew formula stub, embed version/build info (vergen) in binaries.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-21T01:29:59.79299823Z","updated_at":"2025-11-23T14:37:53.869604198Z","closed_at":"2025-11-23T14:37:53.869604198Z","dependencies":[{"issue_id":"coding_agent_session_search-77b.3","depends_on_id":"coding_agent_session_search-77b.1","type":"blocks","created_at":"2025-11-21T01:29:59.794274642Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew","title":"Connectors: agent history ingestion","description":"Implement detection + parsers for Codex, Cline, Gemini, Claude Code, OpenCode, Amp; emit normalized conversations.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-21T01:27:26.499272708Z","updated_at":"2025-11-23T14:36:28.558260625Z","closed_at":"2025-11-23T14:36:28.558260625Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew","depends_on_id":"coding_agent_session_search-flk","type":"blocks","created_at":"2025-11-21T01:27:26.515405189Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew.1","title":"Connector framework: detection + normalization interfaces","description":"Define ScanContext, NormalizedConversation/Message/Snippet structs, detection heuristics, and shared utilities (path discovery, timestamp parsing).","notes":"Connector framework + Codex/Cline/Gemini/Claude/Amp/OpenCode connectors implemented; remaining connectors now partial but present.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:39.081913423Z","updated_at":"2025-11-21T03:01:41.675782631Z","closed_at":"2025-11-21T03:01:41.675782631Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew.1","depends_on_id":"coding_agent_session_search-flk.3","type":"blocks","created_at":"2025-11-21T01:28:39.08333854Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew.2","title":"Codex CLI connector (rollout JSONL)","description":"Detect CODEX_HOME, parse rollout-*.jsonl/history.jsonl, map sessions to normalized conversations with workspace links.","notes":"Codex connector implemented (rollout jsonl), wired into index","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:42.682471614Z","updated_at":"2025-11-21T03:01:46.481093146Z","closed_at":"2025-11-21T03:01:46.481093146Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew.2","depends_on_id":"coding_agent_session_search-7ew.1","type":"blocks","created_at":"2025-11-21T01:28:42.684453723Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew.3","title":"Cline VS Code connector (task directories)","description":"Locate VS Code globalStorage for Cline, parse taskHistory + per-task metadata/ui/api files into conversations.","notes":"Cline connector implemented (VS Code globalStorage task dirs ui/api history)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:47.475523121Z","updated_at":"2025-11-21T03:01:51.765995653Z","closed_at":"2025-11-21T03:01:51.765995653Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew.3","depends_on_id":"coding_agent_session_search-7ew.1","type":"blocks","created_at":"2025-11-21T01:28:47.477650988Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew.4","title":"Gemini CLI connector (~/.gemini/tmp)","description":"Scan ~/.gemini/tmp project dirs, parse chat/checkpoint JSON, reconstruct conversations with ordering and timestamps.","notes":"Gemini connector implemented (~/.gemini/tmp json/jsonl)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:52.081959721Z","updated_at":"2025-11-21T03:01:57.593971676Z","closed_at":"2025-11-21T03:01:57.593976876Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew.4","depends_on_id":"coding_agent_session_search-7ew.1","type":"blocks","created_at":"2025-11-21T01:28:52.083651175Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew.5","title":"Claude Code connector (projects dir + .claude files)","description":"Scan ~/.claude/projects JSONL and per-repo .claude/.claude.json, parse sessions into normalized threads.","notes":"Claude Code connector implemented (~/.claude/projects jsonl)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:55.261135756Z","updated_at":"2025-11-21T03:02:01.840157837Z","closed_at":"2025-11-21T03:02:01.840165537Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew.5","depends_on_id":"coding_agent_session_search-7ew.1","type":"blocks","created_at":"2025-11-21T01:28:55.262328971Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew.6","title":"OpenCode connector (SQLite .opencode)","description":"Detect project/global .opencode SQLite DBs, map sessions/messages tables into normalized model, handle incremental imports.","notes":"OpenCode connector detection done (.opencode dirs); scan placeholder until DB schema sample available.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:29:02.461369196Z","updated_at":"2025-11-23T14:34:04.924887382Z","closed_at":"2025-11-23T14:34:04.924887382Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew.6","depends_on_id":"coding_agent_session_search-7ew.1","type":"blocks","created_at":"2025-11-21T01:29:02.463399194Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7ew.7","title":"Amp connector (local cache only)","description":"Detect VS Code globalStorage and ~/.local/share/amp caches, ingest whatever local JSON/JSONL threads exist, tag as partial coverage.","notes":"Amp connector detect only (data_dir/amp); awaiting cache sample for full ingest.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:29:05.451501003Z","updated_at":"2025-11-23T14:34:03.96338355Z","closed_at":"2025-11-23T14:34:03.96338355Z","dependencies":[{"issue_id":"coding_agent_session_search-7ew.7","depends_on_id":"coding_agent_session_search-7ew.1","type":"blocks","created_at":"2025-11-21T01:29:05.452554602Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7l5","title":"bd-unit-search","description":"Search filters/highlight/pagination tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:19.489876059Z","updated_at":"2025-11-23T20:05:55.429294293Z","closed_at":"2025-11-23T20:05:55.429294293Z","dependencies":[{"issue_id":"coding_agent_session_search-7l5","depends_on_id":"coding_agent_session_search-lxx","type":"blocks","created_at":"2025-11-23T17:35:19.491608766Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-7q7","title":"bd-installer-tests","description":"Add fixtures + tests: install.sh good/bad checksum via file://; install.ps1 good/bad checksum (skip if pwsh unavailable); easy-mode noninteractive path.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:26.463865848Z","updated_at":"2025-11-23T20:20:30.453471631Z","closed_at":"2025-11-23T20:20:30.453471631Z","dependencies":[{"issue_id":"coding_agent_session_search-7q7","depends_on_id":"coding_agent_session_search-2d0","type":"blocks","created_at":"2025-11-23T20:14:26.465114761Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-7q7","depends_on_id":"coding_agent_session_search-zwe","type":"blocks","created_at":"2025-11-23T20:14:26.466777378Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-80s","title":"P7.6 Multi-source test fixtures","description":"# P7.6 Multi-source test fixtures\n\n## Overview\nCreate comprehensive test fixtures simulating multi-machine scenarios for\nintegration and E2E testing.\n\n## Fixture Structure\n\n### Directory Layout\n```\ntests/fixtures/multi_source/\n├── local/\n│   ├── claude-code/\n│   │   └── projects/\n│   │       └── proj1/\n│   │           └── session_local_1.json\n│   └── cursor/\n│       └── workspace/\n│           └── session_local_2.json\n├── remote_laptop/\n│   ├── claude-code/\n│   │   └── projects/\n│   │       └── proj1/\n│   │           └── session_laptop_1.json\n│   └── goose/\n│       └── sessions/\n│           └── session_laptop_2.json\n└── remote_workstation/\n    └── claude-code/\n        └── projects/\n            └── proj2/\n                └── session_work_1.json\n```\n\n### Session Characteristics\nEach fixture set should include:\n- Different agents per source\n- Overlapping workspaces (same project on multiple machines)\n- Varying message counts\n- Date ranges spanning weeks\n\n### Fixture Generation Helper\n```rust\npub fn create_multi_source_fixture(base_dir: \u0026Path) -\u003e TestFixture {\n    let fixture = TestFixture::new(base_dir);\n    \n    // Local sessions\n    fixture.add_session(SessionBuilder::new()\n        .id(\"local_1\")\n        .agent(\"claude-code\")\n        .workspace(\"/Users/me/projects/myapp\")\n        .messages(vec![\n            (\"user\", \"Fix the login bug\"),\n            (\"assistant\", \"I'll look at the auth module...\"),\n        ])\n        .source(Source::Local)\n        .build());\n    \n    // Remote laptop sessions\n    fixture.add_session(SessionBuilder::new()\n        .id(\"laptop_1\")\n        .agent(\"claude-code\")\n        .workspace(\"/home/user/projects/myapp\")  // Same project, different path\n        .messages(vec![\n            (\"user\", \"Add logout button\"),\n            (\"assistant\", \"Adding to the header...\"),\n        ])\n        .source(Source::Remote { hostname: \"laptop\" })\n        .build());\n    \n    // ... more sessions\n    \n    fixture\n}\n```\n\n### Fixture Validation\n```rust\n#[test]\nfn test_fixture_validity() {\n    let fixture = load_multi_source_fixture();\n    \n    // Validate all sessions parse correctly\n    for session in fixture.all_sessions() {\n        assert!(session.id.len() \u003e 0);\n        assert!(session.messages.len() \u003e 0);\n    }\n    \n    // Validate source distribution\n    let local_count = fixture.sessions_by_source(Source::Local).len();\n    let remote_count = fixture.sessions_by_source(Source::Remote).len();\n    assert!(local_count \u003e 0);\n    assert!(remote_count \u003e 0);\n}\n```\n\n## Dependencies\n- Foundation for P7.3, P7.4\n\n## Acceptance Criteria\n- [ ] Fixtures cover all supported agents\n- [ ] Both local and remote sources represented\n- [ ] Overlapping workspace scenarios included\n- [ ] Fixture loader helper for tests\n- [ ] Fixtures valid and parseable","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:12:45.017201-05:00","updated_at":"2025-12-16T01:12:45.017201-05:00","dependencies":[{"issue_id":"coding_agent_session_search-80s","depends_on_id":"coding_agent_session_search-epe","type":"blocks","created_at":"2025-12-16T01:13:42.94346-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-8aq","title":"bd-ci-installer-smoke","description":"Add CI job running installer tests on Linux (and pwsh when available).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:42.112006823Z","updated_at":"2025-11-23T20:20:44.163262037Z","closed_at":"2025-11-23T20:20:44.163262037Z","dependencies":[{"issue_id":"coding_agent_session_search-8aq","depends_on_id":"coding_agent_session_search-7q7","type":"blocks","created_at":"2025-11-23T20:14:42.113306836Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-8ej","title":"P2.3 Fix deduplication to respect source boundaries","description":"# Fix Deduplication to Respect Source Boundaries\n\n## Context\nCurrent search dedup keys only on normalized content. This can hide results from one source when a \"better\" result from another source is kept.\n\n## Problem\nWithout this fix:\n- User searches for \"authentication bug\"\n- work-laptop has a relevant result with score 0.9\n- local has the same result with score 0.85\n- Dedup keeps only work-laptop's result\n- User doesn't know the same conversation exists locally\n\nThis violates the principle that \"remote logs are distinct.\"\n\n## Location\nsrc/search/query.rs - deduplicate_hits() function\n\n## Current Logic\n\\`\\`\\`rust\nfn deduplicate_hits(hits: Vec\u003cSearchHit\u003e, ...) -\u003e Vec\u003cSearchHit\u003e {\n    // Keys on: (normalized_content_hash, ...)\n    // Keeps highest score\n}\n\\`\\`\\`\n\n## New Logic\nInclude source_id in dedup key:\n\\`\\`\\`rust\nfn deduplicate_hits(hits: Vec\u003cSearchHit\u003e, ...) -\u003e Vec\u003cSearchHit\u003e {\n    let mut seen = HashSet::new();\n    for hit in hits {\n        let key = (\n            hit.source_id.as_deref().unwrap_or(\"local\"),\n            normalize_for_dedup(\u0026hit.content),\n            // other key components...\n        );\n        if seen.insert(key) {\n            result.push(hit);\n        }\n    }\n}\n\\`\\`\\`\n\n## Alternative: Configurable Behavior\nCould offer a flag:\n- --dedup-across-sources (current behavior, for users who want it)\n- default: dedup within source only\n\nFor MVP: just fix to dedup within source only.\n\n## Edge Case: Same Source, Multiple Paths\nWhat if the same conversation is indexed from two different paths on the same source? (e.g., symlinks)\n- Keep current behavior: dedup by (source, content_hash)\n- Same source + same content = deduplicate\n\n## Dependencies\n- P1.4 (source_id in SearchHit)\n\n## Acceptance Criteria\n- [ ] Dedup key includes source_id\n- [ ] Same content from different sources appears as separate results\n- [ ] Same content from same source still deduplicated\n- [ ] Tests verify both cases","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:57:54.371745-05:00","updated_at":"2025-12-16T03:32:19.842201-05:00","closed_at":"2025-12-16T03:32:19.842201-05:00","close_reason":"Deduplication now keys on (source_id, normalized_content). Same content from different sources kept as separate results. Added test for source boundary behavior.","dependencies":[{"issue_id":"coding_agent_session_search-8ej","depends_on_id":"coding_agent_session_search-pkw","type":"blocks","created_at":"2025-12-16T00:58:22.351334-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-8ns","title":"TUI polish: Midnight Grid theme + agent badges","description":"Implement visual theme (accents, backgrounds), agent badges, role-colored messages, improved result rows, and friendly empty/error states.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T07:51:12.079664045Z","updated_at":"2025-11-23T07:55:33.898794798Z","closed_at":"2025-11-23T07:55:33.898794798Z","labels":["theme","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-8ns","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:51:12.093297599Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-96r","title":"Phase 4: TUI Visual Distinction \u0026 Filtering","description":"# Phase 4: TUI Visual Distinction \u0026 Filtering\n\n## Overview\nThis phase adds visual distinction in the TUI for remote-origin sessions and provides\ninteractive filtering by source. Users should immediately recognize which results\ncame from which machine.\n\n## Goals\n1. Darker/muted shade for remote-origin session rows\n2. Source badge/tag showing hostname or \"local\"\n3. Source filter in TUI sidebar or header\n4. Keyboard shortcuts for quick source filtering\n\n## Context\nThe TUI (using Ratatui) renders search results in a table. Remote sessions should be\nvisually distinct so users don't confuse local vs remote context. This is especially\nimportant when workspaces are rewritten.\n\n## Design Principles\n- Subtle but clear distinction (don't make remote sessions look \"broken\")\n- Badge should be compact (hostname abbreviation or icon)\n- Filter should be easily togglable without leaving search context\n\n## Dependencies\n- Requires Phase 3 completion (SearchHit has provenance fields)\n- coding_agent_session_search-??? (Phase 3 epic)\n\n## Acceptance Criteria\n- [ ] Remote sessions have visually distinct row styling\n- [ ] Source badge visible in results (e.g., \"[laptop]\" or \"[remote]\")\n- [ ] Press 's' or similar to cycle through source filters\n- [ ] Filter state visible in TUI header/footer\n- [ ] Contrast meets accessibility guidelines (WCAG AA minimum)","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-16T01:01:00.305439-05:00","updated_at":"2025-12-16T01:01:00.305439-05:00","dependencies":[{"issue_id":"coding_agent_session_search-96r","depends_on_id":"coding_agent_session_search-nfk","type":"blocks","created_at":"2025-12-16T01:01:38.919199-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-974","title":"Indexer \u0026 sync orchestrator","description":"Coordinate full and incremental indexing: filesystem watchers, batching, schema versioning, rebuild triggers.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-21T01:27:29.828634027Z","updated_at":"2025-11-23T14:37:09.569507925Z","closed_at":"2025-11-23T14:37:09.569507925Z","dependencies":[{"issue_id":"coding_agent_session_search-974","depends_on_id":"coding_agent_session_search-lz1","type":"blocks","created_at":"2025-11-21T01:27:29.851275541Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-974","depends_on_id":"coding_agent_session_search-7ew","type":"blocks","created_at":"2025-11-21T01:27:29.852606248Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-974.1","title":"Indexer command flow (full + incremental)","description":"Implement index subcommand + service loop wiring channels between connectors and search pipeline; supports full rebuild and incremental pathways.","notes":"Index command now delegates to indexer::run_index (connectors + Tantivy + storage).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:29:09.561975589Z","updated_at":"2025-11-23T14:35:28.584723452Z","closed_at":"2025-11-23T14:35:28.584723452Z","dependencies":[{"issue_id":"coding_agent_session_search-974.1","depends_on_id":"coding_agent_session_search-lz1.2","type":"blocks","created_at":"2025-11-21T01:29:09.563715787Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-974.1","depends_on_id":"coding_agent_session_search-7ew.1","type":"blocks","created_at":"2025-11-21T01:29:09.564995086Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-974.2","title":"Filesystem/watch-based incremental updates","description":"Set up notify watchers for each connector root, debounce events, trigger targeted re-index of changed logs/DBs.","notes":"--watch scaffold uses notify over agent roots; needs improved debounce once search wiring done.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:29:14.651707297Z","updated_at":"2025-11-23T14:35:56.143417287Z","closed_at":"2025-11-23T14:35:56.143417287Z","dependencies":[{"issue_id":"coding_agent_session_search-974.2","depends_on_id":"coding_agent_session_search-974.1","type":"blocks","created_at":"2025-11-21T01:29:14.653505819Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-974.3","title":"Schema migration + index rebuild strategy","description":"Meta table tracks schema version; handle DB migrations and Tantivy index rebuilds with progress reporting.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:29:21.717962Z","updated_at":"2025-11-23T14:37:55.053240945Z","closed_at":"2025-11-23T14:37:55.053240945Z","dependencies":[{"issue_id":"coding_agent_session_search-974.3","depends_on_id":"coding_agent_session_search-974.1","type":"blocks","created_at":"2025-11-21T01:29:21.719091715Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-974.3","depends_on_id":"coding_agent_session_search-flk.1","type":"blocks","created_at":"2025-11-21T01:29:21.722107755Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-9et","title":"Detail pane: conversation timeline","description":"Render full conversation with role coloring, timestamps, search-term highlighting, and open-in-editor action.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-23T07:56:40.91224834Z","updated_at":"2025-11-23T14:34:53.229562572Z","closed_at":"2025-11-23T14:34:53.229562572Z","labels":["detail","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-9et","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:56:40.921156755Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-9ur","title":"P3.1 Add --source flag to search command","description":"# P3.1 Add --source flag to search command\n\n## Overview\nAdd a `--source` filter flag to the `cass search` command that filters results\nby their provenance source.\n\n## Implementation Details\n\n### CLI Argument Definition\nIn `src/cli.rs`, add to SearchArgs:\n```rust\n#[arg(long, value_name = \"SOURCE\")]\n/// Filter results by source (hostname, 'local', 'remote', or 'all')\nsource: Option\u003cString\u003e,\n```\n\n### Filter Logic\nThe `--source` flag accepts:\n- `local` - Only sessions from this machine\n- `remote` - All sessions from other machines  \n- `all` - No filtering (default)\n- `\u003chostname\u003e` - Specific source hostname\n\n### Query Integration\nPass source filter to SearchQuery in `src/lib.rs`:\n```rust\npub struct SearchQuery {\n    pub text: String,\n    pub source_filter: Option\u003cSourceFilter\u003e,\n    // ... existing fields\n}\n\npub enum SourceFilter {\n    Local,\n    Remote,\n    Hostname(String),\n}\n```\n\n### Tantivy Query Modification\nIn search execution, add source filter to Tantivy query:\n```rust\nif let Some(filter) = \u0026query.source_filter {\n    match filter {\n        SourceFilter::Local =\u003e {\n            let term = Term::from_field_text(source_type_field, \"local\");\n            query = BooleanQuery::new(vec![\n                (Occur::Must, Box::new(query)),\n                (Occur::Must, Box::new(TermQuery::new(term, IndexRecordOption::Basic))),\n            ]);\n        }\n        // ... other cases\n    }\n}\n```\n\n## Dependencies\n- Requires P1.4 (Tantivy schema has provenance fields)\n- Part of Phase 3 epic\n\n## Acceptance Criteria\n- [ ] `--source` flag documented in help output\n- [ ] `--source=local` returns only local sessions\n- [ ] `--source=remote` returns only remote sessions\n- [ ] `--source=myhostname` returns sessions from that host\n- [ ] Invalid source values produce helpful error message","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:02:53.940777-05:00","updated_at":"2025-12-16T11:40:56.758755-05:00","closed_at":"2025-12-16T11:40:56.758755-05:00","close_reason":"Implemented --source flag with filtering for local/remote/source_id. 295 tests pass.","dependencies":[{"issue_id":"coding_agent_session_search-9ur","depends_on_id":"coding_agent_session_search-pkw","type":"blocks","created_at":"2025-12-16T01:04:11.941962-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-acz","title":"Foundation: nightly toolchain \u0026 dependency policy","description":"Lock project to latest Rust nightly, define crate version policy (latest releases via wildcard), and align docs/tooling with nightly defaults.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-21T01:27:14.047122374Z","updated_at":"2025-11-23T14:36:43.962541942Z","closed_at":"2025-11-23T14:36:43.962541942Z"}
{"id":"coding_agent_session_search-acz.1","title":"Pin toolchain to latest Rust nightly (rust-toolchain.toml, CI override)","description":"Create rust-toolchain.toml overriding to current nightly; document update cadence; ensure cargo commands use nightly by default.","notes":"Pinned toolchain to nightly via rust-toolchain.toml (rustfmt, clippy).","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-21T01:27:53.995987219Z","updated_at":"2025-11-21T02:44:48.862286981Z","closed_at":"2025-11-21T02:44:48.862286981Z"}
{"id":"coding_agent_session_search-acz.2","title":"Adopt latest-available crate policy (wildcards, audit cadence)","description":"Set dependency version strategy to track newest releases (e.g., '*' or caret to latest), add update workflow (cargo update), and document how to bump frequently.","notes":"Cargo.toml uses wildcard deps; documented latest-crate policy in README and guide.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:27:57.276566452Z","updated_at":"2025-11-21T02:44:52.789640931Z","closed_at":"2025-11-21T02:44:52.789640931Z","dependencies":[{"issue_id":"coding_agent_session_search-acz.2","depends_on_id":"coding_agent_session_search-acz.1","type":"blocks","created_at":"2025-11-21T01:27:57.277754858Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-acz.3","title":"Revise RUST_CLI_TOOLS_BEST_PRACTICES_GUIDE for nightly + latest crates","description":"Update versions/tooling guidance in the guide to reflect nightly toolchain, newest crate minimums, and project-specific constraints (dotenvy usage, sqlx/diesel guidance).","notes":"RUST_CLI_TOOLS_BEST_PRACTICES_GUIDE updated for nightly toolchain + wildcard dependencies; CI step now nightly.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:00.807927005Z","updated_at":"2025-11-21T02:44:57.721576448Z","closed_at":"2025-11-21T02:44:57.721583048Z","dependencies":[{"issue_id":"coding_agent_session_search-acz.3","depends_on_id":"coding_agent_session_search-acz.1","type":"blocks","created_at":"2025-11-21T01:28:00.80916451Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-acz.3","depends_on_id":"coding_agent_session_search-acz.2","type":"blocks","created_at":"2025-11-21T01:28:00.810367516Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-alb","title":"P3.3 Extend SearchHit with provenance fields","description":"# P3.3 Extend SearchHit with provenance fields\n\n## Overview\nAdd provenance metadata to the SearchHit struct so search results carry\nsource information for display and further processing.\n\n## Implementation Details\n\n### SearchHit Extension\nIn `src/lib.rs`, extend the SearchHit struct:\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct SearchHit {\n    // ... existing fields\n    pub conversation_id: String,\n    pub agent: String,\n    pub workspace: String,\n    pub snippet: String,\n    pub score: f32,\n    pub timestamp: DateTime\u003cUtc\u003e,\n    \n    // New provenance fields\n    pub source_hostname: Option\u003cString\u003e,\n    pub source_type: SourceType,\n    pub sync_timestamp: Option\u003cDateTime\u003cUtc\u003e\u003e,\n}\n\n#[derive(Debug, Clone, Serialize, Deserialize, Default)]\npub enum SourceType {\n    #[default]\n    Local,\n    Remote,\n}\n```\n\n### Tantivy Result Population\nWhen building SearchHit from Tantivy document:\n```rust\nfn doc_to_search_hit(doc: \u0026Document, schema: \u0026Schema) -\u003e SearchHit {\n    let source_hostname = doc.get_first(schema.get_field(\"source_hostname\")?)\n        .and_then(|v| v.as_text())\n        .map(String::from);\n    \n    let source_type = doc.get_first(schema.get_field(\"source_type\")?)\n        .and_then(|v| v.as_text())\n        .map(|s| match s {\n            \"remote\" =\u003e SourceType::Remote,\n            _ =\u003e SourceType::Local,\n        })\n        .unwrap_or_default();\n    \n    // ... build SearchHit with these fields\n}\n```\n\n## Dependencies\n- Requires P1.4 (Tantivy schema has provenance fields)\n- Blocks P3.4 (robot output needs these fields)\n\n## Acceptance Criteria\n- [ ] SearchHit includes source_hostname, source_type, sync_timestamp\n- [ ] Fields populated from Tantivy index\n- [ ] Fields default to local/None for legacy data\n- [ ] Serialization works for JSON output","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:03:05.925149-05:00","updated_at":"2025-12-16T03:32:06.931168-05:00","closed_at":"2025-12-16T03:32:06.931168-05:00","close_reason":"Added source_id, origin_kind, origin_host to SearchHit. Populated from Tantivy index. SQLite fallback uses defaults.","dependencies":[{"issue_id":"coding_agent_session_search-alb","depends_on_id":"coding_agent_session_search-pkw","type":"blocks","created_at":"2025-12-16T01:04:22.40918-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-aui","title":"P3.5 Extend TimelineEntry with provenance fields","description":"# P3.5 Extend TimelineEntry with provenance fields\n\n## Overview\nAdd provenance metadata to TimelineEntry struct for timeline display consistency\nwith search results.\n\n## Implementation Details\n\n### TimelineEntry Extension\n```rust\n#[derive(Debug, Clone, Serialize)]\npub struct TimelineEntry {\n    // ... existing fields\n    pub id: String,\n    pub agent: String,\n    pub title: Option\u003cString\u003e,\n    pub started_at: DateTime\u003cUtc\u003e,\n    pub ended_at: Option\u003cDateTime\u003cUtc\u003e\u003e,\n    pub message_count: u32,\n    pub workspace: String,\n    \n    // New provenance fields\n    pub source_hostname: Option\u003cString\u003e,\n    pub source_type: SourceType,\n}\n```\n\n### SQL Query Update\nFetch provenance in timeline query:\n```sql\nSELECT c.id, a.slug as agent, c.title, c.started_at, c.ended_at, \n       c.source_path, COUNT(m.id) as message_count,\n       s.hostname as source_hostname, s.source_type\nFROM conversations c\nJOIN agents a ON c.agent_id = a.id\nLEFT JOIN sources s ON c.source_id = s.id\nLEFT JOIN messages m ON m.conversation_id = c.id\nWHERE ...\n```\n\n### Display Format\nTimeline display should show source indicator:\n```\n2024-01-15 10:30  claude-code  [laptop]  \"Fixed auth bug\" (15 msgs)\n2024-01-15 09:00  cursor       [local]   \"Refactored API\" (8 msgs)\n```\n\n## Dependencies\n- Requires P1.2 (sources table exists)\n- Requires P1.3 (conversations.source_id FK exists)\n\n## Acceptance Criteria\n- [ ] TimelineEntry includes provenance fields\n- [ ] Timeline display shows source indicator\n- [ ] Robot timeline output includes provenance\n- [ ] Consistent with SearchHit provenance format","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:03:18.008939-05:00","updated_at":"2025-12-16T12:50:11.198991-05:00","closed_at":"2025-12-16T12:50:11.198991-05:00","close_reason":"Added origin_kind and origin_host to timeline SQL query and JSON output. Plain text display updated to prefer origin_host in remote session badge.","dependencies":[{"issue_id":"coding_agent_session_search-aui","depends_on_id":"coding_agent_session_search-115","type":"blocks","created_at":"2025-12-16T01:04:32.852622-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-b8b","title":"P3.2 Add --source flag to timeline command","description":"# P3.2 Add --source flag to timeline command\n\n## Overview\nMirror the `--source` filter from search to the timeline command for consistent\nfiltering across all query interfaces.\n\n## Implementation Details\n\n### CLI Argument Definition\nIn `src/cli.rs`, add to TimelineArgs:\n```rust\n#[arg(long, value_name = \"SOURCE\")]\n/// Filter timeline by source (hostname, 'local', 'remote', or 'all')\nsource: Option\u003cString\u003e,\n```\n\n### SQL Query Modification\nThe timeline command uses SQLite directly. Modify the query in `src/lib.rs`:\n```rust\nfn get_timeline(..., source_filter: Option\u003c\u0026SourceFilter\u003e) -\u003e Result\u003c...\u003e {\n    let mut sql = \"SELECT ... FROM conversations c \n                   JOIN sources s ON c.source_id = s.id\n                   WHERE c.started_at \u003e= ?1 AND c.started_at \u003c= ?2\";\n    \n    if let Some(filter) = source_filter {\n        match filter {\n            SourceFilter::Local =\u003e sql.push_str(\" AND s.source_type = 'local'\"),\n            SourceFilter::Remote =\u003e sql.push_str(\" AND s.source_type = 'remote'\"),\n            SourceFilter::Hostname(h) =\u003e {\n                sql.push_str(\u0026format!(\" AND s.hostname = '{}'\", h.replace(\"'\", \"''\")));\n            }\n        }\n    }\n    // ...\n}\n```\n\n## Dependencies\n- Requires P1.3 (conversations table has source_id FK)\n- Requires P3.1 (SourceFilter enum already defined)\n\n## Acceptance Criteria\n- [ ] `--source` flag works identically to search command\n- [ ] Timeline entries show source in output when provenance exists\n- [ ] Filter applies before date range limiting","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:02:59.300653-05:00","updated_at":"2025-12-16T12:18:08.601552-05:00","closed_at":"2025-12-16T12:18:08.601552-05:00","close_reason":"Implemented --source flag for timeline with filtering and source_id in output. 295 tests pass.","dependencies":[{"issue_id":"coding_agent_session_search-b8b","depends_on_id":"coding_agent_session_search-9ur","type":"blocks","created_at":"2025-12-16T01:04:17.167214-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-b8l","title":"P5 Context peek polish","description":"PEEK badge for space-based XL context; optional auto-revert.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:58:30.501088861Z","updated_at":"2025-12-01T22:19:21.658672-05:00","closed_at":"2025-12-01T22:19:21.658672-05:00","dependencies":[{"issue_id":"coding_agent_session_search-b8l","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T13:58:39.899722674Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-b8l.1","title":"B5.1 Peek cue","description":"Show PEEK badge while Space-held XL context; optional auto-revert on move.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:58:35.334763039Z","updated_at":"2025-11-24T14:20:28.995123531Z","closed_at":"2025-11-24T14:20:28.995123531Z"}
{"id":"coding_agent_session_search-bar","title":"TUI theme system: palettes, badges, accents","description":"Introduce named themes (dark/light), agent badges, consistent role colors, and accent styling for results/detail panes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T07:56:28.955554514Z","updated_at":"2025-11-23T14:37:32.757577103Z","closed_at":"2025-11-23T14:37:32.757577103Z","labels":["theme","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-bar","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:56:28.967769773Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-bfk","title":"Phase 2: Plumb Provenance into Indexing Pipeline","description":"# Phase 2: Plumb Provenance into Indexing Pipeline\n\n## Overview\nNow that storage supports provenance, we need to wire it through the indexing pipeline so every conversation gets proper origin metadata.\n\n## Key Changes\n\n### 1. Extend ScanContext\nCurrent ScanContext only has data_root and since_ts. We need:\n- List of scan roots (not just one)\n- Per-root provenance information\n- Platform hints for path mapping\n\n### 2. Indexer Multi-Root Support\nThe indexer should:\n- Build list of scan roots (local defaults + remote mirrors)\n- For each root, track which source it belongs to\n- Inject provenance into normalized conversations\n\n### 3. Connector Changes (Minimal)\nConnectors should NOT need to know about provenance. The indexer:\n- Calls connector.scan() with a scan root\n- Receives NormalizedConversations\n- Injects provenance before persistence\n\n### 4. Deduplication Fix\nCurrent dedup erases origin distinctions. After this phase:\n- Dedup key includes source_id\n- Same content from different sources = distinct results\n\n## Dependencies\n- Phase 1 complete (storage supports provenance)\n\n## Success Criteria\n- [ ] ScanContext supports multiple roots with provenance\n- [ ] Indexer injects provenance for each root\n- [ ] Connectors unchanged (provenance injected externally)\n- [ ] Local source works exactly as before\n- [ ] Dedup respects source boundaries","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-16T00:56:44.348978-05:00","updated_at":"2025-12-16T12:33:46.035565-05:00","closed_at":"2025-12-16T12:33:46.035565-05:00","close_reason":"All Phase 2 sub-tasks complete: P2.1 (ScanContext), P2.2 (indexer multi-root), P2.3 (dedup fix). Provenance now plumbed through indexing pipeline.","dependencies":[{"issue_id":"coding_agent_session_search-bfk","depends_on_id":"coding_agent_session_search-c8e","type":"blocks","created_at":"2025-12-16T00:58:06.672017-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-bgi","title":"Phase 5: Remote Sources Configuration \u0026 Sync Engine","description":"# Phase 5: Remote Sources Configuration \u0026 Sync Engine\n\n## Overview\nThis is the centerpiece of the remote sources feature. It adds:\n1. Configuration system for defining remote sources\n2. Sync engine that pulls sessions from remote machines via SSH/rsync\n3. CLI commands for managing sources (add, list, sync, doctor)\n\n## Goals\n1. `cass sources add ssh://user@host` to register a remote source\n2. `cass sources list` to show configured sources with sync status\n3. `cass sources sync` to pull latest sessions from all remotes\n4. `cass sources doctor` to diagnose connectivity/permission issues\n\n## Technical Approach\n- Config stored in `~/.config/cass/sources.toml` or similar\n- Sync uses rsync over SSH for efficiency (delta transfer)\n- Remote agent session directories are synced to `~/.local/share/cass/remotes/{hostname}/`\n- After sync, normal indexing pipeline picks up the sessions with provenance set\n\n## Config Format Example\n```toml\n[[sources]]\nname = \"laptop\"\ntype = \"ssh\"\nhost = \"user@laptop.local\"\npaths = [\n  \"~/.claude/projects\",\n  \"~/.cursor\",\n]\nsync_schedule = \"manual\"  # or \"hourly\", \"daily\"\n\n[[sources]]\nname = \"workstation\"\ntype = \"ssh\"\nhost = \"user@work.example.com\"\npaths = [\"~/.claude/projects\"]\n```\n\n## Dependencies\n- Requires Phase 2 completion (indexer knows about provenance)\n- Independent of Phases 3-4 (can run in parallel)\n\n## Acceptance Criteria\n- [ ] `cass sources add` validates SSH connectivity before saving\n- [ ] `cass sources sync` uses rsync with progress indication\n- [ ] Partial sync failures don't corrupt existing data\n- [ ] `cass sources doctor` reports common issues with remediation hints\n- [ ] Synced sessions appear in search with correct source attribution","status":"open","priority":1,"issue_type":"epic","created_at":"2025-12-16T01:01:07.26928-05:00","updated_at":"2025-12-16T01:01:07.26928-05:00","dependencies":[{"issue_id":"coding_agent_session_search-bgi","depends_on_id":"coding_agent_session_search-bfk","type":"blocks","created_at":"2025-12-16T01:01:44.148436-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-bhk","title":"TST.10 Integration: CLI contract golden outputs","description":"Add golden JSON fixtures for introspect/capabilities/api-version; assert exact schema/fields, quiet robot stderr, color=never stability. No mocks; capture outputs from binary.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T18:57:12.135528102Z","updated_at":"2025-12-01T21:00:10.754778791Z","closed_at":"2025-12-01T21:00:10.754778791Z","dependencies":[{"issue_id":"coding_agent_session_search-bhk","depends_on_id":"coding_agent_session_search-09h","type":"blocks","created_at":"2025-12-01T18:58:19.152908607Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-bs8","title":"TST.13 CI wiring: coverage + logs","description":"Pipeline steps: fmt, clippy -D warnings, tests, coverage artifact (tarpaulin/llvm-cov), archive trace/logs from integration runs; optional coverage gate; document outputs.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-01T18:57:33.91566747Z","updated_at":"2025-12-01T18:57:33.91566747Z","dependencies":[{"issue_id":"coding_agent_session_search-bs8","depends_on_id":"coding_agent_session_search-0jt","type":"blocks","created_at":"2025-12-01T18:58:36.057813948Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-bs8","depends_on_id":"coding_agent_session_search-nwn","type":"blocks","created_at":"2025-12-01T18:58:43.086901043Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-bu9","title":"Remove unsafe transmute in chips_for_filters","description":"Refactor chips_for_filters to return Vec\u003cSpan\u003c'static\u003e\u003e using owned strings instead of transmute. (ISSUE-001)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-01T18:23:45.29948-05:00","updated_at":"2025-12-01T18:24:41.932409-05:00","closed_at":"2025-12-01T18:24:41.932409-05:00"}
{"id":"coding_agent_session_search-bzn","title":"P10 Help modal overhaul","description":"Rich help modal with grouped shortcuts, scrolling, tests.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T14:00:09.662176881Z","updated_at":"2025-12-01T22:19:11.945083-05:00","closed_at":"2025-12-01T22:19:11.945083-05:00","dependencies":[{"issue_id":"coding_agent_session_search-bzn","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T14:00:50.125636538Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-bzn.1","title":"B10.1 Rich help content","description":"Grouped sections: Navigation, Filters/Scopes, Modes, Actions, History/Suggestions, State. Mirrors footer badges.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T14:00:17.696155879Z","updated_at":"2025-11-24T14:05:39.947046816Z","closed_at":"2025-11-24T14:05:39.947046816Z","comments":[{"id":4,"issue_id":"coding_agent_session_search-bzn.1","author":"ubuntu","text":"Fixed persistence corner case: if user quits while Space-peek active, context window now restores saved size before saving tui_state.json. fmt+clippy clean.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-bzn.2","title":"B10.2 Help scrolling","description":"Allow Up/Down/Pg keys to scroll help without affecting panes; Esc/F1 closes.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T14:00:21.862597568Z","updated_at":"2025-11-24T14:05:39.947752524Z","closed_at":"2025-11-24T14:05:39.947752524Z","dependencies":[{"issue_id":"coding_agent_session_search-bzn.2","depends_on_id":"coding_agent_session_search-bzn.1","type":"blocks","created_at":"2025-11-24T14:00:32.366965538Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-bzn.3","title":"B10.3 Help tests","description":"Snapshot/contains checks for key labels.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T14:00:26.533333325Z","updated_at":"2025-11-24T14:05:39.949897748Z","closed_at":"2025-11-24T14:05:39.949897748Z","dependencies":[{"issue_id":"coding_agent_session_search-bzn.3","depends_on_id":"coding_agent_session_search-bzn.2","type":"blocks","created_at":"2025-11-24T14:00:39.309475761Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-c7b","title":"bd-unit-connectors-complete","description":"Real-fixture connector unit tests (codex, cline, gemini, claude, opencode, amp); add since_ts coverage and logging; depends on bd-tests-foundation","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:03.591128718Z","updated_at":"2025-11-23T20:06:11.173893867Z","closed_at":"2025-11-23T20:06:11.173893867Z","dependencies":[{"issue_id":"coding_agent_session_search-c7b","depends_on_id":"coding_agent_session_search-vbf","type":"blocks","created_at":"2025-11-23T17:35:03.59265424Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-c8e","title":"P1.5 Implement safe schema migration strategy","description":"# P1.5 Implement safe schema migration strategy\n\n## Overview\nImplement a safe, user-friendly schema migration strategy that treats the\nsearch DB as a rebuildable cache while preserving user-authored state.\n\n## Key Principles (from document)\n\n1. **Never break startup/search** due to schema drift\n2. **Automatic rebuild** of derived artifacts when schema is incompatible\n3. **Preserve user-authored state** in separate locations\n\n## What IS Rebuildable (can be deleted and rebuilt from agent logs)\n- `agent_search.db` (normalized conversations, messages, sources)\n- Tantivy index directory\n\n## What is NOT Rebuildable (must be preserved)\n- `bookmarks.db` (separate file, managed by src/bookmarks.rs)\n- `tui_state.json` (UI preferences, saved views)\n- Source configuration (`sources.toml`)\n\n## Implementation Details\n\n### Schema Version Tracking\n```rust\n// In src/storage/sqlite.rs\npub const SCHEMA_VERSION: u32 = 2;  // Bump for provenance schema\n\npub fn migrate(conn: \u0026Connection) -\u003e Result\u003c(), MigrationError\u003e {\n    let current_version = get_schema_version(conn)?;\n    \n    if current_version == SCHEMA_VERSION {\n        return Ok(());  // Already up to date\n    }\n    \n    if current_version \u003e SCHEMA_VERSION {\n        // Future version - user downgraded?\n        return trigger_rebuild(\"Schema version from future, need rebuild\");\n    }\n    \n    // Try incremental migration if possible\n    if can_migrate_incrementally(current_version, SCHEMA_VERSION) {\n        return run_incremental_migration(conn, current_version);\n    }\n    \n    // Otherwise, trigger full rebuild\n    trigger_rebuild(\"Schema incompatible, rebuilding from logs\")\n}\n```\n\n### Safe Rebuild Trigger\n```rust\nfn trigger_rebuild(reason: \u0026str) -\u003e Result\u003c(), MigrationError\u003e {\n    let db_path = get_db_path()?;\n    let backup_path = db_path.with_extension(\n        format!(\"db.backup.{}\", chrono::Utc::now().timestamp())\n    );\n    \n    // Move existing DB out of the way\n    if db_path.exists() {\n        std::fs::rename(\u0026db_path, \u0026backup_path)?;\n        eprintln!(\"Backed up existing database to {:?}\", backup_path);\n    }\n    \n    // Signal to caller that full reindex is needed\n    Err(MigrationError::RebuildRequired { reason: reason.into() })\n}\n```\n\n### Backup Retention\n```rust\nfn cleanup_old_backups(data_dir: \u0026Path, keep_count: usize) {\n    let pattern = data_dir.join(\"agent_search.db.backup.*\");\n    let mut backups: Vec\u003c_\u003e = glob(\u0026pattern.to_string_lossy())\n        .unwrap()\n        .filter_map(Result::ok)\n        .collect();\n    \n    // Sort by modification time, oldest first\n    backups.sort_by_key(|p| std::fs::metadata(p).and_then(|m| m.modified()).ok());\n    \n    // Delete oldest, keeping keep_count\n    while backups.len() \u003e keep_count {\n        if let Some(old) = backups.remove(0) {\n            let _ = std::fs::remove_file(\u0026old);\n        }\n    }\n}\n```\n\n### DO NOT TOUCH\nExplicitly ensure these are never deleted:\n```rust\nfn is_user_data_file(path: \u0026Path) -\u003e bool {\n    let name = path.file_name().and_then(|n| n.to_str()).unwrap_or(\"\");\n    matches!(name, \n        \"bookmarks.db\" | \n        \"tui_state.json\" | \n        \"sources.toml\" |\n        \".env\"  // dev config\n    )\n}\n```\n\n## User Experience\n\nOn first launch after upgrade:\n```\nCASS needs to rebuild its search index (schema updated).\nThis may take a few minutes for large session histories.\n\nBacking up old database... done\nBuilding new database... [=====\u003e    ] 47%\n```\n\n## Dependencies\n- Requires P1.3 (conversations schema known)\n- Blocks Phase 2 (indexer needs migration to run first)\n\n## Acceptance Criteria\n- [ ] Old schema triggers automatic rebuild\n- [ ] Backup created before rebuild\n- [ ] Backup retention policy (keep 1-3)\n- [ ] bookmarks.db NEVER deleted\n- [ ] tui_state.json NEVER deleted\n- [ ] User sees clear progress during rebuild\n- [ ] Rebuild completes successfully","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:55:44.899737-05:00","updated_at":"2025-12-16T03:18:39.486729-05:00","closed_at":"2025-12-16T03:18:39.486729-05:00","close_reason":"Implemented safe schema migration strategy: MigrationError enum, create_backup/cleanup_old_backups, is_user_data_file protection, open_or_rebuild() wrapper. All 382 tests passing.","dependencies":[{"issue_id":"coding_agent_session_search-c8e","depends_on_id":"coding_agent_session_search-d4b","type":"blocks","created_at":"2025-12-16T00:56:24.288024-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-cre","title":"CLI \u0026 Robot Mode Enhancements Epic","description":"Deliver AI-agent-first cass CLI: automation defaults, robot-help, robot-docs, JSON/exit-code contracts, trace, human-friendly output modes.","design":"Phase 1: Robot output polish (cre.2). Phase 2: Boolean queries (cre.4). Phase 3: Human CLI formats (cre.3). Phase 4: Diagnostics (cre.9).","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-29T06:54:52.170690079Z","updated_at":"2025-11-30T05:23:57.213901721Z","closed_at":"2025-11-30T05:23:57.213901721Z"}
{"id":"coding_agent_session_search-cre.2","title":"cre.2: Enhanced Robot Mode Output","description":"Add --robot-format (json/jsonl/compact) and --robot-meta for extended metadata. Critical for AI agent consumption.","design":"Add RobotFormat enum. JSONL streams one object per line with _meta header. --robot-meta adds elapsed_ms and wildcard_fallback to output. Backward compatible.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-29T06:55:17.482392538Z","updated_at":"2025-11-29T19:47:42.951901842Z","closed_at":"2025-11-29T19:47:42.951901842Z","dependencies":[{"issue_id":"coding_agent_session_search-cre.2","depends_on_id":"coding_agent_session_search-cre","type":"parent-child","created_at":"2025-11-29T06:55:34.959116559Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-cre.3","title":"cre.3: Human-Readable CLI Output Modes","description":"Add --display (table/lines/markdown) for human-friendly CLI output without TUI.","design":"DisplayFormat enum. Table: aligned columns with headers. Lines: one-liner per result. Markdown: role headers and code blocks.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-29T06:55:19.313269683Z","updated_at":"2025-11-29T23:51:04.309028427Z","closed_at":"2025-11-29T23:51:04.309028427Z","dependencies":[{"issue_id":"coding_agent_session_search-cre.3","depends_on_id":"coding_agent_session_search-cre","type":"parent-child","created_at":"2025-11-29T06:55:35.336367488Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-cre.4","title":"cre.4: Boolean Query Operators","description":"Implement AND/OR/NOT operators and phrase matching for search queries. High value for power users and AI agents.","design":"Create parser using recursive descent. Grammar: query=or_expr, or_expr=and_expr(OR and_expr)*, and_expr=unary(AND? unary)*, unary=NOT? primary, primary=TERM|PHRASE|WILDCARD|grouped. Output Tantivy BooleanQuery.","status":"closed","priority":0,"issue_type":"epic","created_at":"2025-11-29T06:55:15.418719985Z","updated_at":"2025-11-29T23:51:09.196221219Z","closed_at":"2025-11-29T23:51:09.196221219Z","dependencies":[{"issue_id":"coding_agent_session_search-cre.4","depends_on_id":"coding_agent_session_search-cre","type":"parent-child","created_at":"2025-11-29T06:55:34.68930562Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-cre.9","title":"cre.9: Diagnostic Mode","description":"Add 'cass diagnose' command for health checks, disk usage, and issue detection with fix suggestions.","design":"Check: index openable, SQLite openable, schema version match, connector roots accessible. Report disk usage. Output fix suggestions.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:55:21.09433137Z","updated_at":"2025-11-29T23:51:23.45744481Z","closed_at":"2025-11-29T23:51:23.45744481Z","dependencies":[{"issue_id":"coding_agent_session_search-cre.9","depends_on_id":"coding_agent_session_search-cre","type":"parent-child","created_at":"2025-11-29T06:55:35.575681935Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-d0m","title":"Help \u0026 onboarding overlay","description":"Improve '?' overlay with grouped hotkeys, first-run tip banner, and mouse hints; keep footer minimal.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-23T07:56:47.046872362Z","updated_at":"2025-11-23T14:38:16.706038049Z","closed_at":"2025-11-23T14:38:16.706038049Z","labels":["help","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-d0m","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:56:47.053670934Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-d4b","title":"P1.3 Add provenance columns to conversations table","description":"# Add Provenance Columns to conversations Table\n\n## Context\nEach conversation needs to know where it came from. This is the critical change that enables multi-source support and fixes identity collisions.\n\n## Location\nsrc/storage/sqlite.rs\n\n## Schema Changes\n\n### New Columns\n\\`\\`\\`sql\nALTER TABLE conversations ADD COLUMN source_id TEXT NOT NULL DEFAULT 'local' REFERENCES sources(id);\nALTER TABLE conversations ADD COLUMN origin_host TEXT;\n\\`\\`\\`\n\n### Updated Uniqueness (CRITICAL)\nCurrent: UNIQUE(agent_id, external_id)\nNew: UNIQUE(source_id, agent_id, external_id)\n\nThis prevents identity collisions when the same agent produces the same external_id on different machines.\n\n## Migration Complexity\nSQLite cannot ALTER UNIQUE constraints in place. Migration requires:\n\n1. Create new table with correct schema\n2. Copy data from old table (all existing conversations get source_id='local')\n3. Drop old table\n4. Rename new table\n5. Recreate indexes and foreign keys\n\n### Migration SQL\n\\`\\`\\`sql\n-- Create new table\nCREATE TABLE conversations_new (\n    id INTEGER PRIMARY KEY,\n    agent_id INTEGER NOT NULL REFERENCES agents(id),\n    workspace_id INTEGER REFERENCES workspaces(id),\n    source_id TEXT NOT NULL DEFAULT 'local' REFERENCES sources(id),\n    external_id TEXT,\n    title TEXT,\n    source_path TEXT NOT NULL,\n    started_at INTEGER,\n    ended_at INTEGER,\n    approx_tokens INTEGER,\n    metadata_json TEXT,\n    origin_host TEXT,\n    UNIQUE(source_id, agent_id, external_id)\n);\n\n-- Copy data\nINSERT INTO conversations_new \nSELECT id, agent_id, workspace_id, 'local', external_id, title, source_path,\n       started_at, ended_at, approx_tokens, metadata_json, NULL\nFROM conversations;\n\n-- Swap tables\nDROP TABLE conversations;\nALTER TABLE conversations_new RENAME TO conversations;\n\n-- Recreate indexes\nCREATE INDEX IF NOT EXISTS idx_conv_agent_started ON conversations(agent_id, started_at);\n\\`\\`\\`\n\n## Alternative: Backup \u0026 Rebuild Strategy\nGiven that conversations is a rebuildable cache (we can always rescan agent logs), consider:\n1. Detect incompatible schema\n2. Backup old DB to agent_search.db.bak-{timestamp}\n3. Create fresh DB with new schema\n4. Trigger full reindex on next run\n\nThis is simpler and safer for users, though slower (requires full rescan).\n\n## Recommendation\nImplement BOTH:\n- Try table-rewrite migration first\n- If migration fails, fall back to backup+rebuild\n- Log clearly what happened\n\n## API Updates\nUpdate persist_conversation() to accept source_id and origin_host parameters.\n\n## Dependencies\n- P1.2 (sources table must exist for FK)\n\n## Acceptance Criteria\n- [ ] source_id column added (defaults to 'local')\n- [ ] origin_host column added\n- [ ] Uniqueness constraint updated\n- [ ] Migration tested with existing data\n- [ ] Backup+rebuild fallback works\n- [ ] persist_conversation updated\n- [ ] Tests verify no collisions across sources","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:54:53.788672-05:00","updated_at":"2025-12-16T02:07:59.248659-05:00","closed_at":"2025-12-16T02:07:59.248659-05:00","close_reason":"Added source_id and origin_host columns to conversations table. Updated unique constraint to (source_id, agent_id, external_id). MIGRATION_V5 handles table rewrite for SQLite. All CRUD operations updated to use provenance columns. All tests pass.","dependencies":[{"issue_id":"coding_agent_session_search-d4b","depends_on_id":"coding_agent_session_search-115","type":"blocks","created_at":"2025-12-16T00:56:13.829013-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-d5a","title":"Wildcard query performance validation","description":"Benchmark and validate wildcard query latency, especially suffix/substring patterns that use RegexQuery. Ensure sub-80ms target maintained.","design":"Benchmark: foo* (prefix via edge-ngram), *foo (suffix via RegexQuery), *foo* (substring via RegexQuery). Target: \u003c80ms for typical queries. If slow, consider trigram index for suffix matching.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-29T06:56:23.688669143Z","updated_at":"2025-11-29T19:50:01.134766233Z","closed_at":"2025-11-29T19:50:01.134766233Z","labels":["performance","search"]}
{"id":"coding_agent_session_search-d6o","title":"P5.5 cass sources sync command","description":"# P5.5 cass sources sync command\n\n## Overview\nImplement the `cass sources sync` command that triggers synchronization\nfrom configured remote sources and persists sync status.\n\n## Implementation Details\n\n### CLI Definition\n```rust\n#[derive(Parser)]\npub enum SourcesCommand {\n    /// Synchronize sessions from remote sources\n    Sync {\n        /// Sync only specific source(s)\n        #[arg(long, short)]\n        source: Option\u003cVec\u003cString\u003e\u003e,\n        \n        /// Don't re-index after sync\n        #[arg(long)]\n        no_index: bool,\n        \n        /// Show detailed transfer information\n        #[arg(long, short)]\n        verbose: bool,\n        \n        /// Dry run - show what would be synced\n        #[arg(long)]\n        dry_run: bool,\n    },\n}\n```\n\n### Command Implementation\n```rust\nasync fn cmd_sources_sync(args: \u0026SyncArgs) -\u003e Result\u003c(), CliError\u003e {\n    let config = SourcesConfig::load()?;\n    let engine = SyncEngine::new(config.clone());\n    let mut status = SyncStatus::load()?;  // Load persisted sync status\n    \n    let sources_to_sync: Vec\u003c_\u003e = if let Some(names) = \u0026args.source {\n        config.sources.iter()\n            .filter(|s| names.contains(\u0026s.name))\n            .collect()\n    } else {\n        config.sources.iter().collect()\n    };\n    \n    if sources_to_sync.is_empty() {\n        println!(\"No sources configured. Run 'cass sources add' first.\");\n        return Ok(());\n    }\n    \n    let mut total_sessions = 0;\n    for source in sources_to_sync {\n        println!(\"Syncing {}...\", source.name);\n        \n        let report = if args.dry_run {\n            engine.dry_run_sync(source).await?\n        } else {\n            engine.sync_source(source).await?\n        };\n        \n        // Update sync status (critical for P5.3 list display)\n        if !args.dry_run {\n            status.update(\u0026source.name, \u0026report);\n        }\n        \n        print_sync_report(\u0026report, args.verbose);\n        total_sessions += report.sessions_found();\n    }\n    \n    // Persist sync status\n    if !args.dry_run {\n        status.save()?;\n    }\n    \n    // Trigger re-index\n    if !args.no_index \u0026\u0026 !args.dry_run {\n        println!(\"\\nRe-indexing {} synced sessions...\", total_sessions);\n        reindex_remotes().await?;\n    }\n    \n    Ok(())\n}\n```\n\n### Sync Status Persistence\n```rust\nimpl SyncStatus {\n    pub fn load() -\u003e Result\u003cSelf, io::Error\u003e {\n        let path = Self::status_path()?;\n        if path.exists() {\n            let content = std::fs::read_to_string(\u0026path)?;\n            Ok(serde_json::from_str(\u0026content).unwrap_or_default())\n        } else {\n            Ok(Self::default())\n        }\n    }\n    \n    pub fn save(\u0026self) -\u003e Result\u003c(), io::Error\u003e {\n        let path = Self::status_path()?;\n        let content = serde_json::to_string_pretty(self)?;\n        std::fs::write(\u0026path, content)\n    }\n    \n    pub fn update(\u0026mut self, source_id: \u0026str, report: \u0026SyncReport) {\n        self.sources.insert(source_id.to_string(), SourceSyncInfo {\n            last_sync: Some(Utc::now()),\n            last_result: if report.has_errors() {\n                SyncResult::PartialFailure(report.error_summary())\n            } else {\n                SyncResult::Success\n            },\n            sessions_synced: report.sessions_found(),\n        });\n    }\n    \n    fn status_path() -\u003e Result\u003cPathBuf, io::Error\u003e {\n        Ok(dirs::data_local_dir()\n            .ok_or_else(|| io::Error::new(io::ErrorKind::NotFound, \"No data dir\"))?\n            .join(\"cass/sync_status.json\"))\n    }\n}\n```\n\n### Output Format\n```\nSyncing laptop...\n  ~/.claude/projects: 12 files updated (2.3 MB)\n  ~/.cursor/projects: 0 files updated (up to date)\n  Total: 47 sessions found\n  \nSyncing workstation...\n  ~/.claude/projects: 3 files updated (156 KB)\n  Total: 23 sessions found\n\nRe-indexing 70 synced sessions...\nDone. Run 'cass search --source=remote' to search remote sessions.\n```\n\n### Integration with Indexer\n```rust\nasync fn reindex_remotes() -\u003e Result\u003c(), IndexError\u003e {\n    let remote_store = dirs::data_local_dir()?.join(\"cass/remotes\");\n    \n    let mut scanner = SessionScanner::new();\n    for entry in std::fs::read_dir(\u0026remote_store)? {\n        let entry = entry?;\n        if entry.file_type()?.is_dir() {\n            let source_name = entry.file_name().to_string_lossy().to_string();\n            scanner.add_root_with_provenance(\n                entry.path(),\n                SourceType::Remote,\n                Some(source_name),\n            );\n        }\n    }\n    \n    scanner.scan_and_index().await\n}\n```\n\n## Dependencies\n- Requires P5.4 (sync engine)\n- Requires P2.2 (indexer supports multiple roots)\n\n## Acceptance Criteria\n- [ ] `cass sources sync` syncs all configured sources\n- [ ] `cass sources sync --source=laptop` syncs specific source\n- [ ] Progress and stats shown during sync\n- [ ] `--dry-run` shows what would happen\n- [ ] Auto-reindex after sync (unless --no-index)\n- [ ] Sync status persisted to sync_status.json\n- [ ] Status includes timestamp, result, session count","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:07:50.630668-05:00","updated_at":"2025-12-16T01:30:06.384532-05:00","dependencies":[{"issue_id":"coding_agent_session_search-d6o","depends_on_id":"coding_agent_session_search-yb4","type":"blocks","created_at":"2025-12-16T01:09:08.050145-05:00","created_by":"jemanuel"},{"issue_id":"coding_agent_session_search-d6o","depends_on_id":"coding_agent_session_search-1mv","type":"blocks","created_at":"2025-12-16T01:09:13.292023-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-den","title":"P4.3 Source filter in TUI sidebar/header","description":"# P4.3 Source filter in TUI sidebar/header\n\n## Overview\nAdd interactive source filtering in the TUI, including filter chips display\nand saved views persistence.\n\n## Implementation Details\n\n### Filter State\nAdd to TUI app state:\n```rust\npub struct AppState {\n    // ... existing\n    pub source_filter: SourceFilter,\n    pub available_sources: Vec\u003cString\u003e,  // Populated from index\n}\n\npub enum SourceFilter {\n    All,\n    Local,\n    Remote,\n    Hostname(String),\n}\n```\n\n### Filter Chips Display\nUpdate `chips_for_filters` in `src/ui/tui.rs`:\n```rust\nfn chips_for_filters(filters: \u0026SearchFilters) -\u003e Vec\u003cChip\u003e {\n    let mut chips = Vec::new();\n    \n    // ... existing agent/workspace chips\n    \n    // Source filter chip\n    if filters.source_filter != SourceFilter::All {\n        let label = match \u0026filters.source_filter {\n            SourceFilter::Local =\u003e \"local\".into(),\n            SourceFilter::Remote =\u003e \"remote\".into(),\n            SourceFilter::Hostname(h) =\u003e format!(\"src:{}\", h),\n            SourceFilter::All =\u003e unreachable!(),\n        };\n        chips.push(Chip::new(\"Source\", label, ChipStyle::Source));\n    }\n    \n    chips\n}\n```\n\n### Saved Views Persistence\nUpdate saved view struct to include source filter:\n```rust\n#[derive(Serialize, Deserialize)]\npub struct SavedView {\n    pub name: String,\n    pub query: String,\n    pub agents: Vec\u003cString\u003e,\n    pub workspaces: Vec\u003cString\u003e,\n    // NEW: source filter\n    pub source_filter: Option\u003cSourceFilter\u003e,\n    pub created_at: i64,\n}\n```\n\nEnsure `tui_state.json` schema is backward-compatible (source_filter is Option).\n\n### UI Placement: Header Bar\n```\n┌─ CASS Search ──────────── Source: [All ▼] ─┐\n│ Query: auth bug                            │\n│ [claude-code] [/projects/myapp] [remote]  │ ← chips row\n```\n\n### Filter Popup/Menu\nWhen F11 pressed with Shift, show popup:\n```\n┌─ Filter by Source ─────┐\n│ ● All                  │\n│ ○ Local only           │\n│ ○ Remote only          │\n│ ─────────────────      │\n│ ○ work-laptop          │\n│ ○ home-server          │\n└────────────────────────┘\n```\n\n### Discover Available Sources\n```rust\nfn discover_sources(\u0026self) -\u003e Vec\u003cString\u003e {\n    let sql = \"SELECT DISTINCT id FROM sources WHERE id != 'local' ORDER BY id\";\n    // ...\n}\n```\n\n## Dependencies\n- Requires P3.1 (search accepts source filter)\n- Requires P4.1 and P4.2 (visual distinction ready)\n\n## Acceptance Criteria\n- [ ] Filter UI visible in TUI header\n- [ ] Filter chips show current source filter\n- [ ] F11 cycles through filters (see P4.4)\n- [ ] Shift+F11 opens filter menu\n- [ ] Saved views persist source filter\n- [ ] Results update immediately on filter change\n- [ ] Current filter clearly indicated","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:04:53.716857-05:00","updated_at":"2025-12-16T01:27:13.058715-05:00","dependencies":[{"issue_id":"coding_agent_session_search-den","depends_on_id":"coding_agent_session_search-9ur","type":"blocks","created_at":"2025-12-16T01:07:07.222382-05:00","created_by":"jemanuel"},{"issue_id":"coding_agent_session_search-den","depends_on_id":"coding_agent_session_search-nrm","type":"blocks","created_at":"2025-12-16T01:07:12.476558-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-dft","title":"P8 Zero-results UX","description":"Did-you-mean suggestions; fall back to recent panes when query empty.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:59:20.964324181Z","updated_at":"2025-12-01T22:16:42.953016-05:00","closed_at":"2025-12-01T22:16:42.953016-05:00","dependencies":[{"issue_id":"coding_agent_session_search-dft","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T13:59:38.019831704Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-dft.1","title":"B8.1 Did-you-mean suggestions","description":"On zero hits, propose adjusted queries/agents; keys 1/2/3 apply.","notes":"BlueCastle: Starting did-you-mean suggestions for zero-hit queries","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:59:24.344351614Z","updated_at":"2025-12-01T19:27:24.583265328Z","closed_at":"2025-12-01T19:27:24.583265328Z"}
{"id":"coding_agent_session_search-dft.2","title":"B8.2 Recent fallback","description":"Ensure zero-match reverts to recent-per-agent panes automatically.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:59:29.004663406Z","updated_at":"2025-12-01T21:28:55.287099-05:00","closed_at":"2025-12-01T21:28:55.287099-05:00","dependencies":[{"issue_id":"coding_agent_session_search-dft.2","depends_on_id":"coding_agent_session_search-dft.1","type":"blocks","created_at":"2025-11-24T13:59:34.035390812Z","created_by":"daemon"}],"comments":[{"id":20,"issue_id":"coding_agent_session_search-dft.2","author":"jemanuel","text":"Starting work: Implementing recent fallback when search returns zero results","created_at":"2025-12-02T02:27:25Z"}]}
{"id":"coding_agent_session_search-dja","title":"bd-unit-indexer","description":"Indexer tests: full flag truncation, append-only add_messages, since_ts routing, watch_state persistence","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:15.292003877Z","updated_at":"2025-11-23T20:06:00.120948243Z","closed_at":"2025-11-23T20:06:00.120948243Z","dependencies":[{"issue_id":"coding_agent_session_search-dja","depends_on_id":"coding_agent_session_search-lxx","type":"blocks","created_at":"2025-11-23T17:35:15.293389883Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-e0h","title":"TUI help \u0026 onboarding overlay","description":"Add rich help overlay with grouped hotkeys, first-run tip banner, and mouse hints; keep footer legend minimal.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-23T07:51:29.022786251Z","updated_at":"2025-11-23T07:55:51.432897188Z","closed_at":"2025-11-23T07:55:51.432897188Z","labels":["help","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-e0h","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:51:29.031591267Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-e60","title":"Fix compilation error in lib.rs","description":"Fix argument count mismatch in output_robot_results call.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-01T19:38:51.360878-05:00","updated_at":"2025-12-01T21:27:55.288988-05:00","closed_at":"2025-12-01T21:27:55.288988-05:00","comments":[{"id":19,"issue_id":"coding_agent_session_search-e60","author":"jemanuel","text":"Starting work: Fixing compilation errors in lib.rs","created_at":"2025-12-02T02:21:26Z"}]}
{"id":"coding_agent_session_search-ege","title":"LLM-first CLI mode","description":"Deliver AI-agent-first cass CLI: automation defaults, robot-help, robot-docs, JSON/exit-code contracts, trace, wrap/color controls, TUI bypass.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-26T00:01:22.259234338Z","updated_at":"2025-12-01T23:59:21.487344-05:00","closed_at":"2025-12-01T23:59:21.487344-05:00"}
{"id":"coding_agent_session_search-ege.1","title":"LLM-CLI spec \u0026 contracts","description":"Write final machine-first CLI spec: flag set, exit codes, JSON error schema, wrap/color/progress defaults, TUI bypass rules, determinism contracts.","notes":"Spec captured in PLAN_TO_MAKE_CODING_AGENT_SESSION_SEARCH.md (LLM-first CLI spec section).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:01:29.230488553Z","updated_at":"2025-11-26T00:08:16.180077886Z","closed_at":"2025-11-26T00:08:16.180077886Z"}
{"id":"coding_agent_session_search-ege.10","title":"CLI contract tests \u0026 snapshots","description":"Add snapshot tests for --robot-help and robot-docs topics; contract tests for exit codes, JSON validity, color suppression, wrap flags, TUI bypass, trace; integrate into CI.","notes":"Part of rob epic (Agent-First CLI). Original: CLI contract tests \u0026 snapshots for robot-help/robot-docs.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-11-26T00:03:38.25456798Z","updated_at":"2025-12-01T23:58:58.589724-05:00","dependencies":[{"issue_id":"coding_agent_session_search-ege.10","depends_on_id":"coding_agent_session_search-ege.5","type":"blocks","created_at":"2025-11-26T00:03:46.138499653Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.10","depends_on_id":"coding_agent_session_search-ege.6","type":"blocks","created_at":"2025-11-26T00:03:51.336778928Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.10","depends_on_id":"coding_agent_session_search-ege.7","type":"blocks","created_at":"2025-11-26T00:03:54.962688252Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.10","depends_on_id":"coding_agent_session_search-ege.8","type":"blocks","created_at":"2025-11-26T00:04:00.122844955Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.10","depends_on_id":"coding_agent_session_search-ege.9","type":"blocks","created_at":"2025-11-26T00:04:03.516062054Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.10","depends_on_id":"coding_agent_session_search-ege.4","type":"blocks","created_at":"2025-11-26T00:04:06.793990251Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.11","title":"Docs/README AI automation","description":"Update README with AI-automation section: wide examples, wrap guidance, trace usage, automation defaults; embed contracts and no-legacy stance.","notes":"README adds AI automation section and robot-help/robot-docs references.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:04:13.239248667Z","updated_at":"2025-11-26T00:34:21.449684953Z","closed_at":"2025-11-26T00:34:21.449695453Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.11","depends_on_id":"coding_agent_session_search-ege.5","type":"blocks","created_at":"2025-11-26T00:04:26.682807162Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.11","depends_on_id":"coding_agent_session_search-ege.6","type":"blocks","created_at":"2025-11-26T00:04:31.56126606Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.11","depends_on_id":"coding_agent_session_search-ege.7","type":"blocks","created_at":"2025-11-26T00:04:41.206857325Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.11","depends_on_id":"coding_agent_session_search-ege.8","type":"blocks","created_at":"2025-11-26T00:04:47.997252223Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.11","depends_on_id":"coding_agent_session_search-ege.9","type":"blocks","created_at":"2025-11-26T00:04:53.42263834Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.11","depends_on_id":"coding_agent_session_search-ege.10","type":"blocks","created_at":"2025-11-26T00:05:00.815344351Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.12","title":"Performance sanity (robot flows)","description":"Measure startup/CPU impact of robot-help/doc/trace paths; optimize string building or caching if needed.","notes":"Part of rob epic (Agent-First CLI). Measure startup/CPU impact of robot-help/doc/trace paths.","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-26T00:05:07.802157639Z","updated_at":"2025-12-01T23:59:03.730191-05:00","dependencies":[{"issue_id":"coding_agent_session_search-ege.12","depends_on_id":"coding_agent_session_search-ege.4","type":"blocks","created_at":"2025-11-26T00:05:12.459580813Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.12","depends_on_id":"coding_agent_session_search-ege.5","type":"blocks","created_at":"2025-11-26T00:05:16.759635142Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.12","depends_on_id":"coding_agent_session_search-ege.8","type":"blocks","created_at":"2025-11-26T00:05:25.150994969Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.13","title":"Version/changelog for robot CLI","description":"Bump crate version; add changelog entry; ensure --robot-help header carries contract version and crate version; announce internally.","notes":"Bumped version to 0.1.22; robot-help header contract v1 aligns with crate version.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-26T00:05:29.570737571Z","updated_at":"2025-11-26T00:34:29.683671192Z","closed_at":"2025-11-26T00:34:29.683671192Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.13","depends_on_id":"coding_agent_session_search-ege.11","type":"blocks","created_at":"2025-11-26T00:05:37.201301915Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.13","depends_on_id":"coding_agent_session_search-ege.10","type":"blocks","created_at":"2025-11-26T00:05:41.755110177Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.13","depends_on_id":"coding_agent_session_search-ege.12","type":"blocks","created_at":"2025-11-26T00:05:46.433998218Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.2","title":"CLI plumbing for robot flags","description":"Add global --robot-help and robot-docs subcommand; ensure Arg parsing bypasses TUI when automation flags present.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:01:35.724421773Z","updated_at":"2025-11-29T23:51:27.199740558Z","closed_at":"2025-11-29T23:51:27.199740558Z"}
{"id":"coding_agent_session_search-ege.3","title":"CLI plumbing for robot flags","description":"Add global --robot-help and robot-docs subcommand; wire argument parsing to bypass TUI when automation flags present.","notes":"CLI plumbing: global robot_help flag, robot-docs subcommand, automation flags integrated into Clap; TUI bypass guard wired.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:01:49.023763411Z","updated_at":"2025-11-26T00:22:50.845213809Z","closed_at":"2025-11-26T00:22:50.845224009Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.3","depends_on_id":"coding_agent_session_search-ege.1","type":"blocks","created_at":"2025-11-26T00:01:53.036895995Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.4","title":"Robot-help generator","description":"Implement deterministic machine-first --robot-help output with version header, sections (Summary, Commands, Defaults, Exit codes, JSON/Error schema, Examples, Env, Paths, Trace), no ANSI unless forced.","notes":"Implemented deterministic robot-help output (contract v1) with sections for summary, flags, exit codes, schemas, examples.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:01:57.460558431Z","updated_at":"2025-11-26T00:22:56.321182359Z","closed_at":"2025-11-26T00:22:56.321182359Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.4","depends_on_id":"coding_agent_session_search-ege.3","type":"blocks","created_at":"2025-11-26T00:02:03.23287893Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.4","depends_on_id":"coding_agent_session_search-ege.1","type":"blocks","created_at":"2025-11-26T00:02:06.177871304Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.5","title":"Robot-docs topics","description":"Implement robot-docs dispatcher for topics: commands, env, paths, schemas, exit-codes, examples, contracts, wrap; ensure concise parse-stable blocks and tests.","notes":"robot-docs topics commands/env/paths/schemas/exit-codes/examples/contracts/wrap implemented with parse-stable blocks.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:02:11.637954704Z","updated_at":"2025-11-26T00:23:01.061785046Z","closed_at":"2025-11-26T00:23:01.061795046Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.5","depends_on_id":"coding_agent_session_search-ege.4","type":"blocks","created_at":"2025-11-26T00:02:18.915701343Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.5","depends_on_id":"coding_agent_session_search-ege.3","type":"blocks","created_at":"2025-11-26T00:02:23.643525661Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.5","depends_on_id":"coding_agent_session_search-ege.1","type":"blocks","created_at":"2025-11-26T00:02:30.791692091Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.6","title":"JSON + exit-code enforcement","description":"Unify error handling with machine schema (code/kind/message/hint/retryable); map command error paths to standardized exit codes; ensure search/index honor --json.","notes":"CLI errors now map to contract codes and JSON schema for search/index/open/trace; main emits structured error payloads.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:02:37.19351413Z","updated_at":"2025-11-26T00:34:14.082127445Z","closed_at":"2025-11-26T00:34:14.082129245Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.6","depends_on_id":"coding_agent_session_search-ege.1","type":"blocks","created_at":"2025-11-26T00:02:45.599829252Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.6","depends_on_id":"coding_agent_session_search-ege.3","type":"blocks","created_at":"2025-11-26T00:02:50.499319458Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.7","title":"Color/progress/wrap controls","description":"Add --color=auto|never|always, --progress=plain|bars|none, --wrap/--nowrap; plumb into search/index outputs; defaults favor automation (bars only on TTY, no wrapping).","notes":"Added --color, --progress, --wrap/--nowrap flags; defaults automation-friendly (auto color, bars on tty else plain); wired into search/index/help/docs render.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:02:55.746678077Z","updated_at":"2025-11-26T00:23:14.379840828Z","closed_at":"2025-11-26T00:23:14.379842928Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.7","depends_on_id":"coding_agent_session_search-ege.1","type":"blocks","created_at":"2025-11-26T00:03:01.155197687Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.7","depends_on_id":"coding_agent_session_search-ege.3","type":"blocks","created_at":"2025-11-26T00:03:05.502893791Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.8","title":"Trace mode","description":"Implement --trace-file JSONL spans (start/end/duration, cmd, args, exit_code, error); minimal overhead; never writes to stdout/stderr.","notes":"Trace mode via --trace-file writes JSONL spans (start/end/duration/cmd/args/exit/error, contract+crate version).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:03:10.176234163Z","updated_at":"2025-11-26T00:23:26.149860151Z","closed_at":"2025-11-26T00:23:26.149860151Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.8","depends_on_id":"coding_agent_session_search-ege.1","type":"blocks","created_at":"2025-11-26T00:03:17.050688003Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.8","depends_on_id":"coding_agent_session_search-ege.3","type":"blocks","created_at":"2025-11-26T00:03:20.652210174Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-ege.9","title":"TUI bypass guard","description":"Guarantee automation flags or non-TTY use never launch TUI; if no subcommand on non-TTY, print guidance and exit 2; keep explicit tui subcommand required.","notes":"Non-TTY default now errors instead of launching TUI; automation flags bypass TUI.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T00:03:24.708079563Z","updated_at":"2025-11-26T00:23:32.61273248Z","closed_at":"2025-11-26T00:23:32.61273698Z","dependencies":[{"issue_id":"coding_agent_session_search-ege.9","depends_on_id":"coding_agent_session_search-ege.1","type":"blocks","created_at":"2025-11-26T00:03:29.80642093Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-ege.9","depends_on_id":"coding_agent_session_search-ege.3","type":"blocks","created_at":"2025-11-26T00:03:33.22902054Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-epe","title":"P7.1 Unit tests for provenance types","description":"# P7.1 Unit tests for provenance types\n\n## Overview\nComprehensive unit tests for the provenance data types introduced in Phase 1.\n\n## Test Cases\n\n### Source/SourceType Tests\n```rust\n#[cfg(test)]\nmod tests {\n    use super::*;\n    \n    #[test]\n    fn test_source_type_serialization() {\n        assert_eq!(serde_json::to_string(\u0026SourceType::Local).unwrap(), \"\\\"local\\\"\");\n        assert_eq!(serde_json::to_string(\u0026SourceType::Remote).unwrap(), \"\\\"remote\\\"\");\n    }\n    \n    #[test]\n    fn test_source_type_deserialization() {\n        assert_eq!(serde_json::from_str::\u003cSourceType\u003e(\"\\\"local\\\"\").unwrap(), SourceType::Local);\n        assert_eq!(serde_json::from_str::\u003cSourceType\u003e(\"\\\"remote\\\"\").unwrap(), SourceType::Remote);\n    }\n    \n    #[test]\n    fn test_source_type_default() {\n        assert_eq!(SourceType::default(), SourceType::Local);\n    }\n}\n```\n\n### Provenance Struct Tests\n```rust\n#[test]\nfn test_provenance_construction() {\n    let prov = Provenance {\n        source_type: SourceType::Remote,\n        hostname: Some(\"laptop.local\".to_string()),\n        sync_timestamp: Some(Utc::now()),\n    };\n    \n    assert!(prov.is_remote());\n    assert_eq!(prov.hostname.as_deref(), Some(\"laptop.local\"));\n}\n\n#[test]\nfn test_provenance_local_default() {\n    let prov = Provenance::local();\n    \n    assert!(!prov.is_remote());\n    assert!(prov.hostname.is_none());\n    assert!(prov.sync_timestamp.is_none());\n}\n\n#[test]\nfn test_provenance_display_format() {\n    let local = Provenance::local();\n    let remote = Provenance::remote(\"laptop.local\".to_string());\n    \n    assert_eq!(local.display_label(), \"local\");\n    assert_eq!(remote.display_label(), \"laptop.local (remote)\");\n}\n```\n\n### SourceFilter Tests\n```rust\n#[test]\nfn test_source_filter_parsing() {\n    assert_eq!(SourceFilter::parse(\"local\").unwrap(), SourceFilter::Local);\n    assert_eq!(SourceFilter::parse(\"remote\").unwrap(), SourceFilter::Remote);\n    assert_eq!(SourceFilter::parse(\"all\").unwrap(), SourceFilter::All);\n    assert_eq!(\n        SourceFilter::parse(\"myhost\").unwrap(), \n        SourceFilter::Hostname(\"myhost\".to_string())\n    );\n}\n\n#[test]\nfn test_source_filter_matches() {\n    let local_prov = Provenance::local();\n    let remote_prov = Provenance::remote(\"laptop\".to_string());\n    \n    assert!(SourceFilter::Local.matches(\u0026local_prov));\n    assert!(!SourceFilter::Local.matches(\u0026remote_prov));\n    \n    assert!(!SourceFilter::Remote.matches(\u0026local_prov));\n    assert!(SourceFilter::Remote.matches(\u0026remote_prov));\n    \n    assert!(SourceFilter::All.matches(\u0026local_prov));\n    assert!(SourceFilter::All.matches(\u0026remote_prov));\n    \n    assert!(SourceFilter::Hostname(\"laptop\".to_string()).matches(\u0026remote_prov));\n    assert!(!SourceFilter::Hostname(\"other\".to_string()).matches(\u0026remote_prov));\n}\n```\n\n## Dependencies\n- Requires P1.1 (types exist to test)\n\n## Acceptance Criteria\n- [ ] All serialization/deserialization covered\n- [ ] Default values tested\n- [ ] Edge cases (empty strings, None values) covered\n- [ ] Display formatting tested\n- [ ] Filter matching logic tested","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:12:10.145747-05:00","updated_at":"2025-12-16T12:54:32.128644-05:00","closed_at":"2025-12-16T12:54:32.128644-05:00","close_reason":"Tests already implemented in src/sources/provenance.rs: 22 test functions covering serialization, default values, construction, display formatting, and filter matching.","dependencies":[{"issue_id":"coding_agent_session_search-epe","depends_on_id":"coding_agent_session_search-2w4","type":"blocks","created_at":"2025-12-16T01:13:06.138565-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-etr","title":"bd-installer-signing","description":"Add minisign/sha256 pairing to installers; fail-closed when pubkey provided; document trust model.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:20.629746421Z","updated_at":"2025-11-23T20:26:06.744406541Z","closed_at":"2025-11-23T20:26:06.744406541Z","dependencies":[{"issue_id":"coding_agent_session_search-etr","depends_on_id":"coding_agent_session_search-2d0","type":"blocks","created_at":"2025-11-23T20:14:20.631492238Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-etr","depends_on_id":"coding_agent_session_search-zwe","type":"blocks","created_at":"2025-11-23T20:14:20.632830351Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-fik","title":"P5.2 cass sources add command","description":"# P5.2 cass sources add command\n\n## Overview\nImplement the `cass sources add` command for registering new remote sources,\nincluding platform presets for common configurations.\n\n## Implementation Details\n\n### CLI Definition\nIn `src/cli.rs`:\n```rust\n#[derive(Parser)]\npub enum SourcesCommand {\n    /// Add a new remote source\n    Add {\n        /// Source URL (e.g., ssh://user@host or just user@host)\n        url: String,\n        \n        /// Friendly name for this source (becomes source_id)\n        #[arg(long)]\n        name: Option\u003cString\u003e,\n        \n        /// Use preset paths for platform (macos-defaults, linux-defaults)\n        #[arg(long)]\n        preset: Option\u003cString\u003e,\n        \n        /// Paths to sync (can be specified multiple times)\n        #[arg(long = \"path\", short = 'p')]\n        paths: Vec\u003cString\u003e,\n        \n        /// Skip connectivity test\n        #[arg(long)]\n        no_test: bool,\n    },\n    // ...\n}\n```\n\n### Platform Presets\n```rust\npub fn get_preset_paths(preset: \u0026str) -\u003e Result\u003cVec\u003cString\u003e, PresetError\u003e {\n    match preset {\n        \"macos-defaults\" =\u003e Ok(vec![\n            \"~/.claude/projects\".into(),\n            \"~/.codex/sessions\".into(),\n            \"~/Library/Application Support/Cursor/User/globalStorage/...\".into(),\n            \"~/Library/Application Support/com.openai.chat\".into(),\n            \"~/.gemini/tmp\".into(),\n            \"~/.pi/agent/sessions\".into(),\n            \"~/.local/share/opencode\".into(),\n            \"~/.continue/sessions\".into(),\n        ]),\n        \"linux-defaults\" =\u003e Ok(vec![\n            \"~/.claude/projects\".into(),\n            \"~/.codex/sessions\".into(),\n            \"~/.config/Cursor/User/globalStorage/...\".into(),\n            \"~/.gemini/tmp\".into(),\n            \"~/.pi/agent/sessions\".into(),\n            \"~/.local/share/opencode\".into(),\n            \"~/.continue/sessions\".into(),\n        ]),\n        _ =\u003e Err(PresetError::Unknown(preset.into())),\n    }\n}\n```\n\n### URL Parsing\n```rust\nfn parse_source_url(url: \u0026str) -\u003e Result\u003c(String, String), SourceError\u003e {\n    let url = url.strip_prefix(\"ssh://\").unwrap_or(url);\n    \n    if !url.contains('@') {\n        return Err(SourceError::InvalidUrl(\"Missing username in URL\".into()));\n    }\n    \n    let (user, host) = url.split_once('@')\n        .ok_or_else(|| SourceError::InvalidUrl(\"Invalid URL format\".into()))?;\n    \n    Ok((user.to_string(), host.to_string()))\n}\n```\n\n### Connectivity Test\n```rust\nasync fn test_ssh_connectivity(host: \u0026str) -\u003e Result\u003c(), SourceError\u003e {\n    let output = Command::new(\"ssh\")\n        .args([\"-o\", \"ConnectTimeout=5\", \"-o\", \"BatchMode=yes\", host, \"echo\", \"ok\"])\n        .output()\n        .await?;\n    \n    if !output.status.success() {\n        let stderr = String::from_utf8_lossy(\u0026output.stderr);\n        return Err(SourceError::ConnectivityFailed(stderr.to_string()));\n    }\n    Ok(())\n}\n```\n\n### Command Flow\n```rust\nasync fn cmd_sources_add(args: \u0026AddArgs) -\u003e Result\u003c(), CliError\u003e {\n    let (user, host) = parse_source_url(\u0026args.url)?;\n    \n    // Generate source_id from hostname if not provided\n    let source_id = args.name.clone().unwrap_or_else(|| {\n        host.split('.').next().unwrap_or(\u0026host).to_string()\n    });\n    \n    // Get paths from preset or explicit args\n    let paths = if let Some(preset) = \u0026args.preset {\n        get_preset_paths(preset)?\n    } else if args.paths.is_empty() {\n        // Prompt: \"No paths specified. Use --preset or --path. Try --preset macos-defaults?\"\n        return Err(CliError::NoPaths);\n    } else {\n        args.paths.clone()\n    };\n    \n    // Test connectivity\n    if !args.no_test {\n        println!(\"Testing SSH connectivity to {}...\", host);\n        test_ssh_connectivity(\u0026format!(\"{}@{}\", user, host)).await?;\n        println!(\"✓ Connected successfully\");\n    }\n    \n    // Save to config\n    let mut config = SourcesConfig::load()?;\n    config.sources.push(SourceDefinition {\n        name: source_id.clone(),\n        source_type: SourceConnectionType::Ssh,\n        host: Some(format!(\"{}@{}\", user, host)),\n        paths,\n        ..Default::default()\n    });\n    config.save()?;\n    \n    println!(\"✓ Added source '{}'. Run 'cass sources sync' to fetch sessions.\", source_id);\n    Ok(())\n}\n```\n\n## Dependencies\n- Requires P5.1 (config types exist)\n\n## Acceptance Criteria\n- [ ] `cass sources add user@host --preset macos-defaults` works\n- [ ] `cass sources add user@host --preset linux-defaults` works\n- [ ] Connectivity tested before saving (unless --no-test)\n- [ ] Name auto-generated from hostname if not provided\n- [ ] Helpful error messages for connection failures\n- [ ] Config file created/updated\n- [ ] Presets documented in --help","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:07:31.070728-05:00","updated_at":"2025-12-16T14:30:42.177058-05:00","closed_at":"2025-12-16T14:30:42.177058-05:00","close_reason":"Implemented sources add command with URL parsing, platform presets, SSH connectivity test, and config persistence","dependencies":[{"issue_id":"coding_agent_session_search-fik","depends_on_id":"coding_agent_session_search-luj","type":"blocks","created_at":"2025-12-16T01:08:52.283093-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-flk","title":"Storage \u0026 data model: SQLite schema and migrations","description":"Finalize normalized schema (agents, conversations, messages, snippets, tags), pragmas, migrations, and Rusqlite data access layer.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-21T01:27:17.365420062Z","updated_at":"2025-11-23T14:36:43.00576728Z","closed_at":"2025-11-23T14:36:43.00576728Z","dependencies":[{"issue_id":"coding_agent_session_search-flk","depends_on_id":"coding_agent_session_search-acz","type":"blocks","created_at":"2025-11-21T01:27:17.384894268Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-flk.1","title":"Finalize normalized SQLite schema + migration v1","description":"Confirm tables/indices (agents, workspaces, conversations, messages, snippets, tags, fts_messages), write migration SQL with pragmas.","notes":"Schema/migration v1 with pragmas in src/storage/sqlite.rs; normalized structs in src/model/types.rs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:08.371692016Z","updated_at":"2025-11-21T02:44:21.576129922Z","closed_at":"2025-11-21T02:44:21.576129922Z","dependencies":[{"issue_id":"coding_agent_session_search-flk.1","depends_on_id":"coding_agent_session_search-acz","type":"blocks","created_at":"2025-11-21T01:28:08.37264812Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-flk.2","title":"Implement rusqlite data access layer (pool, pragmas, meta, migrations)","description":"Open DB with bundled SQLite, apply pragmas (WAL, cache, mmap), run migrations, expose typed repositories for agents/conversations/messages/snippets.","notes":"Rusqlite DAL scaffolding: ensure_agent/workspace, insert_conversation_tree transactional with messages/snippets; pragmas/migrations already in place.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:12.243616544Z","updated_at":"2025-11-23T14:35:26.86586898Z","closed_at":"2025-11-23T14:35:26.86586898Z","dependencies":[{"issue_id":"coding_agent_session_search-flk.2","depends_on_id":"coding_agent_session_search-flk.1","type":"blocks","created_at":"2025-11-21T01:28:12.24500575Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-flk.3","title":"Define Rust domain models + serde for normalized entities","description":"Implement structs/enums for Agent, Workspace, Conversation, Message, Snippet, Tag with serde and conversion helpers to/from DB rows.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:28:15.406153572Z","updated_at":"2025-11-23T14:37:34.735971645Z","closed_at":"2025-11-23T14:37:34.735971645Z","dependencies":[{"issue_id":"coding_agent_session_search-flk.3","depends_on_id":"coding_agent_session_search-flk.2","type":"blocks","created_at":"2025-11-21T01:28:15.408405864Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-fty","title":"P7.5 Schema migration tests","description":"# P7.5 Schema migration tests\n\n## Overview\nTests to verify that schema migrations work correctly when upgrading from\npre-provenance database versions.\n\n## Test Cases\n\n### Migration from v0 (no provenance)\n```rust\n#[tokio::test]\nasync fn test_migration_from_legacy_schema() {\n    // Create database with old schema (no sources table, no source_id column)\n    let temp_dir = tempdir().unwrap();\n    let db_path = temp_dir.path().join(\"legacy.db\");\n    \n    // Manually create old schema\n    let conn = rusqlite::Connection::open(\u0026db_path).unwrap();\n    conn.execute_batch(r#\"\n        CREATE TABLE conversations (\n            id TEXT PRIMARY KEY,\n            agent_id INTEGER,\n            title TEXT,\n            started_at INTEGER,\n            ended_at INTEGER,\n            source_path TEXT\n        );\n        CREATE TABLE agents (id INTEGER PRIMARY KEY, slug TEXT);\n        INSERT INTO agents VALUES (1, 'claude-code');\n        INSERT INTO conversations VALUES ('conv1', 1, 'Test', 1700000000, NULL, '/path');\n    \"#).unwrap();\n    drop(conn);\n    \n    // Open with new schema (should migrate)\n    let db = Database::open(\u0026db_path).await.unwrap();\n    \n    // Verify migration worked\n    assert!(db.has_table(\"sources\").await.unwrap());\n    assert!(db.has_column(\"conversations\", \"source_id\").await.unwrap());\n    \n    // Existing data should have source_id = NULL (will be treated as local)\n    let conv = db.get_conversation(\"conv1\").await.unwrap().unwrap();\n    assert!(conv.source_id.is_none());  // Legacy data\n    assert_eq!(conv.effective_source_type(), SourceType::Local);\n}\n\n#[tokio::test]\nasync fn test_migration_preserves_data() {\n    // ... setup legacy DB with 100 conversations\n    \n    let db = Database::open(\u0026db_path).await.unwrap();\n    \n    // All conversations should still exist\n    assert_eq!(db.conversation_count().await.unwrap(), 100);\n    \n    // All should be searchable\n    let results = searcher.search(\"\").await.unwrap();\n    assert_eq!(results.len(), 100);\n}\n```\n\n### Backup Before Migration\n```rust\n#[tokio::test]\nasync fn test_migration_creates_backup() {\n    let temp_dir = tempdir().unwrap();\n    let db_path = temp_dir.path().join(\"test.db\");\n    \n    // Create legacy DB\n    create_legacy_db(\u0026db_path).await;\n    \n    // Open with new code (triggers migration)\n    let _db = Database::open(\u0026db_path).await.unwrap();\n    \n    // Backup should exist\n    let backup_pattern = format!(\"test.db.backup.*\");\n    let backups: Vec\u003c_\u003e = glob::glob(\u0026temp_dir.path().join(\u0026backup_pattern).to_str().unwrap())\n        .unwrap()\n        .collect();\n    assert_eq!(backups.len(), 1);\n}\n```\n\n### Tantivy Index Rebuild\n```rust\n#[tokio::test]\nasync fn test_tantivy_index_rebuild_on_schema_change() {\n    // ... setup with old Tantivy schema (no source fields)\n    \n    // Open with new schema\n    let searcher = Searcher::open(\u0026index_path).await.unwrap();\n    \n    // Should have been rebuilt with new schema\n    assert!(searcher.schema_has_field(\"source_type\"));\n    assert!(searcher.schema_has_field(\"source_hostname\"));\n    \n    // Search should still work (index was rebuilt from SQLite)\n    let results = searcher.search(\"test\").await.unwrap();\n    assert!(!results.is_empty());\n}\n```\n\n## Dependencies\n- Requires P1.5 (migration strategy implemented)\n\n## Acceptance Criteria\n- [ ] Migration from legacy schema works\n- [ ] Existing data preserved\n- [ ] Backup created before migration\n- [ ] Tantivy index rebuilt when schema changes\n- [ ] No data loss in any migration path","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:12:38.280472-05:00","updated_at":"2025-12-16T12:55:20.106719-05:00","closed_at":"2025-12-16T12:55:20.106719-05:00","close_reason":"Migration tests already implemented in tests/storage.rs: schema_version_created_on_open, migration_from_v1_applies_v2_and_v3, migration_from_v2_applies_v3, migration_from_v3_creates_sources_table, v4_to_v5_migration","dependencies":[{"issue_id":"coding_agent_session_search-fty","depends_on_id":"coding_agent_session_search-c8e","type":"blocks","created_at":"2025-12-16T01:13:37.683078-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-fwr","title":"TST.9 Unit: repeatable + path/int inference","description":"Tests for repeatable options (agent, workspace, watch-once, aggregate), path hints (data-dir/db/path), integer heuristics (limit/offset/line/context/days/stale-threshold). Ensure introspect repeatable/value_type fields match expectations without mocks.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-01T18:57:06.068025358Z","updated_at":"2025-12-01T18:57:06.068025358Z","dependencies":[{"issue_id":"coding_agent_session_search-fwr","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-12-01T18:58:13.551520109Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-g6s","title":"P7.2 Unit tests for source configuration","description":"# P7.2 Unit tests for source configuration\n\n## Overview\nTests for configuration parsing, validation, and persistence.\n\n## Test Cases\n\n### Config Parsing Tests\n```rust\n#[test]\nfn test_empty_config() {\n    let config: SourcesConfig = toml::from_str(\"\").unwrap();\n    assert!(config.sources.is_empty());\n}\n\n#[test]\nfn test_single_source_config() {\n    let toml = r#\"\n        [[sources]]\n        name = \"laptop\"\n        type = \"ssh\"\n        host = \"user@laptop.local\"\n        paths = [\"~/.claude/projects\", \"~/.cursor\"]\n    \"#;\n    \n    let config: SourcesConfig = toml::from_str(toml).unwrap();\n    assert_eq!(config.sources.len(), 1);\n    assert_eq!(config.sources[0].name, \"laptop\");\n    assert_eq!(config.sources[0].paths.len(), 2);\n}\n\n#[test]\nfn test_config_with_path_mappings() {\n    let toml = r#\"\n        [[sources]]\n        name = \"laptop\"\n        type = \"ssh\"\n        host = \"user@laptop.local\"\n        paths = [\"~/.claude\"]\n        \n        [[sources.path_mappings]]\n        from = \"/home/user\"\n        to = \"/Users/me\"\n    \"#;\n    \n    let config: SourcesConfig = toml::from_str(toml).unwrap();\n    assert_eq!(config.sources[0].path_mappings.len(), 1);\n}\n\n#[test]\nfn test_config_roundtrip() {\n    let original = SourcesConfig {\n        sources: vec![SourceDefinition {\n            name: \"test\".to_string(),\n            source_type: SourceConnectionType::Ssh,\n            host: Some(\"user@host\".to_string()),\n            paths: vec![\"~/.claude\".to_string()],\n            ..Default::default()\n        }],\n    };\n    \n    let serialized = toml::to_string(\u0026original).unwrap();\n    let deserialized: SourcesConfig = toml::from_str(\u0026serialized).unwrap();\n    \n    assert_eq!(original.sources.len(), deserialized.sources.len());\n    assert_eq!(original.sources[0].name, deserialized.sources[0].name);\n}\n```\n\n### Validation Tests\n```rust\n#[test]\nfn test_source_requires_host_for_ssh() {\n    let source = SourceDefinition {\n        name: \"test\".to_string(),\n        source_type: SourceConnectionType::Ssh,\n        host: None,  // Missing!\n        paths: vec![],\n        ..Default::default()\n    };\n    \n    assert!(source.validate().is_err());\n}\n\n#[test]\nfn test_source_name_uniqueness() {\n    let config = SourcesConfig {\n        sources: vec![\n            SourceDefinition { name: \"laptop\".into(), ..Default::default() },\n            SourceDefinition { name: \"laptop\".into(), ..Default::default() },  // Duplicate!\n        ],\n    };\n    \n    assert!(config.validate().is_err());\n}\n```\n\n## Dependencies\n- Requires P5.1 (config types)\n\n## Acceptance Criteria\n- [ ] All config variants parse correctly\n- [ ] Invalid configs produce errors\n- [ ] Roundtrip serialization works\n- [ ] Validation catches common mistakes","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:12:19.098157-05:00","updated_at":"2025-12-16T12:55:14.863313-05:00","closed_at":"2025-12-16T12:55:14.863313-05:00","close_reason":"Storage tests for sources already implemented in tests/storage.rs: local_source_auto_created_on_init, list_sources_includes_local, upsert_and_get_source, upsert_updates_existing_source, delete_source_removes_it, delete_nonexistent_source_returns_false","dependencies":[{"issue_id":"coding_agent_session_search-g6s","depends_on_id":"coding_agent_session_search-luj","type":"blocks","created_at":"2025-12-16T01:13:11.382612-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-glt","title":"P12 Ultra-low-latency search v2","description":"Push interactive search to sub-60ms per keystroke via caching, warmups, snippet reuse, reload debounce, and background index optimization.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-26T22:49:49.877743889Z","updated_at":"2025-12-01T19:52:11.323251751Z","closed_at":"2025-12-01T19:52:11.323251751Z","labels":["performance","search"]}
{"id":"coding_agent_session_search-glt.1","title":"B12.1 Prefix cache shards + bloom meta","description":"Refine prefix cache: per-agent/global LRUs (~2k entries total), store lowered strings + bloom-like bitmask per hit, versioned cache key (query+filters+schema hash). Expose trace metrics (hit/miss/shortfall).","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:50:03.971495411Z","updated_at":"2025-11-29T20:03:49.430914325Z","closed_at":"2025-11-29T20:03:49.430914325Z","labels":["performance","search"],"comments":[{"id":5,"issue_id":"coding_agent_session_search-glt.1","author":"ubuntu","text":"Implemented glt.1 caching improvements: (1) cache namespace now versioned with schema hash; (2) total cache cap (default 2048, env CASS_CACHE_TOTAL_CAP) with cross-shard eviction; (3) per-shard cap still env CASS_CACHE_SHARD_CAP; (4) cache keys include version+schema; (5) tests updated/added in query.rs. Ran cargo fmt, cargo check --all-targets, cargo clippy --all-targets -- -D warnings (clean).","created_at":"2025-12-01T23:22:10Z"},{"id":6,"issue_id":"coding_agent_session_search-glt.1","author":"ubuntu","text":"Further work: added cache stats API (hits/miss/shortfall/reloads + total cap/cost), cache debug toggle env CASS_DEBUG_CACHE_METRICS=1 to emit tracing on cache events, total-cap cross-shard eviction test, and cache doc in README. Attempts at cargo bench search_perf timed out at 120s on this machine; skipped for now. fmt/check/clippy clean.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-glt.10","title":"B12.10 Debug surfacing for cache","description":"Optional footer/debug flag showing cache hit/miss; CASS Index Statistics\n=====================\nDatabase: /home/ubuntu/.local/share/coding-agent-search/agent_search.db\n\nTotals:\n  Conversations: 1726\n  Messages: 318525\n\nBy Agent:\n  codex: 1235\n  claude_code: 384\n  gemini: 107\n\nTop Workspaces:\n  /data/projects/smartedgar_mcp: 540\n  /data/projects/historical_soldiers: 126\n  /data/projects/lumera_ai: 116\n  /data/projects/rust_scriptbots: 71\n  /data/projects/mcp_agent_mail: 64\n  /data/projects/smartedgar_mcp_frontend: 60\n  /data/projects/ultimate_bug_scanner: 50\n  /data/projects/smartedgar: 40\n  /data/projects/lumera_ai_website: 39\n  /home/ubuntu/.gemini/tmp/42e4158174f0ef318c8b7e5ef9f77b2bf9d7295cbae54bc84f606191d84600cc: 34\n\nDate Range: 2025-09-10 to 2025-11-26 flag to dump cache counters and reload metrics.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-26T22:51:18.772885599Z","updated_at":"2025-11-30T05:27:29.542518123Z","closed_at":"2025-11-30T05:27:29.542518123Z","labels":["debug","performance"],"dependencies":[{"issue_id":"coding_agent_session_search-glt.10","depends_on_id":"coding_agent_session_search-glt.1","type":"blocks","created_at":"2025-11-26T22:52:47.742561183Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.10","depends_on_id":"coding_agent_session_search-glt.5","type":"blocks","created_at":"2025-11-26T22:52:54.668164573Z","created_by":"daemon"}],"comments":[{"id":7,"issue_id":"coding_agent_session_search-glt.10","author":"ubuntu","text":"Implemented cache debug surfacing in TUI: when env CASS_DEBUG_CACHE_METRICS=1, footer shows cache hits/miss/shortfall, reload counts/time, and cache cost/cap from SearchClient::cache_stats. Cache stats now returned on SearchResult; added eviction/stat tests and global cache cap API. Border toggle duplication cleaned earlier remains Ctrl+B. fmt/check/clippy clean.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-glt.2","title":"B12.2 Idle-time prefix warmup","description":"When typing pauses (~80-150ms), enqueue low-priority warmups for current and adjacent prefixes; cap work per interval. Use same cache shards; mark warm entries for metrics.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:50:12.147739525Z","updated_at":"2025-11-30T06:24:00.654173281Z","closed_at":"2025-11-30T06:24:00.654173281Z","labels":["performance","search"],"dependencies":[{"issue_id":"coding_agent_session_search-glt.2","depends_on_id":"coding_agent_session_search-glt.1","type":"blocks","created_at":"2025-11-26T22:51:32.181075978Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.2","depends_on_id":"coding_agent_session_search-glt.5","type":"blocks","created_at":"2025-11-26T22:51:36.953629Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-glt.3","title":"B12.3 Cached-hit fast matcher","description":"Store lc_content/title/snippet + small bloom8 per hit; implement hit_matches_query_cached with bloom gate then substring on pre-lowered text; microbench \u003c1µs.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:50:18.93827292Z","updated_at":"2025-11-30T06:24:01.090009604Z","closed_at":"2025-11-30T06:24:01.090009604Z","labels":["performance","search"],"dependencies":[{"issue_id":"coding_agent_session_search-glt.3","depends_on_id":"coding_agent_session_search-glt.1","type":"blocks","created_at":"2025-11-26T22:51:45.962705062Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-glt.4","title":"B12.4 Snippet reuse \u0026 prefix highlighting","description":"Classify prefix-only queries; reuse cached snippets/previews instead of SnippetGenerator; keep highlight lightweight; store snippet in cache entries.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:50:27.727469852Z","updated_at":"2025-11-30T06:24:01.364659261Z","closed_at":"2025-11-30T06:24:01.364659261Z","labels":["performance","search","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-glt.4","depends_on_id":"coding_agent_session_search-glt.1","type":"blocks","created_at":"2025-11-26T22:51:53.87051251Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-glt.5","title":"B12.5 Reader reload debounce + thread-local searcher","description":"Track index generation; debounce reader.reload() to ~300ms; keep thread-local searcher to cut lock contention; log reload counts/ms.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-26T22:50:34.832269114Z","updated_at":"2025-11-29T20:05:22.766315642Z","closed_at":"2025-11-29T20:05:22.766315642Z","labels":["performance","search"],"comments":[{"id":8,"issue_id":"coding_agent_session_search-glt.5","author":"ubuntu","text":"Taking this: GreenDog working on reader reload debounce + thread-local searcher. Will post PR-ready updates.","created_at":"2025-12-01T23:22:10Z"},{"id":9,"issue_id":"coding_agent_session_search-glt.5","author":"ubuntu","text":"Progress update: implemented thread-local Tantivy searcher cache keyed by reload epoch, generation tracking that clears prefix cache on index change, and reload metrics with debounced logging. Warm worker now bumps reload epoch and records duration. Ran cargo fmt, cargo check --all-targets, and cargo clippy --all-targets -- -D warnings.","created_at":"2025-12-01T23:22:10Z"},{"id":10,"issue_id":"coding_agent_session_search-glt.5","author":"ubuntu","text":"Added regression test to ensure generation changes clear prefix cache. Fixed clippy warnings (redundant closure, collapsible if) in TUI. Reran cargo fmt/check/clippy --all-targets clean.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-glt.6","title":"B12.6 Preview field \u0026 schema v4 experiment","description":"Add lightweight preview field (non-stored, fast) to speed prefix snippets; bump schema hash; measure index size/throughput tradeoff.","notes":"Claimed by BlueCastle. Implementing preview field for schema v4.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-26T22:50:42.024092923Z","updated_at":"2025-11-30T05:27:03.534790844Z","closed_at":"2025-11-30T05:27:03.534790844Z","labels":["performance","schema","search"]}
{"id":"coding_agent_session_search-glt.7","title":"B12.7 Background merge/optimize when idle","description":"Idle-triggered Tantivy segment merge/optimize; track last-merge timestamp; expose debug status; avoid blocking UI.","notes":"Claimed by BlueCastle. Implementing idle-triggered Tantivy segment merge/optimize.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-26T22:50:53.039860322Z","updated_at":"2025-11-30T05:38:11.611531588Z","closed_at":"2025-11-30T05:38:11.611531588Z","labels":["performance","search"]}
{"id":"coding_agent_session_search-glt.8","title":"B12.8 Config + memory guardrails","description":"Add knobs for cache size/shards/warmup; approximate byte cap; metrics for evictions; env/CLI toggles.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:51:01.273995305Z","updated_at":"2025-11-30T06:23:31.735275822Z","closed_at":"2025-11-30T06:23:31.735275822Z","labels":["config","performance"]}
{"id":"coding_agent_session_search-glt.9","title":"B12.9 Perf tests \u0026 typing benchmarks","description":"Bench rapid typing/backspace (median/99p latency), unit tests for cache correctness, bloom gating, filter fidelity; property test no filter violations.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-26T22:51:09.845524665Z","updated_at":"2025-11-30T06:22:27.707591773Z","closed_at":"2025-11-30T06:22:27.707591773Z","labels":["performance","tests"],"dependencies":[{"issue_id":"coding_agent_session_search-glt.9","depends_on_id":"coding_agent_session_search-glt.1","type":"blocks","created_at":"2025-11-26T22:52:00.929643012Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.9","depends_on_id":"coding_agent_session_search-glt.3","type":"blocks","created_at":"2025-11-26T22:52:06.922983969Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.9","depends_on_id":"coding_agent_session_search-glt.4","type":"blocks","created_at":"2025-11-26T22:52:13.593223534Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.9","depends_on_id":"coding_agent_session_search-glt.5","type":"blocks","created_at":"2025-11-26T22:52:20.45660419Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.9","depends_on_id":"coding_agent_session_search-glt.6","type":"blocks","created_at":"2025-11-26T22:52:27.964076323Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.9","depends_on_id":"coding_agent_session_search-glt.7","type":"blocks","created_at":"2025-11-26T22:52:34.761593718Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-glt.9","depends_on_id":"coding_agent_session_search-glt.8","type":"blocks","created_at":"2025-11-26T22:52:40.252273672Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-hlb","title":"Fix failing state_matches_status test","description":"Test expects pending.sessions=3 but fixture is missing watch_state.json file. Need to add watch_state.json with pending_count=3 to tests/fixtures/search_demo_data/","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T18:29:49.667628-05:00","updated_at":"2025-12-01T18:31:49.186842-05:00","closed_at":"2025-12-01T18:31:49.186842-05:00"}
{"id":"coding_agent_session_search-iqa","title":"Fix critical unwrap panics","description":"Replace dangerous unwrap() calls in indexer with proper error handling. (UBS Critical)","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-01T22:18:18.936412-05:00","updated_at":"2025-12-01T22:19:02.364274-05:00","closed_at":"2025-12-01T22:19:02.364274-05:00"}
{"id":"coding_agent_session_search-j2z","title":"Refactor test_store to avoid mem::forget","description":"Avoid leaking TempDir in bookmarks.rs tests by returning the guard with the store. (UBS Warning)","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T18:27:20.848834-05:00","updated_at":"2025-12-01T18:30:18.845983-05:00","closed_at":"2025-12-01T18:30:18.845983-05:00"}
{"id":"coding_agent_session_search-jgg","title":"P7.10 Test timeline JSON provenance fields","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T12:57:00.659772-05:00","updated_at":"2025-12-16T12:57:00.659772-05:00","dependencies":[{"issue_id":"coding_agent_session_search-jgg","depends_on_id":"coding_agent_session_search-aui","type":"blocks","created_at":"2025-12-16T12:57:24.450585-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-ke5","title":"TST.14 Docs: test matrix + how-to","description":"Document unit/integration/e2e matrix, coverage command, log/trace locations, how to run new introspect-contract tests; link bead IDs for maintenance.","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-01T18:57:38.353001101Z","updated_at":"2025-12-01T18:57:38.353001101Z","dependencies":[{"issue_id":"coding_agent_session_search-ke5","depends_on_id":"coding_agent_session_search-bs8","type":"blocks","created_at":"2025-12-01T18:58:51.403253691Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-kg9","title":"TUI filter pills + popovers","description":"Add filter pill row with quick clear; inline popovers for agent/workspace/time presets; keyboard and mouse.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T07:56:34.720011243Z","updated_at":"2025-11-23T14:37:33.689934428Z","closed_at":"2025-11-23T14:37:33.689934428Z","labels":["filters","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-kg9","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:56:34.728802508Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-kzc","title":"Replace blocking std::fs in async code","description":"Replace blocking IO with tokio::fs in async functions to avoid blocking the runtime.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-01T22:15:54.261514-05:00","updated_at":"2025-12-01T22:18:08.383949-05:00","closed_at":"2025-12-01T22:18:08.383949-05:00"}
{"id":"coding_agent_session_search-lr2","title":"P5.7 cass sources remove command","description":"# P5.7 cass sources remove command\n\n## Overview\nImplement command to remove a configured source and optionally clean up\nits synced data.\n\n## Implementation Details\n\n### CLI Definition\n```rust\n#[derive(Parser)]\npub enum SourcesCommand {\n    /// Remove a configured source\n    Remove {\n        /// Name of source to remove\n        name: String,\n        \n        /// Also delete synced session data\n        #[arg(long)]\n        purge: bool,\n        \n        /// Skip confirmation prompt\n        #[arg(long, short = 'y')]\n        yes: bool,\n    },\n    // ...\n}\n```\n\n### Implementation\n```rust\nasync fn cmd_sources_remove(args: \u0026RemoveArgs) -\u003e Result\u003c(), CliError\u003e {\n    let mut config = SourcesConfig::load()?;\n    \n    // Find source\n    let idx = config.sources.iter()\n        .position(|s| s.name == args.name)\n        .ok_or_else(|| CliError::SourceNotFound(args.name.clone()))?;\n    \n    // Confirm\n    if !args.yes {\n        let msg = if args.purge {\n            format!(\n                \"Remove source '{}' and delete all synced data? This cannot be undone.\",\n                args.name\n            )\n        } else {\n            format!(\n                \"Remove source '{}' from configuration? Synced data will be preserved.\",\n                args.name\n            )\n        };\n        \n        if !confirm(\u0026msg)? {\n            println!(\"Cancelled.\");\n            return Ok(());\n        }\n    }\n    \n    // Remove from config\n    config.sources.remove(idx);\n    config.save()?;\n    println!(\"Removed '{}' from configuration.\", args.name);\n    \n    // Optionally purge data\n    if args.purge {\n        let data_dir = dirs::data_local_dir()?.join(\"cass/remotes\").join(\u0026args.name);\n        if data_dir.exists() {\n            std::fs::remove_dir_all(\u0026data_dir)?;\n            println!(\"Deleted synced data at {:?}\", data_dir);\n            \n            // Also remove from index\n            remove_source_from_index(\u0026args.name).await?;\n            println!(\"Removed from search index.\");\n        }\n    }\n    \n    Ok(())\n}\n```\n\n## Dependencies\n- Requires P5.1 (config types)\n\n## Acceptance Criteria\n- [ ] Source removed from config file\n- [ ] Confirmation prompt unless -y\n- [ ] `--purge` deletes synced data and index entries\n- [ ] Helpful error if source not found","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T01:08:03.718383-05:00","updated_at":"2025-12-16T01:08:03.718383-05:00","dependencies":[{"issue_id":"coding_agent_session_search-lr2","depends_on_id":"coding_agent_session_search-luj","type":"blocks","created_at":"2025-12-16T01:09:23.79805-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-lsv","title":"P7 Multi-open queue","description":"Ctrl+Enter enqueue; Ctrl+O opens queued hits; confirm if large.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:59:08.659048422Z","updated_at":"2025-12-02T00:54:30.731571-05:00","closed_at":"2025-12-02T00:54:30.731571-05:00","dependencies":[{"issue_id":"coding_agent_session_search-lsv","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T13:59:15.51218995Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-lsv.1","title":"B7.1 Queue and open batch","description":"Ctrl+Enter enqueue; footer queued:n; Ctrl+O opens queued hits; confirm if large.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:59:11.792072523Z","updated_at":"2025-12-02T00:54:08.08465-05:00","closed_at":"2025-12-02T00:54:08.08465-05:00"}
{"id":"coding_agent_session_search-luj","title":"P5.1 Source configuration data structures","description":"# P5.1 Source configuration data structures\n\n## Overview\nDefine the Rust types for source configuration, supporting both file-based\nconfig and runtime representation.\n\n## Implementation Details\n\n### Configuration Types\nCreate `src/sources/config.rs`:\n```rust\nuse serde::{Deserialize, Serialize};\nuse std::path::PathBuf;\n\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct SourcesConfig {\n    #[serde(default)]\n    pub sources: Vec\u003cSourceDefinition\u003e,\n}\n\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct SourceDefinition {\n    /// Friendly name for this source (e.g., \"laptop\", \"workstation\")\n    pub name: String,\n    \n    /// Connection type\n    #[serde(rename = \"type\")]\n    pub source_type: SourceConnectionType,\n    \n    /// Remote host (for SSH type)\n    #[serde(default)]\n    pub host: Option\u003cString\u003e,\n    \n    /// Paths to sync from remote\n    #[serde(default)]\n    pub paths: Vec\u003cString\u003e,\n    \n    /// Sync schedule\n    #[serde(default)]\n    pub sync_schedule: SyncSchedule,\n    \n    /// Path mappings for workspace rewriting (Phase 6)\n    #[serde(default)]\n    pub path_mappings: std::collections::HashMap\u003cString, String\u003e,\n}\n\n#[derive(Debug, Clone, Serialize, Deserialize, Default)]\n#[serde(rename_all = \"lowercase\")]\npub enum SourceConnectionType {\n    #[default]\n    Local,\n    Ssh,\n}\n\n#[derive(Debug, Clone, Serialize, Deserialize, Default)]\n#[serde(rename_all = \"lowercase\")]\npub enum SyncSchedule {\n    #[default]\n    Manual,\n    Hourly,\n    Daily,\n}\n```\n\n### Config File Location\n- Primary: `~/.config/cass/sources.toml`\n- Fallback: `$XDG_CONFIG_HOME/cass/sources.toml`\n\n### Parsing Function\n```rust\nimpl SourcesConfig {\n    pub fn load() -\u003e Result\u003cSelf, ConfigError\u003e {\n        let config_path = Self::config_path()?;\n        if !config_path.exists() {\n            return Ok(Self::default());\n        }\n        let content = std::fs::read_to_string(\u0026config_path)?;\n        toml::from_str(\u0026content).map_err(ConfigError::Parse)\n    }\n    \n    pub fn save(\u0026self) -\u003e Result\u003c(), ConfigError\u003e {\n        let config_path = Self::config_path()?;\n        if let Some(parent) = config_path.parent() {\n            std::fs::create_dir_all(parent)?;\n        }\n        let content = toml::to_string_pretty(self)?;\n        std::fs::write(\u0026config_path, content)?;\n        Ok(())\n    }\n}\n```\n\n## Dependencies\n- Foundation for all Phase 5 tasks\n- No dependencies on other tasks\n\n## Acceptance Criteria\n- [ ] Types compile and serialize/deserialize correctly\n- [ ] Example config file parseable\n- [ ] Default config is empty sources list\n- [ ] Config path follows XDG conventions","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:07:24.360483-05:00","updated_at":"2025-12-16T01:42:39.548985-05:00","closed_at":"2025-12-16T01:42:39.548985-05:00","close_reason":"Implemented source configuration types in src/sources/config.rs with full test coverage. Types: SourcesConfig, SourceDefinition, SourceConnectionType, SyncSchedule, Platform. Features: TOML serialization, XDG config path, validation, path rewriting, platform presets."}
{"id":"coding_agent_session_search-lxx","title":"bd-unit-storage","description":"SqliteStorage coverage: schema_version getters, FTS rebuild helper, transaction rollback, insert append path","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:07.805505888Z","updated_at":"2025-11-23T20:06:05.29934154Z","closed_at":"2025-11-23T20:06:05.29934154Z","dependencies":[{"issue_id":"coding_agent_session_search-lxx","depends_on_id":"coding_agent_session_search-vbf","type":"blocks","created_at":"2025-11-23T17:35:07.806897708Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-lz1","title":"Search engine: Tantivy + FTS5 integration","description":"Define Tantivy schema, indexing pipeline, search API, plus SQLite FTS5 mirror as fallback.","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-21T01:27:21.303774347Z","updated_at":"2025-11-23T14:36:41.489346019Z","closed_at":"2025-11-23T14:36:41.489346019Z","dependencies":[{"issue_id":"coding_agent_session_search-lz1","depends_on_id":"coding_agent_session_search-flk","type":"blocks","created_at":"2025-11-21T01:27:21.308547071Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-lz1.1","title":"Define Tantivy schema and index lifecycle","description":"Fields for message_id, conversation_id, agent_slug, workspace, created_at, title, content; create/open index, manage schema versioning.","notes":"Defined Tantivy schema (agent, workspace, source_path, msg_idx, created_at, title, content) with open/create lifecycle in search/tantivy.rs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:22.111725104Z","updated_at":"2025-11-21T03:11:11.379818187Z","closed_at":"2025-11-21T03:11:11.379818187Z","dependencies":[{"issue_id":"coding_agent_session_search-lz1.1","depends_on_id":"coding_agent_session_search-flk.2","type":"blocks","created_at":"2025-11-21T01:28:22.11384381Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-lz1.2","title":"Implement Tantivy indexing pipeline from DB","description":"Transform conversations/messages into Tantivy docs, handle batch writes, rebuild path per schema version.","notes":"Index pipeline: connectors -\u003e rusqlite DAL -\u003e Tantivy documents; index command uses Indexer::run_index to persist + index and optional watch stub.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:28:25.963684432Z","updated_at":"2025-11-21T03:11:17.155867711Z","closed_at":"2025-11-21T03:11:17.155875411Z","dependencies":[{"issue_id":"coding_agent_session_search-lz1.2","depends_on_id":"coding_agent_session_search-lz1.1","type":"blocks","created_at":"2025-11-21T01:28:25.965309537Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-lz1.2","depends_on_id":"coding_agent_session_search-flk.3","type":"blocks","created_at":"2025-11-21T01:28:25.967363243Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-lz1.3","title":"Build SQLite FTS5 mirror and sync routines","description":"Create fts_messages virtual table, implement sync/refresh routines when messages insert/update.","notes":"Filters UI + pagination wired in TUI; SQLite FTS5 mirror with migration/backfill + insert hooks; added Tantivy search integration test covering filters/pagination.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:28:31.106929515Z","updated_at":"2025-11-21T18:41:04.624773534Z","closed_at":"2025-11-21T18:41:04.624780834Z","dependencies":[{"issue_id":"coding_agent_session_search-lz1.3","depends_on_id":"coding_agent_session_search-flk.2","type":"blocks","created_at":"2025-11-21T01:28:31.108172319Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-lz1.4","title":"Implement search API (query parsing, filters, ranking)","description":"Multi-field query parser with weights, agent/time/workspace filters, paging; fallback to FTS when Tantivy unavailable.","notes":"Tantivy search client returns real docs (agent/time filters, snippets, source path) using TantivyDocument; wired TUI to live search results with status messaging and error handling; clippy/fmt/check clean.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:28:35.634476777Z","updated_at":"2025-11-21T18:09:31.280293093Z","closed_at":"2025-11-21T18:09:31.280343493Z","dependencies":[{"issue_id":"coding_agent_session_search-lz1.4","depends_on_id":"coding_agent_session_search-lz1.2","type":"blocks","created_at":"2025-11-21T01:28:35.635656081Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-lz1.4","depends_on_id":"coding_agent_session_search-lz1.3","type":"blocks","created_at":"2025-11-21T01:28:35.636878085Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-m10","title":"Fix failing aider connector tests","description":"4 tests failing in connector_aider.rs:\n- aider_consecutive_user_lines_combined (line 890)\n- aider_multiline_user_input (line 321)\n- aider_preserves_commands (line 584)\n- aider_user_messages_from_prefix (line 294)\n\nAll tests failing on assertions about user message content parsing.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T18:32:20.849854-05:00","updated_at":"2025-12-01T18:36:03.331383-05:00","closed_at":"2025-12-01T18:36:03.331383-05:00"}
{"id":"coding_agent_session_search-m7y","title":"P6.2 Apply path mappings at display time","description":"# P6.2 Apply path mappings at INGEST time\n\n## Overview\n**IMPORTANT CHANGE:** Workspace path rewriting must happen at ingest time, not display time.\nThis is critical so that workspace FILTERS work consistently across local and remote sources.\n\n## Why Ingest-Time (not Display-Time)\nIf a user searches with `--workspace=/Users/me/projects/myapp`, they expect to find:\n- Local sessions from `/Users/me/projects/myapp`\n- Remote sessions where the ORIGINAL path was `/home/user/projects/myapp`\n\nIf we only rewrite at display-time, the filter won't match the remote sessions because\nthey're stored with the original path. Ingest-time rewriting ensures filter consistency.\n\n## Implementation Details\n\n### Rewrite During Normalization\nIn the indexer, after connector produces NormalizedConversation:\n```rust\nfn apply_workspace_rewrite(\n    conv: \u0026mut NormalizedConversation,\n    source: \u0026SourceDefinition,\n) {\n    if let Some(ref workspace) = conv.workspace {\n        let rewritten = source.rewrite_path(workspace);\n        if rewritten != *workspace {\n            // Store original in metadata for audit/display\n            conv.metadata.insert(\n                \"workspace_original\".into(),\n                serde_json::Value::String(workspace.clone())\n            );\n            conv.workspace = Some(rewritten);\n        }\n    }\n}\n```\n\n### Storage of Original Path\nIn SQLite, add `workspace_original` column (nullable):\n```sql\nALTER TABLE conversations ADD COLUMN workspace_original TEXT;\n```\n\nIn Tantivy, optionally add `workspace_original` as STORED (not indexed):\n```rust\nschema_builder.add_text_field(\"workspace_original\", STORED);\n```\n\n### CLI/TUI Display\nWhen displaying results, show the rewritten (local) path by default.\nIf user wants to see original, add `--show-original-paths` flag or\nshow on hover/detail view:\n```\nWorkspace: /Users/me/projects/myapp\n           (originally /home/user/projects/myapp on work-laptop)\n```\n\n### Robot Output\nInclude both for machine consumption:\n```json\n{\n  \"workspace\": \"/Users/me/projects/myapp\",\n  \"workspace_original\": \"/home/user/projects/myapp\"\n}\n```\n\n## Filter Behavior After Rewrite\nWith ingest-time rewriting:\n- `cass search --workspace=/Users/me/projects/myapp` finds BOTH local and remote sessions\n- Grouping by workspace works correctly across machines\n- TUI workspace filter shows unified list\n\n## Dependencies\n- Requires P6.1 (mapping rules defined)\n- Requires P2.2 (indexer orchestration, where rewrite happens)\n\n## Acceptance Criteria\n- [ ] Workspace rewritten during indexing, not display\n- [ ] Original path preserved in metadata/column\n- [ ] Workspace filters work across sources\n- [ ] Robot output includes both paths\n- [ ] Re-indexing applies new mappings to existing sessions","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T01:09:36.964081-05:00","updated_at":"2025-12-16T01:25:53.194695-05:00","dependencies":[{"issue_id":"coding_agent_session_search-m7y","depends_on_id":"coding_agent_session_search-rv8","type":"blocks","created_at":"2025-12-16T01:11:54.226254-05:00","created_by":"jemanuel"},{"issue_id":"coding_agent_session_search-m7y","depends_on_id":"coding_agent_session_search-alb","type":"blocks","created_at":"2025-12-16T01:11:59.487689-05:00","created_by":"jemanuel"},{"issue_id":"coding_agent_session_search-m7y","depends_on_id":"coding_agent_session_search-1mv","type":"blocks","created_at":"2025-12-16T01:28:39.301008-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-n1l","title":"Update AGENTS.md with Robot Interface Guide","description":"Add a comprehensive section to AGENTS.md explaining the CLI robot mode, fuzzy features, and error format.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T23:04:12.217672-05:00","updated_at":"2025-12-01T23:08:02.405938-05:00","closed_at":"2025-12-01T23:08:02.405938-05:00"}
{"id":"coding_agent_session_search-naq","title":"bd-docs-testing","description":"README testing matrix + env knobs; update help","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:36:03.766483569Z","updated_at":"2025-11-23T20:05:41.459247399Z","closed_at":"2025-11-23T20:05:41.459247399Z","dependencies":[{"issue_id":"coding_agent_session_search-naq","depends_on_id":"coding_agent_session_search-dja","type":"blocks","created_at":"2025-11-23T17:36:03.767159086Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-nfk","title":"Phase 3: CLI \u0026 Robot Output Provenance Integration","description":"# Phase 3: CLI \u0026 Robot Output Provenance Integration\n\n## Overview\nThis phase extends the CLI interface and robot-docs output format to expose provenance\ninformation to users and AI agents. After Phase 2 populates provenance in storage,\nPhase 3 makes it queryable and visible.\n\n## Goals\n1. Add `--source` filter flag to search/timeline commands\n2. Extend SearchHit and TimelineEntry structs with source metadata\n3. Update robot-docs output to include provenance in machine-readable format\n4. Ensure backward compatibility with existing CLI workflows\n\n## Context\nThe robot-docs format is crucial for AI agent consumption. Adding provenance enables\nagents to distinguish between local and remote sessions, filter by machine, and\nunderstand the origin of conversation data.\n\n## Dependencies\n- Requires Phase 2 completion (provenance stored in SQLite + Tantivy)\n- coding_agent_session_search-bfk (Phase 2 epic) must be complete\n\n## Acceptance Criteria\n- [ ] `cass search --source=laptop-hostname \"query\"` filters to that source only\n- [ ] `cass search --source=remote \"query\"` filters to all non-local sources\n- [ ] `cass search --source=local \"query\"` filters to local-only\n- [ ] Robot output includes source_hostname, source_type, sync_timestamp fields\n- [ ] All existing tests pass (backward compatible)","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-12-16T01:00:53.630278-05:00","updated_at":"2025-12-16T13:04:46.618371-05:00","closed_at":"2025-12-16T13:04:46.618371-05:00","close_reason":"Phase 3 complete: All CLI provenance features implemented - P3.1 search --source, P3.2 timeline --source, P3.3 SearchHit provenance, P3.4 robot-docs provenance, P3.5 timeline provenance, P3.6 schema updates, P3.7 stats --source/--by-source","dependencies":[{"issue_id":"coding_agent_session_search-nfk","depends_on_id":"coding_agent_session_search-bfk","type":"blocks","created_at":"2025-12-16T01:01:33.697408-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-nrm","title":"P4.1 TUI styling for remote session rows","description":"# P4.1 TUI styling for remote session rows\n\n## Overview\nApply distinct visual styling to remote-origin session rows in the TUI search\nresults and timeline views.\n\n## Implementation Details\n\n### Style Definition\nIn `src/tui/styles.rs` (or appropriate module):\n```rust\npub const REMOTE_ROW_STYLE: Style = Style::new()\n    .fg(Color::Rgb(180, 180, 190))  // Slightly muted text\n    .bg(Color::Rgb(25, 25, 30));     // Slightly darker background\n\npub const LOCAL_ROW_STYLE: Style = Style::new()\n    .fg(Color::White)\n    .bg(Color::Reset);\n```\n\n### Row Rendering Logic\nWhen rendering search result rows:\n```rust\nfn render_result_row(\u0026self, hit: \u0026SearchHit, area: Rect, buf: \u0026mut Buffer) {\n    let style = match hit.source_type {\n        SourceType::Remote =\u003e REMOTE_ROW_STYLE,\n        SourceType::Local =\u003e LOCAL_ROW_STYLE,\n    };\n    \n    // Apply style to row rendering\n    buf.set_style(area, style);\n    // ... render row content\n}\n```\n\n### Accessibility Considerations\n- Ensure contrast ratio meets WCAG AA (4.5:1 for normal text)\n- Don't rely solely on color (add badge too in P4.2)\n- Test with color blindness simulators\n\n## Dependencies\n- Requires P3.3 (SearchHit has source_type field)\n\n## Acceptance Criteria\n- [ ] Remote rows visually distinct from local rows\n- [ ] Style is subtle but clear\n- [ ] Works in both light and dark terminal themes\n- [ ] Meets accessibility contrast requirements","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:04:40.281565-05:00","updated_at":"2025-12-16T14:11:00.896395-05:00","closed_at":"2025-12-16T14:11:00.896395-05:00","close_reason":"Added remote session styling: purple source badge [hostname] on location line, subtle purple background tint (8% indigo) for remote rows. Visual distinction helps identify session origin.","dependencies":[{"issue_id":"coding_agent_session_search-nrm","depends_on_id":"coding_agent_session_search-alb","type":"blocks","created_at":"2025-12-16T01:06:56.790882-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-nwn","title":"TST.12 Integration: robot docs \u0026 help contract","description":"Verify cass --robot-help and robot-docs schemas topic include dynamic introspection fields; snapshot assertions, ANSI off; fail on missing commands/flags.","notes":"Robot-docs/help contract coverage added; capabilities/introspect fixtures regenerated; robot-help sections/ANSI-free asserted; robot-docs commands/env asserted; run_tui wiring fixed; cli_robot + concurrent_search suites passing.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-12-01T18:57:24.851651771Z","updated_at":"2025-12-01T22:19:51.794666-05:00","closed_at":"2025-12-01T22:19:51.794668-05:00","dependencies":[{"issue_id":"coding_agent_session_search-nwn","depends_on_id":"coding_agent_session_search-bhk","type":"blocks","created_at":"2025-12-01T18:58:30.833309341Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-og6","title":"TUI filters UX: pill row + inline popovers","description":"Add filter pill strip with quick clear, inline popovers for agent/workspace/time with presets; keyboard + mouse support.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T07:51:18.157389583Z","updated_at":"2025-11-23T07:55:39.131877582Z","closed_at":"2025-11-23T07:55:39.131877582Z","labels":["filters","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-og6","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:51:18.166577069Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-otg","title":"P6.3 cass sources mappings subcommands","description":"# P6.3 cass sources mappings subcommands\n\n## Overview\nAdd CLI commands to manage path mappings interactively without editing\nthe config file directly.\n\n## Implementation Details\n\n### CLI Definition\n```rust\n#[derive(Parser)]\npub enum SourcesCommand {\n    /// Manage path mappings for a source\n    Mappings {\n        #[command(subcommand)]\n        action: MappingsAction,\n    },\n    // ...\n}\n\n#[derive(Parser)]\npub enum MappingsAction {\n    /// List path mappings for a source\n    List {\n        /// Source name\n        source: String,\n    },\n    \n    /// Add a path mapping\n    Add {\n        /// Source name\n        source: String,\n        \n        /// Remote path prefix\n        #[arg(long)]\n        from: String,\n        \n        /// Local path prefix\n        #[arg(long)]\n        to: String,\n        \n        /// Only apply to specific agents\n        #[arg(long)]\n        agents: Option\u003cVec\u003cString\u003e\u003e,\n    },\n    \n    /// Remove a path mapping\n    Remove {\n        /// Source name\n        source: String,\n        \n        /// Index of mapping to remove (from list output)\n        index: usize,\n    },\n    \n    /// Test a path mapping\n    Test {\n        /// Source name\n        source: String,\n        \n        /// Path to test\n        path: String,\n    },\n}\n```\n\n### Test Command Output\n```\n$ cass sources mappings test laptop /home/user/projects/myapp\n\nInput:  /home/user/projects/myapp\nOutput: /Users/me/projects/myapp\nRule:   /home/user/projects -\u003e /Users/me/projects\nStatus: ✓ mapped\n\n$ cass sources mappings test laptop /opt/other/path\n\nInput:  /opt/other/path\nOutput: /opt/other/path\nStatus: ✗ no matching rule\n```\n\n## Dependencies\n- Requires P6.1 (mapping types)\n- Requires P5.1 (config save/load)\n\n## Acceptance Criteria\n- [ ] `cass sources mappings list \u003csource\u003e` shows all mappings\n- [ ] `cass sources mappings add` adds new mapping\n- [ ] `cass sources mappings remove` removes by index\n- [ ] `cass sources mappings test` shows what would happen","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T01:09:43.992482-05:00","updated_at":"2025-12-16T01:09:43.992482-05:00","dependencies":[{"issue_id":"coding_agent_session_search-otg","depends_on_id":"coding_agent_session_search-rv8","type":"blocks","created_at":"2025-12-16T01:12:04.746157-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-p8k","title":"Integrate time parser into TUI","description":"Replace numeric parsing with parse_time_input in TUI input handling. (ISSUE-004/BEAD-009)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T18:24:55.004131-05:00","updated_at":"2025-12-01T18:25:14.348912-05:00","closed_at":"2025-12-01T18:25:14.348912-05:00"}
{"id":"coding_agent_session_search-p9t","title":"P5.6 cass sources doctor command","description":"# P5.6 cass sources doctor command\n\n## Overview\nImplement a diagnostic command that checks the health of configured sources\nand provides remediation hints for common issues.\n\n## Implementation Details\n\n### CLI Definition\n```rust\n#[derive(Parser)]\npub enum SourcesCommand {\n    /// Diagnose source connectivity and configuration issues\n    Doctor {\n        /// Check only specific source\n        #[arg(long, short)]\n        source: Option\u003cString\u003e,\n        \n        /// Attempt automatic fixes where possible\n        #[arg(long)]\n        fix: bool,\n    },\n    // ...\n}\n```\n\n### Diagnostic Checks\n```rust\nstruct SourceDiagnostics {\n    checks: Vec\u003cDiagnosticCheck\u003e,\n}\n\nstruct DiagnosticCheck {\n    name: String,\n    status: CheckStatus,\n    message: String,\n    remediation: Option\u003cString\u003e,\n}\n\nenum CheckStatus {\n    Pass,\n    Warn,\n    Fail,\n}\n\nimpl SourceDiagnostics {\n    async fn run_all(source: \u0026SourceDefinition) -\u003e Self {\n        let mut checks = Vec::new();\n        \n        // Check 1: SSH connectivity\n        checks.push(Self::check_ssh_connectivity(source).await);\n        \n        // Check 2: rsync availability\n        checks.push(Self::check_rsync_available(source).await);\n        \n        // Check 3: Remote paths exist\n        for path in \u0026source.paths {\n            checks.push(Self::check_remote_path(source, path).await);\n        }\n        \n        // Check 4: Local storage writable\n        checks.push(Self::check_local_storage().await);\n        \n        // Check 5: Last sync status\n        checks.push(Self::check_last_sync(source).await);\n        \n        Self { checks }\n    }\n    \n    async fn check_ssh_connectivity(source: \u0026SourceDefinition) -\u003e DiagnosticCheck {\n        let host = source.host.as_ref().unwrap_or(\u0026\"\".to_string());\n        \n        let result = Command::new(\"ssh\")\n            .args([\"-o\", \"ConnectTimeout=5\", \"-o\", \"BatchMode=yes\", host, \"true\"])\n            .output()\n            .await;\n        \n        match result {\n            Ok(output) if output.status.success() =\u003e DiagnosticCheck {\n                name: \"SSH Connectivity\".into(),\n                status: CheckStatus::Pass,\n                message: format!(\"Connected to {} successfully\", host),\n                remediation: None,\n            },\n            Ok(output) =\u003e {\n                let stderr = String::from_utf8_lossy(\u0026output.stderr);\n                let remediation = if stderr.contains(\"Permission denied\") {\n                    Some(\"Check SSH key is added to remote authorized_keys\".into())\n                } else if stderr.contains(\"Connection refused\") {\n                    Some(\"Verify SSH server is running on remote host\".into())\n                } else {\n                    Some(\"Check SSH configuration and network connectivity\".into())\n                };\n                \n                DiagnosticCheck {\n                    name: \"SSH Connectivity\".into(),\n                    status: CheckStatus::Fail,\n                    message: stderr.trim().to_string(),\n                    remediation,\n                }\n            }\n            Err(e) =\u003e DiagnosticCheck {\n                name: \"SSH Connectivity\".into(),\n                status: CheckStatus::Fail,\n                message: format!(\"Failed to run ssh: {}\", e),\n                remediation: Some(\"Ensure SSH client is installed\".into()),\n            },\n        }\n    }\n}\n```\n\n### Output Format\n```\nChecking source: laptop\n\n  ✓ SSH Connectivity\n    Connected to user@laptop.local successfully\n\n  ✓ rsync Available\n    rsync version 3.2.7 found on remote\n\n  ✓ Remote Path: ~/.claude/projects\n    Path exists, 47 sessions found\n\n  ⚠ Remote Path: ~/.cursor/projects\n    Path exists but is empty\n    Hint: No Cursor sessions on this machine yet\n\n  ✗ Remote Path: ~/.config/goose\n    Path does not exist\n    Hint: Remove this path or install Goose on remote\n\n  ✓ Local Storage\n    ~/.local/share/cass/remotes/laptop/ is writable\n\n  ✓ Last Sync\n    Last synced 2 hours ago, 47 sessions\n\nSummary: 5 passed, 1 warning, 1 failed\n```\n\n## Dependencies\n- Requires P5.1 (config types)\n- Requires P5.3 (sync status tracking)\n\n## Acceptance Criteria\n- [ ] All diagnostic checks implemented\n- [ ] Clear pass/warn/fail indicators\n- [ ] Actionable remediation hints\n- [ ] Summary at end\n- [ ] `--fix` attempts auto-remediation where possible","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:07:56.970763-05:00","updated_at":"2025-12-16T01:07:56.970763-05:00","dependencies":[{"issue_id":"coding_agent_session_search-p9t","depends_on_id":"coding_agent_session_search-luj","type":"blocks","created_at":"2025-12-16T01:09:18.525643-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-pkw","title":"P1.4 Add provenance fields to Tantivy schema","description":"# P1.4 Add provenance fields to Tantivy schema\n\n## Overview\nExtend the Tantivy search index schema to include provenance fields,\nenabling efficient filtering by source.\n\n## Implementation Details\n\n### Schema Extension\nIn `src/search/tantivy.rs`:\n```rust\nfn build_schema() -\u003e Schema {\n    let mut schema_builder = Schema::builder();\n    \n    // ... existing fields\n    \n    // Provenance fields\n    schema_builder.add_text_field(\"source_id\", STRING | STORED);\n    schema_builder.add_text_field(\"origin_kind\", STRING | STORED);  // \"local\" | \"ssh\"\n    schema_builder.add_text_field(\"origin_host\", STRING | STORED);  // nullable display label\n    \n    // Optional: workspace_original for path rewriting audit\n    schema_builder.add_text_field(\"workspace_original\", STORED);  // Not indexed, just stored\n    \n    schema_builder.build()\n}\n```\n\n### IMPORTANT: Schema Version Bump\nTo enable safe rollback and debugging, bump the Tantivy index directory version:\n\n```rust\n// Current: index stored in \u003cdata_dir\u003e/tantivy_v1/\n// New: index stored in \u003cdata_dir\u003e/tantivy_v2/\npub const TANTIVY_INDEX_VERSION: \u0026str = \"tantivy_v2\";\n\npub fn index_dir(data_dir: \u0026Path) -\u003e PathBuf {\n    data_dir.join(TANTIVY_INDEX_VERSION)\n}\n```\n\nAlso bump SCHEMA_HASH:\n```rust\npub const SCHEMA_HASH: \u0026str = \"v2_with_provenance\";\n```\n\nThis allows:\n- Old v1 index remains for rollback if needed\n- Users can downgrade without data loss\n- Clear signal that schema changed\n\n### Document Building\nWhen adding documents:\n```rust\nfn build_doc(\u0026self, conv: \u0026NormalizedConversation, msg: \u0026NormalizedMessage) -\u003e Document {\n    let mut doc = Document::new();\n    \n    // ... existing fields\n    \n    // Provenance\n    if let Some(origin) = \u0026conv.origin {\n        doc.add_text(self.source_id_field, \u0026origin.source_id);\n        doc.add_text(self.origin_kind_field, origin.kind.as_str());\n        if let Some(host) = \u0026origin.host {\n            doc.add_text(self.origin_host_field, host);\n        }\n    } else {\n        // Legacy data defaults to local\n        doc.add_text(self.source_id_field, LOCAL_SOURCE_ID);\n        doc.add_text(self.origin_kind_field, \"local\");\n    }\n    \n    doc\n}\n```\n\n### Query Filtering\n```rust\nfn build_source_filter_query(\u0026self, filter: \u0026SourceFilter) -\u003e Box\u003cdyn Query\u003e {\n    match filter {\n        SourceFilter::All =\u003e Box::new(AllQuery),\n        SourceFilter::Local =\u003e {\n            let term = Term::from_field_text(self.origin_kind_field, \"local\");\n            Box::new(TermQuery::new(term, IndexRecordOption::Basic))\n        }\n        SourceFilter::Remote =\u003e {\n            // Match anything that's NOT local\n            let local_term = Term::from_field_text(self.origin_kind_field, \"local\");\n            Box::new(BooleanQuery::new(vec![\n                (Occur::MustNot, Box::new(TermQuery::new(local_term, IndexRecordOption::Basic))),\n            ]))\n        }\n        SourceFilter::Hostname(h) =\u003e {\n            let term = Term::from_field_text(self.source_id_field, h);\n            Box::new(TermQuery::new(term, IndexRecordOption::Basic))\n        }\n    }\n}\n```\n\n## Dependencies\n- Requires P1.1 (Origin type defined)\n- Blocks multiple Phase 3 tasks\n\n## Acceptance Criteria\n- [ ] New fields added to Tantivy schema\n- [ ] SCHEMA_HASH bumped to force rebuild\n- [ ] Index directory version bumped (tantivy_v2)\n- [ ] Old index preserved for rollback\n- [ ] Documents populated with provenance\n- [ ] Source filter queries work correctly\n- [ ] Legacy data handled (defaults to local)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T00:55:14.933081-05:00","updated_at":"2025-12-16T03:10:28.828969-05:00","closed_at":"2025-12-16T03:10:28.828969-05:00","close_reason":"Added source_id, origin_kind, origin_host fields to Tantivy schema (v5). Updated SCHEMA_HASH to trigger index rebuild. All 374 tests passing.","dependencies":[{"issue_id":"coding_agent_session_search-pkw","depends_on_id":"coding_agent_session_search-2w4","type":"blocks","created_at":"2025-12-16T00:56:19.059226-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-pmb","title":"P6 Find-in-detail","description":"In-detail search with /, n/N, highlights; tests.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:58:43.675117816Z","updated_at":"2025-12-02T00:06:18.809118-05:00","closed_at":"2025-12-02T00:06:18.809118-05:00","dependencies":[{"issue_id":"coding_agent_session_search-pmb","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T13:59:03.172610256Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-pmb.1","title":"B6.1 Detail search mode","description":"/ enters local find; n/N jump; highlights; Esc exits; status shows match X/N.","notes":"Detail find implemented in src/ui/tui.rs: / to open detail find, n/N to navigate, highlights across tabs; help/legend updated; fmt+check+clippy clean","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:58:46.613771146Z","updated_at":"2025-12-01T19:26:37.76529474Z","closed_at":"2025-12-01T19:26:37.76529474Z"}
{"id":"coding_agent_session_search-pmb.2","title":"B6.2 Detail search tests","description":"Unit/UI tests for in-detail highlighting.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:58:56.394797444Z","updated_at":"2025-12-02T00:05:50.206023-05:00","closed_at":"2025-12-02T00:05:50.206023-05:00","dependencies":[{"issue_id":"coding_agent_session_search-pmb.2","depends_on_id":"coding_agent_session_search-pmb.1","type":"blocks","created_at":"2025-11-24T13:59:00.113057449Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-pub","title":"P4.4 Keyboard shortcuts for source filtering","description":"# P4.4 Keyboard shortcuts for source filtering\n\n## Overview\nAdd keyboard shortcuts for quick source filter manipulation.\n\n## Keybinding: F11 for Source Filter\nFollowing the existing F-key pattern (F3/F4 for other filters), use F11 for source filtering:\n\n```rust\n// In key handling\nKeyCode::F(11) =\u003e {\n    // F11: Cycle source filter\n    self.cycle_source_filter();\n}\n```\n\nThis aligns with the document's suggestion to maintain F-key consistency.\n\n### Filter Cycling Logic\n```rust\nfn cycle_source_filter(\u0026mut self) {\n    self.source_filter = match \u0026self.source_filter {\n        SourceFilter::All =\u003e SourceFilter::Local,\n        SourceFilter::Local =\u003e SourceFilter::Remote,\n        SourceFilter::Remote =\u003e {\n            if let Some(first_host) = self.available_sources.first() {\n                SourceFilter::Hostname(first_host.clone())\n            } else {\n                SourceFilter::All\n            }\n        }\n        SourceFilter::Hostname(current) =\u003e {\n            let idx = self.available_sources.iter()\n                .position(|h| h == current)\n                .map(|i| i + 1)\n                .unwrap_or(0);\n            if idx \u003c self.available_sources.len() {\n                SourceFilter::Hostname(self.available_sources[idx].clone())\n            } else {\n                SourceFilter::All\n            }\n        }\n    };\n    self.apply_source_filter();\n}\n```\n\n### Alternative: Shift+F11 for Source Menu\n```rust\nKeyCode::F(11) if modifiers.contains(KeyModifiers::SHIFT) =\u003e {\n    // Shift+F11: Open source filter menu/popup\n    self.open_source_filter_menu();\n}\n```\n\n### Help Text Update\nAdd to help/keybinding display:\n```\nF11        Cycle source filter (All → Local → Remote → [sources])\nShift+F11  Open source filter menu\n```\n\n## Dependencies\n- Requires P4.3 (filter state and UI exist)\n\n## Acceptance Criteria\n- [ ] F11 cycles through source filters\n- [ ] Shift+F11 opens filter menu (optional)\n- [ ] Shortcuts documented in help (F1)\n- [ ] No conflicts with existing keybindings\n- [ ] Consistent with F-key pattern","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T01:05:00.122446-05:00","updated_at":"2025-12-16T01:25:59.969573-05:00","dependencies":[{"issue_id":"coding_agent_session_search-pub","depends_on_id":"coding_agent_session_search-den","type":"blocks","created_at":"2025-12-16T01:07:17.728746-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-q2a","title":"P3.7 Add --source flag to stats command","description":"# P3.7 Add --source flag to stats command\n\n## Overview\nExtend `cass stats` to optionally group statistics by source, and add\n--source filter to show stats for specific sources.\n\n## Implementation Details\n\n### CLI Definition\n```rust\n#[derive(Parser)]\npub struct StatsArgs {\n    /// Show stats for specific source(s)\n    #[arg(long, short)]\n    source: Option\u003cVec\u003cString\u003e\u003e,\n    \n    /// Group stats by source\n    #[arg(long)]\n    by_source: bool,\n    \n    /// Output format\n    #[arg(long, default_value = \"table\")]\n    format: OutputFormat,\n}\n```\n\n### Default Output (unchanged for backward compat)\n```\nCASS Statistics\n\nConversations:  1,247\nMessages:       45,892\nAgents:         5 (claude-code, cursor, aider, ...)\nWorkspaces:     23\nIndex Size:     127 MB\nLast Indexed:   2024-01-15 10:30\n```\n\n### --by-source Output\n```\nCASS Statistics by Source\n\nSource          Convs    Messages   Last Sync\n──────────────────────────────────────────────\nlocal           1,024    38,421     -\nwork-laptop       156     5,891     2024-01-15 08:00\nhome-server        67     1,580     2024-01-14 22:30\n──────────────────────────────────────────────\nTOTAL           1,247    45,892\n```\n\n### --source=\u003cid\u003e Output\n```\nCASS Statistics for 'work-laptop'\n\nConversations:  156\nMessages:       5,891\nAgents:         3 (claude-code, cursor, aider)\nWorkspaces:     8\nLast Sync:      2024-01-15 08:00\nSync Status:    ✓ up to date\n```\n\n### SQL Queries\n```sql\n-- Total by source\nSELECT s.id as source_id, \n       COUNT(DISTINCT c.id) as conversations,\n       COUNT(m.id) as messages\nFROM conversations c\nJOIN sources s ON c.source_id = s.id\nLEFT JOIN messages m ON m.conversation_id = c.id\nGROUP BY s.id;\n\n-- Filtered by source\nSELECT COUNT(*) FROM conversations WHERE source_id = ?;\n```\n\n### Robot Output\n```json\n{\n  \"total_conversations\": 1247,\n  \"total_messages\": 45892,\n  \"by_source\": [\n    {\"source_id\": \"local\", \"conversations\": 1024, \"messages\": 38421},\n    {\"source_id\": \"work-laptop\", \"conversations\": 156, \"messages\": 5891}\n  ]\n}\n```\n\n## Dependencies\n- Requires P1.2 (sources table exists)\n- Requires P1.3 (conversations.source_id exists)\n\n## Acceptance Criteria\n- [ ] `cass stats` unchanged for backward compat\n- [ ] `cass stats --by-source` shows breakdown\n- [ ] `cass stats --source=work-laptop` shows specific source\n- [ ] Robot output includes source breakdown\n- [ ] Stats accurate after sync","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:28:14.261833-05:00","updated_at":"2025-12-16T13:03:56.602842-05:00","closed_at":"2025-12-16T13:03:56.602842-05:00","close_reason":"Added --source filter and --by-source breakdown to stats command. SQL queries filter by source_id. JSON and plain text output updated with source breakdown.","dependencies":[{"issue_id":"coding_agent_session_search-q2a","depends_on_id":"coding_agent_session_search-115","type":"blocks","created_at":"2025-12-16T01:28:34.08375-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-rob","title":"Agent-First CLI Epic: Making cass Irresistible for AI Agents","description":"# Agent-First CLI Epic\n\n## Vision\nTransform `cass` from a good CLI tool into an **exceptional tool for AI agents**. The goal is to make `cass` the gold standard for how CLI tools should be designed for AI consumption.\n\n## Background \u0026 Motivation\nAI agents (Claude, GPT-4, Codex, etc.) are increasingly being used to automate software development workflows. These agents interact with CLI tools through subprocess execution, parsing stdout/stderr. However, most CLI tools were designed for human users, creating friction:\n\n1. **Context Window Bloat**: AI agents have limited context windows (4K-200K tokens). A single search returning 10 results with full content can be 50KB+ of text, consuming precious context.\n\n2. **Parsing Uncertainty**: Agents need predictable, machine-readable output. Mixed log messages, inconsistent schemas, and undocumented fields cause parsing failures.\n\n3. **State Blindness**: Agents don't know if the index is stale, if they should retry, or what the system state is.\n\n4. **Workflow Friction**: Multi-step workflows (search → analyze → refine) require verbose command sequences.\n\n## Design Principles\n1. **Context-Efficient by Default**: Every byte of output should earn its place\n2. **Self-Documenting**: The CLI should explain itself completely\n3. **Predictable**: Same inputs → same outputs, documented contracts\n4. **Composable**: Easy to chain operations in workflows\n5. **Fail-Informative**: Errors include actionable recovery information\n\n## Success Metrics\n- 10x reduction in average response size with field selection\n- Zero log pollution in robot mode outputs\n- 100% schema coverage in introspection\n- Sub-second status checks\n\n## Structure\n- rob.ctx: Context Window Management (CRITICAL)\n- rob.query: Query Intelligence\n- rob.state: State Awareness\n- rob.flow: Workflow Optimization\n- rob.api: API Contract Clarity\n- rob.safe: Reliability \u0026 Safety\n\n## Dependencies\nThis epic builds on the existing robot mode infrastructure (--json, --robot, robot-docs). No external dependencies.","status":"open","priority":1,"issue_type":"task","created_at":"2025-11-30T23:54:08.394848663Z","updated_at":"2025-11-30T23:54:08.394848663Z"}
{"id":"coding_agent_session_search-rob.api","title":"API Contract Clarity: Predictable, Documented Behavior","description":"# API Contract Clarity\n\n## The Problem\nAgents need **certainty** about API behavior:\n- What fields will always be present?\n- What types are returned?\n- What features are available?\n- Will the API change?\n\nCurrent documentation is informal and incomplete.\n\n## The Solution\nMake the API **self-documenting** and **introspectable**:\n1. Full schema introspection command\n2. Capabilities discovery\n3. Version negotiation\n\n## Subtasks\n1. **rob.api.intro** - Full schema introspection\n2. **rob.api.caps** - Capabilities endpoint\n3. **rob.api.version** - API versioning\n\n## Value for Agents\n- Confidence: Know exactly what to expect\n- Adaptation: Discover available features\n- Stability: Understand version compatibility","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.420280752Z","updated_at":"2025-12-02T00:04:23.937275-05:00","closed_at":"2025-12-02T00:04:23.937275-05:00"}
{"id":"coding_agent_session_search-rob.api.caps","title":"Capabilities Endpoint (cass capabilities)","description":"# Capabilities Endpoint (cass capabilities)\n\n## Problem Statement\nAgents need to know what features are available:\n- Does this version support --fields?\n- Is aggregation available?\n- What connectors are supported?\n\n## Proposed Solution\nAdd `cass capabilities` command:\n```bash\ncass capabilities --json\n```\n\nOutput:\n```json\n{\n  \"crate_version\": \"0.1.30\",\n  \"api_version\": 1,\n  \"contract_version\": \"1\",\n  \"features\": [\n    \"json_output\",\n    \"jsonl_output\",\n    \"robot_meta\",\n    \"time_filters\",\n    \"field_selection\",\n    \"aggregations\",\n    \"cursor_pagination\"\n  ],\n  \"connectors\": [\n    \"codex\", \"claude_code\", \"gemini\", \"opencode\", \"amp\", \"cline\"\n  ],\n  \"limits\": {\n    \"max_limit\": 1000,\n    \"max_content_length\": 100000,\n    \"max_fields\": 20\n  },\n  \"documentation_url\": \"https://github.com/...\"\n}\n```\n\n## Design Decisions\n\n### Feature Flags\nList individual features so agents can check availability:\n```python\nif \"field_selection\" in capabilities[\"features\"]:\n    cmd += \" --fields source_path,line_number\"\n```\n\n### Version Numbers\n- `crate_version`: Semantic version of the binary\n- `api_version`: Integer version of the API contract (bump on breaking changes)\n- `contract_version`: Existing robot-docs contract version\n\n### Limits\nExpose operational limits so agents don't exceed them.\n\n## Acceptance Criteria\n- [ ] `cass capabilities --json` returns feature list\n- [ ] Features list accurately reflects available functionality\n- [ ] Version numbers included\n- [ ] Limits documented\n- [ ] Human-readable output without --json\n\n## Effort Estimate\nLow - 1-2 hours. Static information assembly.","status":"closed","priority":2,"issue_type":"task","assignee":"BlackPond","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:06:40.388743-05:00","closed_at":"2025-12-02T00:06:40.388743-05:00"}
{"id":"coding_agent_session_search-rob.api.intro","title":"Full Schema Introspection (cass introspect)","description":"# Full Schema Introspection (cass introspect)\n\n## Problem Statement\nAgents need complete API documentation in machine-readable form:\n- What commands are available?\n- What arguments does each take?\n- What does the response look like?\n\nCurrently requires parsing help text or robot-docs.\n\n## Proposed Solution\nAdd `cass introspect` command returning full API schema:\n```bash\ncass introspect --json\n```\n\nOutput:\n```json\n{\n  \"api_version\": \"1.1\",\n  \"crate_version\": \"0.1.30\",\n  \"commands\": {\n    \"search\": {\n      \"description\": \"Run a one-off search and print results\",\n      \"arguments\": {\n        \"query\": {\n          \"type\": \"string\",\n          \"required\": true,\n          \"description\": \"The search query\"\n        }\n      },\n      \"flags\": {\n        \"--limit\": {\n          \"type\": \"integer\",\n          \"default\": 10,\n          \"description\": \"Max results\"\n        },\n        \"--json\": {\n          \"type\": \"boolean\",\n          \"default\": false,\n          \"description\": \"Output as JSON\"\n        }\n        // ... all flags\n      },\n      \"response_schema\": {\n        \"type\": \"object\",\n        \"properties\": {\n          \"count\": {\"type\": \"integer\"},\n          \"hits\": {\n            \"type\": \"array\",\n            \"items\": {\n              \"type\": \"object\",\n              \"properties\": {\n                \"score\": {\"type\": \"number\"},\n                \"agent\": {\"type\": \"string\"},\n                // ... all hit fields\n              },\n              \"required\": [\"score\", \"agent\", \"source_path\"]\n            }\n          }\n        },\n        \"required\": [\"count\", \"hits\"]\n      }\n    }\n    // ... all commands\n  }\n}\n```\n\n## Design Decisions\n\n### Schema Format\nUse JSON Schema subset for response schemas. Familiar to developers and tools.\n\n### Generation\nGenerate schema from Clap annotations + custom response type definitions. Could use serde reflection.\n\n### Scope\nInclude all public commands and their complete signatures.\n\n## Acceptance Criteria\n- [ ] `cass introspect --json` returns full API schema\n- [ ] All commands included with arguments and flags\n- [ ] Response schemas for JSON outputs\n- [ ] Required vs optional fields indicated\n- [ ] Types accurate (string, integer, boolean, array, object)\n\n## Effort Estimate\nMedium-High - 4-6 hours. Requires schema generation from Clap + custom response types.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T21:32:47.83967-05:00","closed_at":"2025-12-01T21:32:47.83967-05:00"}
{"id":"coding_agent_session_search-rob.api.version","title":"API Versioning Strategy","description":"# API Versioning Strategy\n\n## Problem Statement\nAs the CLI evolves, agents need to understand compatibility:\n- Will my scripts break with the next update?\n- How do I handle version differences?\n- When are breaking changes introduced?\n\n## Proposed Solution\nFormalize versioning strategy:\n\n### API Version Number\nSimple integer that increments on breaking changes:\n- v1: Current stable API\n- v2: Future breaking changes\n\n### Compatibility Promise\n- Minor/patch releases: No breaking changes to JSON output\n- New fields may be added (additive changes OK)\n- Field removal or type changes require version bump\n\n### Version Negotiation\n```bash\ncass search \"query\" --json --api-version 1\n# If api-version is incompatible, return error with supported versions\n```\n\n### Deprecation Warnings\nWhen using deprecated features:\n```json\n{\n  \"_warnings\": [\"--robot flag is deprecated; use --json instead\"],\n  \"hits\": [...]\n}\n```\n\n## Documentation\nAdd CHANGELOG section specifically for API changes:\n- Breaking changes clearly marked\n- Migration guides for version transitions\n\n## Acceptance Criteria\n- [ ] api_version number in capabilities output\n- [ ] Deprecation warnings in JSON output\n- [ ] CHANGELOG tracks API changes\n- [ ] `--api-version` flag for version negotiation (optional)\n\n## Effort Estimate\nLow - 1-2 hours. Mostly documentation and version tracking.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:18:34.760935-05:00","closed_at":"2025-12-02T00:18:34.760935-05:00"}
{"id":"coding_agent_session_search-rob.ctx","title":"Context Window Management: Minimizing Token Consumption","description":"# Context Window Management\n\n## The Problem\nAI agents have **limited context windows**. Every token matters. Current search output includes:\n- Full message content (often 1000+ chars per hit)\n- Verbose snippets with markdown formatting\n- Fields the agent may not need (workspace, title when empty)\n\nA typical 10-result search can produce 50KB of JSON. An agent working on a complex task might need to run 5-10 searches, quickly consuming 500KB of context just for search results.\n\n## The Solution\nGive agents **precise control** over what fields are returned and how much content is included.\n\n## Impact Analysis\n| Scenario | Current Size | With Optimization | Reduction |\n|----------|-------------|-------------------|----------|\n| 10 hits, full content | ~50KB | ~2KB (paths only) | 96% |\n| 10 hits, truncated | ~50KB | ~5KB (200 char limit) | 90% |\n| 20 hits, aggregated | ~100KB | ~1KB (counts only) | 99% |\n\n## Subtasks\n1. **rob.ctx.fields** - Field selection (--fields) - HIGHEST PRIORITY\n2. **rob.ctx.trunc** - Content truncation (--max-content-length)\n3. **rob.ctx.tokens** - Token budget (--max-tokens)\n4. **rob.ctx.quiet** - Auto-quiet in robot mode\n\n## Implementation Order\n1. Auto-quiet (trivial, immediate value)\n2. Field selection (high impact, moderate effort)\n3. Content truncation (high impact, low effort)\n4. Token budget (medium impact, higher effort)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T23:54:08.420280752Z","updated_at":"2025-12-01T19:45:49.954936156Z","closed_at":"2025-12-01T19:45:49.954936156Z"}
{"id":"coding_agent_session_search-rob.ctx.fields","title":"Field Selection (--fields flag)","description":"# Field Selection (--fields flag)\n\n## Problem Statement\nCurrent search output includes ALL fields for every hit:\n```json\n{\"score\": 4.2, \"agent\": \"claude_code\", \"workspace\": \"/long/path\", \n \"source_path\": \"/very/long/path/to/session.jsonl\", \"snippet\": \"...\",\n \"content\": \"\u003cpotentially 10KB of text\u003e\", \"title\": \"...\", \n \"created_at\": 1234567890, \"line_number\": 42, \"match_type\": \"exact\"}\n```\n\nOften an agent only needs 2-3 fields:\n- Just paths and line numbers to open files\n- Just scores to rank results\n- Just agents to understand distribution\n\n## Proposed Solution\nAdd `--fields` flag to select specific fields:\n```bash\ncass search \"error\" --json --fields source_path,line_number,score\n```\n\nOutput:\n```json\n{\"count\": 10, \"hits\": [\n  {\"source_path\": \"/path/to/file.jsonl\", \"line_number\": 42, \"score\": 4.2},\n  ...\n]}\n```\n\n## Design Decisions\n\n### Field Naming\nUse exact field names from current schema:\n- `score`, `agent`, `workspace`, `source_path`, `snippet`, `content`, `title`, `created_at`, `line_number`, `match_type`\n\n### Special Fields\n- `*` or `all` - include all fields (default behavior)\n- `minimal` - shorthand for `source_path,line_number,agent`\n- `summary` - shorthand for `source_path,line_number,agent,title,score`\n\n### Metadata Fields\nTop-level fields (`count`, `limit`, `offset`, `query`) always included. `--fields` only affects `hits` array contents.\n\n### Invalid Fields\nUnknown field names produce a warning on stderr but don't fail the command (graceful degradation).\n\n## Implementation Approach\n\n```rust\n// In search command args:\n#[arg(long, value_delimiter = ',')]\nfields: Option\u003cVec\u003cString\u003e\u003e,\n\n// In output_robot_results():\nfn filter_hit_fields(hit: \u0026SearchHit, fields: \u0026Option\u003cVec\u003cString\u003e\u003e) -\u003e serde_json::Value {\n    let all_fields = serde_json::to_value(hit).unwrap();\n    match fields {\n        None =\u003e all_fields,\n        Some(field_list) =\u003e {\n            let mut filtered = serde_json::Map::new();\n            for field in field_list {\n                if let Some(value) = all_fields.get(field) {\n                    filtered.insert(field.clone(), value.clone());\n                }\n            }\n            serde_json::Value::Object(filtered)\n        }\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] `--fields source_path` returns only source_path in each hit\n- [ ] `--fields source_path,line_number,score` returns exactly those 3 fields\n- [ ] `--fields minimal` expands to predefined set\n- [ ] `--fields summary` expands to predefined set\n- [ ] Unknown fields logged as warning, don't fail command\n- [ ] Works with all robot formats (json, jsonl, compact)\n- [ ] Update robot-docs schemas to document --fields\n- [ ] Add tests for field filtering\n\n## Context Savings Estimate\n| Fields Requested | Typical Hit Size | Reduction |\n|-----------------|------------------|----------|\n| All (default) | ~5KB | 0% |\n| source_path,line_number | ~200 bytes | 96% |\n| summary preset | ~500 bytes | 90% |\n\n## Effort Estimate\nMedium - 2-3 hours. Requires:\n- CLI arg parsing\n- Field filtering logic\n- Preset expansion\n- Tests\n- Documentation updates","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T00:35:28.953198777Z","closed_at":"2025-12-01T00:35:28.953198777Z"}
{"id":"coding_agent_session_search-rob.ctx.quiet","title":"Auto-Quiet in Robot Mode","description":"# Auto-Quiet in Robot Mode\n\n## Problem Statement\nWhen using `--json` or `--robot` flags, INFO log messages still appear on stderr:\n```\n2025-11-30T23:24:37.912929Z  INFO search_start backend=\"sqlite\" query=\"hello\"\n{\"count\": 2, \"hits\": [...]}\n```\n\nWhile logs go to stderr (correct), many subprocess libraries combine stdout+stderr by default. This means agents using common patterns like Python's `subprocess.run(capture_output=True)` or Node's `execSync` will see logs mixed with JSON.\n\n## Current Workaround\nAgents must remember to add `--quiet` flag:\n```bash\ncass --quiet search \"query\" --json\n```\n\nThis is an unnecessary tax on every robot invocation.\n\n## Proposed Solution\nWhen `--json`, `--robot`, or `--robot-format` is specified, automatically suppress INFO-level logs (equivalent to `--quiet`). Only WARN and ERROR logs should appear on stderr in robot mode.\n\n## Implementation\n```rust\n// In lib.rs, after parsing CLI args:\nlet effective_quiet = cli.quiet || is_robot_mode(\u0026command);\n\nfn is_robot_mode(cmd: \u0026Commands) -\u003e bool {\n    match cmd {\n        Commands::Search { json, robot_format, .. } =\u003e *json || robot_format.is_some(),\n        Commands::Stats { json, .. } =\u003e *json,\n        Commands::Diag { json, .. } =\u003e *json,\n        Commands::Index { json, .. } =\u003e *json,\n        Commands::View { json, .. } =\u003e *json,\n        _ =\u003e false,\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] `cass search \"q\" --json 2\u003e\u00261` produces clean JSON with no log lines\n- [ ] `cass search \"q\" --robot-format jsonl 2\u003e\u00261` produces clean JSONL\n- [ ] WARN/ERROR logs still appear on stderr (for debugging)\n- [ ] Explicit `--verbose` overrides auto-quiet\n- [ ] Update robot-docs contracts to reflect new behavior\n- [ ] Add test: `robot_mode_suppresses_info_logs`\n\n## Effort Estimate\nTrivial - 30 minutes. Change is ~10 lines of code.\n\n## Risk Assessment\nLow risk. This is purely additive behavior that matches user expectations.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T00:27:50.63525328Z","closed_at":"2025-12-01T00:27:50.63525328Z"}
{"id":"coding_agent_session_search-rob.ctx.tokens","title":"Token Budget (--max-tokens)","description":"# Token Budget (--max-tokens)\n\n## Problem Statement\nAgents have specific token budgets for tool outputs. Rather than guessing how many results to request or what content length to use, agents should be able to say \"give me as much as fits in N tokens.\"\n\n## Proposed Solution\nAdd `--max-tokens N` flag for intelligent output limiting:\n```bash\ncass search \"error\" --json --max-tokens 2000\n```\n\nOutput:\n```json\n{\n  \"count\": 47,\n  \"returned\": 12,\n  \"truncated\": true,\n  \"token_estimate\": 1987,\n  \"hits\": [...]\n}\n```\n\n## Design Decisions\n\n### Token Estimation\nUse simple heuristic: ~4 characters per token (conservative for English text with JSON overhead). Could use tiktoken for accuracy but adds dependency.\n\n### Truncation Strategy\n1. Start with all requested hits\n2. Estimate total tokens\n3. If over budget, progressively:\n   a. Truncate content fields\n   b. Reduce number of hits\n   c. Remove optional fields\n\n### Metadata Preservation\nAlways include: count, returned, truncated, token_estimate. These don't count against budget.\n\n## Implementation Complexity\nThis is more complex than simple field selection because it requires:\n- Token estimation logic\n- Iterative trimming strategy\n- Priority ordering of what to cut\n\n## Acceptance Criteria\n- [ ] `--max-tokens 1000` produces output estimating \u003c1000 tokens\n- [ ] `truncated: true` when output was limited\n- [ ] `returned` field shows actual hits returned vs total matches\n- [ ] `token_estimate` field shows estimated tokens in response\n- [ ] Graceful degradation (fewer hits rather than error)\n\n## Effort Estimate\nMedium-High - 4-6 hours. Requires token estimation and iterative trimming logic.\n\n## Alternative Considered\nCould use external tokenizer (tiktoken) for accuracy, but:\n- Adds Python dependency or Rust port\n- Simple heuristic is good enough for budgeting\n- Can refine estimation later if needed","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T19:45:32.479109694Z","closed_at":"2025-12-01T19:45:32.479109694Z"}
{"id":"coding_agent_session_search-rob.ctx.trunc","title":"Content Truncation (--max-content-length)","description":"# Content Truncation (--max-content-length)\n\n## Problem Statement\nThe `content` and `snippet` fields can contain very long text (10KB+ for detailed conversations). Even when an agent wants content, they often only need the first few hundred characters to understand context.\n\n## Proposed Solution\nAdd `--max-content-length N` flag to truncate text fields:\n```bash\ncass search \"error\" --json --max-content-length 200\n```\n\nOutput:\n```json\n{\"content\": \"First 200 chars of content...\", \"content_truncated\": true, ...}\n```\n\n## Design Decisions\n\n### Which Fields Are Affected\n- `content` - main message content\n- `snippet` - highlighted excerpt\n- `title` - usually short, but truncate if needed\n\n### Truncation Indicator\nAdd `_truncated` suffix field when content is truncated:\n```json\n{\"content\": \"truncated...\", \"content_truncated\": true}\n```\n\n### UTF-8 Safety\nTruncate at character boundaries, not byte boundaries. Ensure valid UTF-8 output.\n\n### Ellipsis\nAppend `...` when truncating to indicate incompleteness.\n\n## Implementation\n```rust\nfn truncate_content(s: \u0026str, max_len: usize) -\u003e (String, bool) {\n    if s.chars().count() \u003c= max_len {\n        (s.to_string(), false)\n    } else {\n        let truncated: String = s.chars().take(max_len.saturating_sub(3)).collect();\n        (format!(\"{}...\", truncated), true)\n    }\n}\n```\n\n## Acceptance Criteria\n- [ ] `--max-content-length 100` truncates content to ~100 chars\n- [ ] Truncated fields have `_truncated: true` sibling field\n- [ ] UTF-8 boundaries respected (no broken characters)\n- [ ] Works with `--fields` (truncation applied to selected fields)\n- [ ] Ellipsis appended to truncated content\n- [ ] Test: various Unicode content truncation\n\n## Effort Estimate\nLow - 1-2 hours. Simple string truncation with UTF-8 awareness.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T01:45:55.590679447Z","closed_at":"2025-12-01T01:45:55.590679447Z"}
{"id":"coding_agent_session_search-rob.doc","title":"Documentation: Robot Mode Guide","description":"# Documentation: Robot Mode Guide\n\n## Problem Statement\nAll the new features need comprehensive documentation:\n- How to use each feature\n- Best practices for AI agents\n- Complete examples\n- Migration from older versions\n\n## Proposed Solution\nCreate `docs/ROBOT_MODE.md` with:\n\n1. **Quick Start for AI Agents**\n   - TL;DR commands\n   - Common patterns\n\n2. **Feature Reference**\n   - Each flag with examples\n   - JSON schemas\n   - Error handling\n\n3. **Best Practices**\n   - Context window optimization\n   - Retry strategies\n   - Workflow patterns\n\n4. **Integration Examples**\n   - Python subprocess\n   - Node.js child_process\n   - Shell scripting\n\n## Acceptance Criteria\n- [ ] docs/ROBOT_MODE.md created\n- [ ] All robot features documented\n- [ ] Working examples for each feature\n- [ ] Integration examples in 3+ languages\n- [ ] robot-docs updated to reference guide\n\n## Effort Estimate\nMedium - 3-4 hours of documentation writing.","notes":"Added docs/ROBOT_MODE.md guide; README link; robot-docs topic Guide; robot-help updated; forgiving arg normalization already present; cli_robot tests expanded for normalization/help. fmt/clippy/tests pass.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.420280752Z","updated_at":"2025-12-01T23:47:48.419156-05:00","closed_at":"2025-12-01T23:47:48.419157-05:00"}
{"id":"coding_agent_session_search-rob.flow","title":"Workflow Optimization: Efficient Multi-Step Operations","description":"# Workflow Optimization\n\n## The Problem\nAgent workflows often follow patterns:\n1. Search for something\n2. Examine results\n3. Refine search or dig deeper\n4. Take action on findings\n\nCurrent CLI requires verbose command sequences with manual state management.\n\n## The Solution\nOptimize common workflow patterns:\n1. **Aggregations**: Get overview without full results\n2. **Context**: Find related sessions\n3. **Correlation**: Track multi-step operations\n4. **Pagination**: Reliable cursor-based navigation\n\n## Subtasks\n1. **rob.flow.agg** - Aggregation mode\n2. **rob.flow.context** - Session context command\n3. **rob.flow.reqid** - Request ID correlation\n4. **rob.flow.cursor** - Cursor-based pagination\n\n## Value for Agents\n- Efficiency: Get answers with fewer commands\n- Context: Understand relationships between results\n- Traceability: Track operations across steps","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.420280752Z","updated_at":"2025-12-02T00:04:35.392773-05:00","closed_at":"2025-12-02T00:04:35.392773-05:00"}
{"id":"coding_agent_session_search-rob.flow.agg","title":"Aggregation Mode (--aggregate)","description":"# Aggregation Mode (--aggregate)\n\n## Problem Statement\nAgents often want overview statistics without full results:\n- How many errors per agent?\n- What workspaces have the most activity?\n- What's the time distribution?\n\nCurrently requires fetching all results and aggregating client-side, wasting tokens.\n\n## Proposed Solution\nAdd `--aggregate` flag for server-side aggregation:\n```bash\ncass search \"error\" --json --aggregate agent,workspace\n```\n\nOutput:\n```json\n{\n  \"total_matches\": 147,\n  \"aggregations\": {\n    \"agent\": {\n      \"buckets\": [\n        {\"key\": \"claude_code\", \"count\": 89},\n        {\"key\": \"codex\", \"count\": 45},\n        {\"key\": \"gemini\", \"count\": 13}\n      ]\n    },\n    \"workspace\": {\n      \"buckets\": [\n        {\"key\": \"/project-a\", \"count\": 50},\n        {\"key\": \"/project-b\", \"count\": 40},\n        {\"key\": \"\u003cother\u003e\", \"count\": 57}\n      ]\n    }\n  },\n  \"hits\": []  // Empty when aggregating only\n}\n```\n\n## Design Decisions\n\n### Aggregatable Fields\n- `agent` - Group by agent type\n- `workspace` - Group by workspace path\n- `date` - Group by day/week/month\n- `match_type` - Group by exact/wildcard/fuzzy\n\n### Bucket Limits\nDefault to top 10 buckets per field. Use `\u003cother\u003e` for remainder.\n\n### Combining with Results\n- `--aggregate` alone: Only aggregations, no hits\n- `--aggregate` with `--limit N`: Both aggregations and N hits\n\n### Performance\nAggregations should be efficient:\n- Use SQL GROUP BY where possible\n- Cache aggregation results\n\n## Acceptance Criteria\n- [ ] `--aggregate agent` groups by agent\n- [ ] `--aggregate agent,workspace` groups by both\n- [ ] Aggregation-only mode returns empty hits array\n- [ ] Can combine with --limit for both aggs and hits\n- [ ] Top 10 buckets with \u003cother\u003e for overflow\n- [ ] Performance: \u003c200ms for aggregation queries\n\n## Context Savings\nAggregation response: ~500 bytes vs ~50KB for full results. **99% reduction!**\n\n## Effort Estimate\nMedium - 3-4 hours. Requires SQL GROUP BY queries and result formatting.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T02:32:17.986294545Z","closed_at":"2025-12-01T02:32:17.986294545Z"}
{"id":"coding_agent_session_search-rob.flow.context","title":"Session Context Command (cass context)","description":"# Session Context Command (cass context)\n\n## Problem Statement\nWhen an agent finds an interesting result, they often want:\n- Other sessions in the same workspace\n- Sessions from the same time period\n- Related conversations by topic\n\nCurrently requires multiple manual searches.\n\n## Proposed Solution\nAdd `cass context` command to find related sessions:\n```bash\ncass context /path/to/session.jsonl --json\n```\n\nOutput:\n```json\n{\n  \"source\": {\n    \"path\": \"/path/to/session.jsonl\",\n    \"agent\": \"claude_code\",\n    \"workspace\": \"/myproject\",\n    \"created_at\": \"2025-01-15T10:00:00Z\"\n  },\n  \"related\": {\n    \"same_workspace\": [\n      {\"path\": \"...\", \"title\": \"...\", \"created_at\": \"...\", \"relevance\": 0.9}\n    ],\n    \"same_day\": [...],\n    \"same_agent\": [...],\n    \"similar_content\": [...]  // If semantic search available\n  }\n}\n```\n\n## Design Decisions\n\n### Relation Types\n1. **same_workspace**: Sessions in same workspace directory\n2. **same_day**: Sessions within 24 hours\n3. **same_agent**: Sessions from same agent type\n4. **similar_content**: Content-based similarity (future)\n\n### Limits\nReturn top 5 per relation type by default. Configurable with `--limit`.\n\n### Input Flexibility\nAccept:\n- Full path to session file\n- Session ID from search results\n- Line number reference (source_path:line)\n\n## Acceptance Criteria\n- [ ] `cass context \u003cpath\u003e` finds related sessions\n- [ ] Returns same_workspace, same_day, same_agent relations\n- [ ] Relevance scores for ranking\n- [ ] Configurable limits per relation type\n- [ ] JSON output for automation\n\n## Effort Estimate\nMedium - 3-4 hours. Requires relational queries across session metadata.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:33:34.022144-05:00","closed_at":"2025-12-02T00:33:34.022144-05:00"}
{"id":"coding_agent_session_search-rob.flow.cursor","title":"Cursor-Based Pagination","description":"# Cursor-Based Pagination\n\n## Problem Statement\nOffset-based pagination (`--offset N`) has issues:\n- Results can shift if index changes between pages\n- Hard to track position reliably\n- Inefficient for large offsets\n\n## Proposed Solution\nAdd cursor-based pagination:\n```bash\ncass search \"error\" --json --limit 10\n# Returns: {\"next_cursor\": \"abc123\", \"hits\": [...]}\n\ncass search \"error\" --json --limit 10 --cursor \"abc123\"\n# Returns next page\n```\n\n## Design Decisions\n\n### Cursor Encoding\nCursor contains:\n- Query hash (to validate same query)\n- Last seen sort key (score + id)\n- Expiration timestamp\n\nEncoded as base64 for URL safety.\n\n### Cursor Expiration\nCursors expire after 1 hour to prevent stale state issues.\n\n### Fallback\nIf cursor is invalid/expired, return error with hint to restart.\n\n## Acceptance Criteria\n- [ ] `--cursor` parameter for continuing pagination\n- [ ] `next_cursor` in response when more results available\n- [ ] Cursor validates query hasn't changed\n- [ ] Expired cursors return clear error\n- [ ] Works with all output formats\n\n## Effort Estimate\nMedium - 3-4 hours. Requires cursor encoding and validation logic.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:04:40.516945-05:00","closed_at":"2025-12-02T00:04:40.516945-05:00"}
{"id":"coding_agent_session_search-rob.flow.reqid","title":"Request ID Correlation (--request-id)","description":"# Request ID Correlation (--request-id)\n\n## Problem Statement\nAgents run multi-step workflows:\n1. Search for errors\n2. Analyze top result\n3. Search for related fixes\n4. Compile summary\n\nTracking which response corresponds to which request is error-prone.\n\n## Proposed Solution\nAdd `--request-id` flag for correlation:\n```bash\ncass search \"error\" --json --request-id \"step-1-find-errors\"\n```\n\nOutput:\n```json\n{\n  \"request_id\": \"step-1-find-errors\",\n  \"count\": 10,\n  \"hits\": [...]\n}\n```\n\n## Design Decisions\n\n### ID Format\nAccept any string. Agent's responsibility to ensure uniqueness.\n\n### Trace Integration\nIf `--trace-file` is used, include request_id in trace entries for audit correlation.\n\n### No Server State\nRequest ID is purely for response labeling. No server-side tracking.\n\n## Acceptance Criteria\n- [ ] `--request-id \"foo\"` includes `request_id: \"foo\"` in response\n- [ ] Works with all output formats\n- [ ] Included in trace file entries\n- [ ] No validation on ID format (any string)\n\n## Effort Estimate\nTrivial - 30 minutes. Pass-through from CLI arg to response.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:04:45.645105-05:00","closed_at":"2025-12-02T00:04:45.645105-05:00"}
{"id":"coding_agent_session_search-rob.query","title":"Query Intelligence: Understanding and Improving Queries","description":"# Query Intelligence\n\n## The Problem\nAgents often struggle with queries:\n1. **Why did this return 0 results?** - Was the query malformed? Too specific?\n2. **How was my query interpreted?** - Did it understand my intent?\n3. **What would work better?** - Suggestions for improvement\n\n## The Solution\nMake the query engine transparent and helpful:\n- Explain how queries are parsed and executed\n- Suggest alternatives when queries fail\n- Allow dry-run validation\n\n## Subtasks\n1. **rob.query.explain** - Query explanation (--explain)\n2. **rob.query.suggest** - Suggestions and did-you-mean\n3. **rob.query.dry** - Dry-run mode (--dry-run)\n\n## Value for Agents\n- Self-correction: Agents can fix their own queries\n- Learning: Understand query syntax through examples\n- Confidence: Know when a query is reliable","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.420280752Z","updated_at":"2025-12-02T00:04:11.376139-05:00","closed_at":"2025-12-02T00:04:11.376139-05:00"}
{"id":"coding_agent_session_search-rob.query.dry","title":"Dry-Run Mode (--dry-run)","description":"# Dry-Run Mode (--dry-run)\n\n## Problem Statement\nAgents want to validate queries without executing them:\n- Is the syntax valid?\n- How will it be interpreted?\n- What would the cost be?\n\nCurrently, the only way to check is to run the query and examine results.\n\n## Proposed Solution\nAdd `--dry-run` flag that validates and analyzes without executing:\n```bash\ncass search \"complex query\" --dry-run --json\n```\n\nOutput:\n```json\n{\n  \"dry_run\": true,\n  \"valid\": true,\n  \"explanation\": {...},\n  \"estimated_results\": \"10-100\",\n  \"estimated_cost_ms\": \"\u003c50\",\n  \"warnings\": []\n}\n```\n\n## Design Decisions\n\n### What Dry-Run Does\n1. Parse the query (full validation)\n2. Analyze filters and constraints\n3. Estimate result count (if possible)\n4. Estimate execution time\n5. Return without actually searching\n\n### What Dry-Run Does NOT Do\n- Access the search index\n- Return actual results\n- Modify any state\n\n### Estimation Accuracy\nResult count estimation could use:\n- Index statistics (total documents, term frequencies)\n- Historical query patterns\n- Simple heuristics\n\nDon't over-engineer; rough estimates are valuable.\n\n## Acceptance Criteria\n- [ ] `--dry-run` returns without executing search\n- [ ] Invalid queries return `valid: false` with error details\n- [ ] Valid queries include explanation\n- [ ] Response time is \u003c10ms (no index access)\n- [ ] Works with all query types\n\n## Effort Estimate\nLow-Medium - 2-3 hours. Query parsing is already done; this skips execution.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:06:06.678765-05:00","closed_at":"2025-12-02T00:06:06.678765-05:00"}
{"id":"coding_agent_session_search-rob.query.explain","title":"Query Explanation (--explain flag)","description":"# Query Explanation (--explain flag)\n\n## Problem Statement\nAgents construct queries but have no visibility into how they're interpreted:\n- Is `error AND workspace:/myproject` parsed correctly?\n- Was wildcard fallback triggered?\n- Which index was used?\n\n## Proposed Solution\nAdd `--explain` flag that includes query analysis in output:\n```bash\ncass search \"error AND workspace:/project\" --json --explain\n```\n\nOutput:\n```json\n{\n  \"explanation\": {\n    \"original_query\": \"error AND workspace:/project\",\n    \"parsed\": {\n      \"terms\": [\"error\"],\n      \"operators\": [\"AND\"],\n      \"filters\": {\n        \"workspace\": \"/project\"\n      }\n    },\n    \"query_type\": \"boolean_with_filter\",\n    \"index_strategy\": \"tantivy_fts_then_sqlite_filter\",\n    \"wildcard_applied\": false,\n    \"estimated_cost\": \"low\",\n    \"warnings\": []\n  },\n  \"count\": 15,\n  \"hits\": [...]\n}\n```\n\n## Design Decisions\n\n### Explanation Fields\n- `original_query`: Exact input string\n- `parsed`: Structured breakdown of query components\n- `query_type`: Classification (simple, phrase, boolean, wildcard, filter)\n- `index_strategy`: How the query will be executed\n- `wildcard_applied`: Whether fallback wildcard was added\n- `estimated_cost`: Rough complexity indicator\n- `warnings`: Any issues or suggestions\n\n### Performance\n`--explain` should add minimal overhead. Query parsing is already done; this just exposes it.\n\n## Implementation Location\nQuery parsing logic is in `src/search/query.rs`. The explanation should be built during parsing and optionally included in output.\n\n## Acceptance Criteria\n- [ ] `--explain` adds explanation object to JSON output\n- [ ] Explanation accurately reflects query parsing\n- [ ] Works with all query types (simple, boolean, filter)\n- [ ] Wildcard fallback is clearly indicated\n- [ ] Warnings surfaced (e.g., unrecognized filter syntax)\n- [ ] Works with all output formats (json, jsonl, compact)\n\n## Effort Estimate\nMedium - 3-4 hours. Requires exposing internal query parsing state.","status":"closed","priority":2,"issue_type":"task","assignee":"PurpleHill","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T22:29:13.071946-05:00","closed_at":"2025-12-01T22:29:13.071948-05:00"}
{"id":"coding_agent_session_search-rob.query.suggest","title":"Query Suggestions (did-you-mean)","description":"# Query Suggestions (did-you-mean)\n\n## Problem Statement\nWhen a search returns 0 results, agents have no guidance on what to try next:\n- Was it a typo? (\"git comit\" → \"git commit\")\n- Too specific? (suggest removing terms)\n- Wrong field? (content vs title)\n\n## Proposed Solution\nAdd suggestions to empty/sparse result sets:\n```bash\ncass search \"git comit\" --json\n```\n\nOutput:\n```json\n{\n  \"count\": 0,\n  \"hits\": [],\n  \"suggestions\": {\n    \"did_you_mean\": [\"git commit\", \"git comment\"],\n    \"similar_terms\": [\"commit\", \"git\"],\n    \"try_broader\": [\"git\"],\n    \"popular_queries\": [\"git push\", \"git merge\"]\n  }\n}\n```\n\n## Design Decisions\n\n### When to Suggest\n- Always when count=0\n- Optionally when count \u003c threshold (sparse results)\n- Can be disabled with `--no-suggestions` for performance\n\n### Suggestion Types\n1. **did_you_mean**: Levenshtein-based typo corrections\n2. **similar_terms**: Terms that appear in the index that are similar\n3. **try_broader**: Subsets of the query to try\n4. **popular_queries**: Common queries in similar domains (optional)\n\n### Implementation Complexity\nRequires:\n- Index term enumeration (for did_you_mean)\n- Edit distance calculation\n- Query history tracking (for popular_queries, optional)\n\n## Acceptance Criteria\n- [ ] Zero-result searches include `suggestions` object\n- [ ] `did_you_mean` provides typo corrections\n- [ ] `similar_terms` finds related indexed terms\n- [ ] `try_broader` suggests query simplifications\n- [ ] `--no-suggestions` disables for performance\n- [ ] Suggestions are ranked by relevance\n\n## Effort Estimate\nMedium-High - 4-6 hours. Requires index term access and string similarity logic.\n\n## Future Enhancement\nCould integrate with LLM for semantic suggestions, but that's a separate feature.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T20:00:37.431959311Z","closed_at":"2025-12-01T20:00:37.431959311Z"}
{"id":"coding_agent_session_search-rob.safe","title":"Reliability \u0026 Safety: Robust Operation","description":"# Reliability \u0026 Safety\n\n## The Problem\nAgents need to handle failures gracefully:\n- Should I retry this error?\n- Will retrying cause duplicate work?\n- How long should I wait?\n\nCurrent error handling provides basic information but lacks recovery guidance.\n\n## The Solution\nEnhance error handling with:\n1. Idempotency support for safe retries\n2. Retry hints in error responses\n3. Timeout configuration\n\n## Subtasks\n1. **rob.safe.idemp** - Idempotency keys\n2. **rob.safe.retry** - Retry hints in errors\n3. **rob.safe.timeout** - Timeout configuration\n\n## Value for Agents\n- Resilience: Automatic recovery from transient failures\n- Safety: No duplicate work from retries\n- Predictability: Clear timeout behavior","status":"open","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.420280752Z","updated_at":"2025-11-30T23:54:08.420280752Z"}
{"id":"coding_agent_session_search-rob.safe.idemp","title":"Idempotency Keys","description":"# Idempotency Keys\n\n## Problem Statement\nFor long-running operations like indexing, agents may need to retry after failures. But retrying could cause duplicate work or inconsistent state.\n\n## Proposed Solution\nAdd `--idempotency-key` flag for safe retries:\n```bash\ncass index --full --idempotency-key \"idx-2025-01-30-001\" --json\n```\n\nBehavior:\n1. First call: Execute operation, store result with key\n2. Subsequent calls with same key: Return cached result\n3. Key expiration: 24 hours\n\nOutput:\n```json\n{\n  \"idempotency_key\": \"idx-2025-01-30-001\",\n  \"cached\": true,\n  \"original_timestamp\": \"2025-01-30T10:00:00Z\",\n  \"result\": {...}\n}\n```\n\n## Design Decisions\n\n### Scope\nOnly for mutating operations:\n- `cass index` - Indexing operations\n- NOT for reads (search, stats, view)\n\n### Storage\nStore idempotency keys in SQLite meta table:\n```sql\nCREATE TABLE idempotency_keys (\n  key TEXT PRIMARY KEY,\n  result_json TEXT,\n  created_at INTEGER,\n  expires_at INTEGER\n);\n```\n\n### Collision Handling\nIf same key used with different parameters, return error (not cached result).\n\n## Acceptance Criteria\n- [ ] `--idempotency-key` parameter for index command\n- [ ] Repeated calls return cached result\n- [ ] `cached: true` indicates cached response\n- [ ] Keys expire after 24 hours\n- [ ] Parameter mismatch returns error\n\n## Effort Estimate\nMedium - 2-3 hours. Requires key storage and result caching.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:38:02.810319-05:00","closed_at":"2025-12-02T00:38:02.810319-05:00"}
{"id":"coding_agent_session_search-rob.safe.retry","title":"Retry Hints in Errors","description":"# Retry Hints in Errors\n\n## Problem Statement\nCurrent error format includes `retryable: bool` but lacks guidance:\n- How long to wait before retry?\n- How many retries are reasonable?\n- What should change between retries?\n\n## Proposed Solution\nEnhance error response with retry guidance:\n```json\n{\n  \"error\": {\n    \"code\": 7,\n    \"kind\": \"lock-busy\",\n    \"message\": \"Database locked by another process\",\n    \"retryable\": true,\n    \"retry_after_ms\": 1000,\n    \"max_retries\": 3,\n    \"retry_hint\": \"Wait for other process to complete\"\n  }\n}\n```\n\n## New Fields\n\n### retry_after_ms\nSuggested delay before retry in milliseconds.\n- Lock errors: 1000ms\n- Rate limits: 5000ms\n- Transient failures: 500ms\n\n### max_retries\nRecommended maximum retry attempts.\n- Lock errors: 3\n- Network errors: 5\n- Permanent errors: 0 (not retryable)\n\n### retry_hint\nHuman/agent-readable suggestion for recovery.\n\n## Acceptance Criteria\n- [ ] `retry_after_ms` in retryable errors\n- [ ] `max_retries` recommendation\n- [ ] `retry_hint` with actionable guidance\n- [ ] Values appropriate per error type\n- [ ] Update robot-docs error schema\n\n## Effort Estimate\nLow - 1-2 hours. Enhance existing error construction.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:06:52.185803-05:00","closed_at":"2025-12-02T00:06:52.185803-05:00"}
{"id":"coding_agent_session_search-rob.safe.timeout","title":"Timeout Configuration","description":"# Timeout Configuration\n\n## Problem Statement\nAgents need predictable timing:\n- How long will this command take?\n- Can I set a maximum wait time?\n- What happens on timeout?\n\n## Proposed Solution\nAdd `--timeout` flag for time-bounded operations:\n```bash\ncass search \"query\" --json --timeout 5000  # 5 second timeout\n```\n\nOn timeout:\n```json\n{\n  \"error\": {\n    \"code\": 10,\n    \"kind\": \"timeout\",\n    \"message\": \"Operation timed out after 5000ms\",\n    \"retryable\": true,\n    \"partial_results\": true\n  },\n  \"hits\": [...]  // Partial results if available\n}\n```\n\n## Design Decisions\n\n### Timeout Scope\n- Search: Query execution time\n- Index: Per-session processing time\n- View: File read time\n\n### Partial Results\nWhere possible, return partial results gathered before timeout.\n\n### Default\nNo default timeout (backward compatible). Agents opt-in.\n\n## Acceptance Criteria\n- [ ] `--timeout N` parameter in milliseconds\n- [ ] Timeout error with code 10\n- [ ] Partial results when available\n- [ ] Works for search, index, view commands\n\n## Effort Estimate\nMedium - 2-3 hours. Requires async timeout handling.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-02T00:17:34.657667-05:00","closed_at":"2025-12-02T00:17:34.657667-05:00"}
{"id":"coding_agent_session_search-rob.state","title":"State Awareness: Knowing System Status","description":"# State Awareness\n\n## The Problem\nAgents operate blind:\n- Is the index up-to-date or stale?\n- When was the last indexing run?\n- Are there pending sessions to index?\n- Is the cache warm?\n\nWithout this information, agents might:\n- Search stale data and miss recent conversations\n- Unnecessarily re-index when not needed\n- Not know when to retry operations\n\n## The Solution\nExpose system state through:\n1. Dedicated status command\n2. Freshness metadata in search responses\n3. Health check endpoint for quick validation\n\n## Subtasks\n1. **rob.state.status** - Status command\n2. **rob.state.meta** - Index freshness in robot-meta\n3. **rob.state.health** - Health check endpoint\n\n## Value for Agents\n- Confidence: Know when to trust search results\n- Efficiency: Only index when needed\n- Debugging: Understand why results might be incomplete","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.420280752Z","updated_at":"2025-12-01T23:25:08.870745-05:00","closed_at":"2025-12-01T23:25:08.870745-05:00"}
{"id":"coding_agent_session_search-rob.state.health","title":"Health Check Endpoint","description":"# Health Check Endpoint\n\n## Problem Statement\nAgents need a minimal health check to verify cass is working before running complex operations. Current `cass diag` is too heavy for frequent checks.\n\n## Proposed Solution\nAdd minimal health check (or use status with fast path):\n```bash\ncass health\n# Exit 0 = healthy, Exit 1 = unhealthy\n\ncass health --json\n{\"healthy\": true, \"latency_ms\": 5}\n```\n\n## Design Decisions\n\n### What Health Checks\n1. Database file exists and is readable\n2. Index directory exists\n3. Can execute a minimal query\n\n### Performance Target\n\u003c50ms for full health check.\n\n### Exit Codes\n- 0: Healthy\n- 1: Unhealthy (with error details in JSON)\n\n## Alternative: Use Status\nCould fold this into `cass status --quick` instead of separate command.\n\n## Acceptance Criteria\n- [ ] `cass health` completes in \u003c50ms\n- [ ] Exit code reflects health state\n- [ ] `--json` provides machine-readable output\n- [ ] Clear error message when unhealthy\n\n## Effort Estimate\nLow - 1-2 hours. Simple checks with early exit on failure.","notes":"Implemented cass health subcommand: alias to status with stale threshold + JSON, exits 0 when db/index fresh, 1 otherwise. Reused state meta; added to CLI routing/is_robot_mode.","status":"closed","priority":3,"issue_type":"task","assignee":"PurpleHill","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T23:32:28.713224-05:00","closed_at":"2025-12-01T23:32:28.713226-05:00"}
{"id":"coding_agent_session_search-rob.state.meta","title":"Index Freshness in Robot Meta","description":"# Index Freshness in Robot Meta\n\n## Problem Statement\nWhen searching, agents don't know if results might be incomplete due to stale index. They need this context to decide whether to re-index before trusting results.\n\n## Proposed Solution\nExtend `--robot-meta` to include freshness information:\n```bash\ncass search \"error\" --json --robot-meta\n```\n\nOutput:\n```json\n{\n  \"_meta\": {\n    \"elapsed_ms\": 45,\n    \"cache_stats\": {...},\n    \"wildcard_fallback\": false,\n    \"index_freshness\": {\n      \"last_indexed_at\": \"2025-01-15T10:00:00Z\",\n      \"age_seconds\": 3600,\n      \"stale\": true,\n      \"pending_sessions\": 5\n    }\n  },\n  \"hits\": [...]\n}\n```\n\n## Design Decisions\n\n### When to Include\nOnly when `--robot-meta` is specified (opt-in to avoid bloat).\n\n### Staleness Warning\nIf index is stale, consider adding to top-level:\n```json\n{\"_warning\": \"Index is 1 hour old; 5 sessions pending. Run 'cass index' for fresh results.\"}\n```\n\n### Performance\nFreshness check should add \u003c5ms:\n- Read last_indexed_at from meta table (already connected)\n- Read watch_state.json (fast file read)\n\n## Acceptance Criteria\n- [ ] `--robot-meta` includes `index_freshness` object\n- [ ] `stale` boolean accurately reflects state\n- [ ] `pending_sessions` count is accurate\n- [ ] Minimal performance impact (\u003c5ms)\n\n## Effort Estimate\nLow - 1-2 hours. Builds on existing robot-meta infrastructure.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T21:30:39.350423-05:00","closed_at":"2025-12-01T21:30:39.350423-05:00"}
{"id":"coding_agent_session_search-rob.state.status","title":"Status Command (cass status)","description":"# Status Command (cass status)\n\n## Problem Statement\nAgents need a quick way to check system health before running searches:\n- Is the index fresh?\n- How many sessions are indexed?\n- Are there pending updates?\n\nCurrently requires running `cass diag` which is verbose and slow.\n\n## Proposed Solution\nAdd lightweight `cass status` command:\n```bash\ncass status --json\n```\n\nOutput:\n```json\n{\n  \"healthy\": true,\n  \"index\": {\n    \"fresh\": false,\n    \"last_indexed_at\": \"2025-01-15T10:00:00Z\",\n    \"age_seconds\": 3600,\n    \"stale\": true,\n    \"stale_threshold_seconds\": 1800\n  },\n  \"database\": {\n    \"conversations\": 150,\n    \"messages\": 4500\n  },\n  \"pending\": {\n    \"new_sessions\": 5,\n    \"modified_sessions\": 2,\n    \"connectors_with_updates\": [\"claude\", \"codex\"]\n  },\n  \"cache\": {\n    \"entries\": 47,\n    \"hit_rate\": 0.85\n  },\n  \"recommended_action\": \"run 'cass index' to update 7 sessions\"\n}\n```\n\n## Design Decisions\n\n### Staleness Definition\nIndex is \"stale\" if:\n- `last_indexed_at` is older than threshold (default 30 minutes)\n- There are pending sessions detected via watch_state\n\n### Performance\nStatus should be FAST (\u003c100ms):\n- Read watch_state.json for pending detection\n- Read meta table for last_indexed_at\n- Read cache stats from memory\n- NO index scanning\n\n### Recommended Action\nInclude human/agent-readable suggestion based on state.\n\n## Acceptance Criteria\n- [ ] `cass status --json` returns health summary\n- [ ] Response time \u003c100ms\n- [ ] `fresh` accurately reflects index state\n- [ ] `pending` shows sessions awaiting indexing\n- [ ] `recommended_action` provides actionable guidance\n- [ ] Works without --json for human-readable output\n\n## Effort Estimate\nMedium - 3-4 hours. Requires aggregating state from multiple sources.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-30T23:54:08.438234185Z","updated_at":"2025-12-01T02:06:28.46908759Z","closed_at":"2025-12-01T02:06:28.46908759Z"}
{"id":"coding_agent_session_search-rv8","title":"P6.1 Path mapping rule definition","description":"# P6.1 Path mapping rule definition\n\n## Overview\nDefine the data structures and parsing logic for path mapping rules that\nrewrite remote workspace paths to local equivalents.\n\n## Implementation Details\n\n### Config Extension\nExtend SourceDefinition in P5.1:\n```rust\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct SourceDefinition {\n    // ... existing fields\n    \n    /// Path mappings: remote_prefix -\u003e local_prefix\n    /// Example: \"/home/user/projects\" -\u003e \"/Users/me/projects\"\n    #[serde(default)]\n    pub path_mappings: Vec\u003cPathMapping\u003e,\n}\n\n#[derive(Debug, Clone, Serialize, Deserialize)]\npub struct PathMapping {\n    /// Remote path prefix to match\n    pub from: String,\n    /// Local path prefix to replace with\n    pub to: String,\n    /// Optional: only apply to specific agents\n    #[serde(default)]\n    pub agents: Option\u003cVec\u003cString\u003e\u003e,\n}\n```\n\n### Config Example\n```toml\n[[sources]]\nname = \"laptop\"\nhost = \"user@laptop.local\"\n\n[[sources.path_mappings]]\nfrom = \"/home/user/projects\"\nto = \"/Users/me/projects\"\n\n[[sources.path_mappings]]\nfrom = \"/opt/work\"\nto = \"/Volumes/Work\"\nagents = [\"claude-code\"]  # Only for claude-code sessions\n```\n\n### Mapping Logic\n```rust\nimpl PathMapping {\n    /// Apply mapping to a path if it matches\n    pub fn apply(\u0026self, path: \u0026str) -\u003e Option\u003cString\u003e {\n        if path.starts_with(\u0026self.from) {\n            Some(path.replacen(\u0026self.from, \u0026self.to, 1))\n        } else {\n            None\n        }\n    }\n}\n\nimpl SourceDefinition {\n    /// Apply all mappings, using longest-prefix match\n    pub fn rewrite_path(\u0026self, path: \u0026str) -\u003e String {\n        // Sort by prefix length descending for longest-prefix match\n        let mut mappings: Vec\u003c_\u003e = self.path_mappings.iter().collect();\n        mappings.sort_by(|a, b| b.from.len().cmp(\u0026a.from.len()));\n        \n        for mapping in mappings {\n            if let Some(rewritten) = mapping.apply(path) {\n                return rewritten;\n            }\n        }\n        \n        // No mapping matched, return original\n        path.to_string()\n    }\n}\n```\n\n## Dependencies\n- Requires P5.1 (base config types)\n\n## Acceptance Criteria\n- [ ] PathMapping struct serializes/deserializes correctly\n- [ ] Longest-prefix matching works\n- [ ] Agent filter works when specified\n- [ ] Unmapped paths returned unchanged","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T01:09:30.532762-05:00","updated_at":"2025-12-16T01:09:30.532762-05:00","dependencies":[{"issue_id":"coding_agent_session_search-rv8","depends_on_id":"coding_agent_session_search-luj","type":"blocks","created_at":"2025-12-16T01:11:48.972812-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-rvg","title":"bd-unit-tui-components","description":"Snapshot tests for search bar tips, filter pills clear keys, detail tabs presence","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:22.77483866Z","updated_at":"2025-11-23T20:05:49.970044939Z","closed_at":"2025-11-23T20:05:49.970044939Z","dependencies":[{"issue_id":"coding_agent_session_search-rvg","depends_on_id":"coding_agent_session_search-vbf","type":"blocks","created_at":"2025-11-23T17:35:22.776362662Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-sux","title":"Search UX Overhaul Epic","description":"Comprehensive improvements to search flow: indexing status clarity, query history debouncing, wildcard support, implicit wildcards, smarter ranking, and enhanced result display with more context, highlighting, alternating stripes, toggleable borders, and better detail pane.","notes":"This epic addresses six major areas:\n\n1. **Indexing Status Clarity** - Users need to know when search is degraded during initial/background indexing\n2. **Query History Debouncing** - Currently saves 'f','fo','foo' etc separately; need to only save final queries\n3. **Wildcard Support** - Full asterisk wildcard support (*foo, foo*, *foo*)\n4. **Implicit Wildcards** - Auto-add wildcards when results are sparse\n5. **Smarter Ranking** - Recency + match quality (exact \u003e suffix wildcard \u003e prefix wildcard \u003e both)\n6. **Enhanced Display** - 6-8 lines context, bold highlighted matches, alternating stripes, unicode borders, better detail pane\n\nContext from codebase analysis:\n- tui.rs:3382-3389 saves query history after EVERY debounced search (60ms), not after user stops typing\n- query.rs sanitize_query() currently strips non-alphanumeric chars including asterisks\n- Ranking in tui.rs:3321-3338 uses Tantivy score + recency boost but no match quality factor\n- Current result display is 2 lines per item (header + location/snippet)\n- Indexing progress shown in footer but doesn't clearly indicate search degradation","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-30T05:23:22.948668088Z","closed_at":"2025-11-30T05:23:22.948668088Z"}
{"id":"coding_agent_session_search-sux.1","title":"A1: Indexing Status Clarity","description":"Epic for making indexing status more visible and informative to users during initial or background indexing.","notes":"**Problem**: During initial indexing or rebuilds, search results may be incomplete or empty. Users need clear indication that:\n1. Indexing is in progress\n2. Search results may be degraded until complete\n3. Estimated time/progress to completion\n\n**Current State** (tui.rs:1608-1632):\n- Footer shows 'Scanning X/Y (Z%)' or 'Indexing X/Y (Z%)'\n- '[REBUILDING INDEX - Search unavailable]' shown during full rebuilds\n- '[Updating]' shown during incremental updates\n\n**Improvements Needed**:\n- More prominent visual indicator (not just footer text)\n- Clearer messaging about search impact\n- Progress bar or spinner in results area when empty due to indexing\n- Consider showing partial results with warning banner","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:55.515976403Z","closed_at":"2025-11-29T06:44:55.515976403Z"}
{"id":"coding_agent_session_search-sux.1.1","title":"A1.1: Indexing status banner in results area","description":"Display a prominent banner in the results area when indexing is in progress, with progress bar and estimated completion.","notes":"**Implementation**:\n1. In tui.rs render loop (around line 1706-1742), when panes.is_empty() AND progress.phase != 0:\n   - Show dedicated indexing banner instead of 'No results'\n   - Include spinner animation (reuse SPINNER_CHARS)\n   - Show progress bar using indicatif-style blocks\n   - Display phase name ('Scanning sources...' / 'Building index...')\n   - Add helpful text: 'Search will be available once indexing completes'\n\n2. When panes are NOT empty but indexing is in progress:\n   - Add subtle banner at top of results: '⚠ Indexing in progress - results may be incomplete'\n   - Use warning color from palette (amber/yellow)\n\n**Files to modify**:\n- src/ui/tui.rs: render logic for results area\n- src/ui/components/widgets.rs: optional new widget for progress banner\n\n**Testing**:\n- Verify banner appears during cass index --full\n- Verify banner clears when indexing completes\n- Test with TUI_HEADLESS=1 for snapshot","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:55.546609405Z","closed_at":"2025-11-29T06:44:55.546609405Z"}
{"id":"coding_agent_session_search-sux.1.2","title":"A1.2: Footer indexing indicator enhancement","description":"Enhance footer to show more descriptive indexing status with phase-specific icons and clearer messaging.","notes":"**Current** (tui.rs:1608-1632):\n```rust\nlet phase_str = if phase == 1 { \"Scanning\" } else { \"Indexing\" };\ns.push_str(\" [REBUILDING INDEX - Search unavailable]\");\n```\n\n**Improvements**:\n1. Add phase-specific icons: 🔍 Scanning | 📦 Indexing | ✓ Ready\n2. Show ETA if possible (based on rate of current/total change)\n3. Clearer impact messaging:\n   - Phase 1 (Scanning): '🔍 Discovering sessions...' \n   - Phase 2 (Indexing): '📦 Building search index...'\n   - Rebuilding: '⚠ Full rebuild - search unavailable'\n4. Flash or pulse the indicator to draw attention\n\n**Files to modify**:\n- src/ui/tui.rs: render_progress closure (line 1608)\n\n**Testing**:\n- Verify correct icons per phase\n- Test transitions between phases","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:55.575704692Z","closed_at":"2025-11-29T06:44:55.575704692Z"}
{"id":"coding_agent_session_search-sux.1.3","title":"A1.3: Partial results with degraded warning","description":"When indexing is in progress but some results exist, show them with a visible warning that results may be incomplete.","notes":"**Rationale**: During incremental updates or early in initial indexing, there may be partial results. Better to show these than nothing.\n\n**Implementation**:\n1. In tui.rs when building panes, check if progress.phase != 0\n2. If true and panes not empty, add degraded indicator:\n   - Yellow/amber tint on results block border\n   - Small banner: '⚠ Indexing in progress - showing partial results'\n3. Consider showing count: 'Found X results (indexing Y% complete)'\n\n**Files to modify**:\n- src/ui/tui.rs: results pane rendering\n\n**Dependency**: Should implement after A1.1 and A1.2 for consistent styling","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:55.598583317Z","closed_at":"2025-11-29T06:44:55.598583317Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.1.3","depends_on_id":"coding_agent_session_search-sux.1.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.1.3","depends_on_id":"coding_agent_session_search-sux.1.2","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.2","title":"A2: Query History Debouncing","description":"Epic for fixing query history to only save final queries, not every intermediate keystroke.","notes":"**Problem** (tui.rs:3382-3389):\nCurrently after EVERY debounced search (60ms debounce at line 3294-3296), the query is saved to history:\n```rust\nif !query.trim().is_empty()\n    \u0026\u0026 query_history.front().map(|q| q != \u0026query).unwrap_or(true)\n{\n    query_history.push_front(query.clone());\n}\n```\n\nSo typing 'foobar' saves: 'f', 'fo', 'foo', 'foob', 'fooba', 'foobar' - 6 entries for one search!\n\n**Root Cause**:\n- Search debounce (60ms) is for responsive live search\n- History save happens after each search, not after user 'commits' query\n\n**Solution Options**:\n1. **Separate history debounce**: Save to history only after longer pause (e.g., 2-3 seconds)\n2. **Commit on Enter**: Only save when user presses Enter or navigates results\n3. **Consolidation on save**: Dedupe history on exit by removing prefixes\n4. **Hybrid**: Debounce + commit tracking\n\n**Recommended**: Option 2 (commit on explicit action) - clearest user intent","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:58.663870139Z","closed_at":"2025-11-29T06:44:58.663870139Z"}
{"id":"coding_agent_session_search-sux.2.1","title":"A2.1: Remove auto-save from search execution","description":"Stop saving queries to history after every debounced search execution.","notes":"**Current Code** (tui.rs:3382-3389):\n```rust\nif !query.trim().is_empty()\n    \u0026\u0026 query_history.front().map(|q| q != \u0026query).unwrap_or(true)\n{\n    query_history.push_front(query.clone());\n    if query_history.len() \u003e history_cap {\n        query_history.pop_back();\n    }\n}\n```\n\n**Change**: Remove this block entirely from the search execution path.\n\n**Files to modify**:\n- src/ui/tui.rs: lines ~3382-3389\n\n**Testing**:\n- Type query, verify history NOT populated until explicit action\n- Ctrl+R should show no new entries until commit","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:58.669428694Z","closed_at":"2025-11-29T06:44:58.669428694Z"}
{"id":"coding_agent_session_search-sux.2.2","title":"A2.2: Save history on explicit commit actions","description":"Save query to history when user performs explicit commit actions: Enter to view, result selection, or focus change.","notes":"**Commit Actions**:\n1. **Enter key** on result → save current query\n2. **Navigation to result** (selecting first result after typing) → save query\n3. **Focus change** to detail pane → save query\n4. **External action** (F8 editor, y copy) → save query\n5. **Search refresh** (Ctrl+Shift+R) → save query\n\n**Implementation**:\nCreate helper function `save_query_to_history(query, history, cap)` and call at commit points.\n\n```rust\nfn save_query_to_history(query: \u0026str, history: \u0026mut VecDeque\u003cString\u003e, cap: usize) {\n    let q = query.trim();\n    if !q.is_empty() \u0026\u0026 history.front().map(|h| h != q).unwrap_or(true) {\n        history.push_front(q.to_string());\n        if history.len() \u003e cap {\n            history.pop_back();\n        }\n    }\n}\n```\n\n**Files to modify**:\n- src/ui/tui.rs: Add helper, call at Enter/navigation/action points\n\n**Testing**:\n- Type 'foobar', press Enter → only 'foobar' in history (not f/fo/foo/etc)\n- Type query, arrow down to select → query saved\n- Type query, Tab to detail → query saved","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:58.672393023Z","closed_at":"2025-11-29T06:44:58.672393023Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.2.2","depends_on_id":"coding_agent_session_search-sux.2.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.2.3","title":"A2.3: History deduplication on save","description":"When persisting history to tui_state.json, deduplicate by removing queries that are strict prefixes of later queries.","notes":"**Additional Safety Net**:\nEven with commit-based saving, edge cases might save prefixes. Dedupe on persist.\n\n**Algorithm**:\n```rust\nfn dedupe_history(history: Vec\u003cString\u003e) -\u003e Vec\u003cString\u003e {\n    let mut result = Vec::new();\n    for q in history {\n        // Skip if this is a prefix of any existing entry\n        let dominated = result.iter().any(|existing| existing.starts_with(\u0026q) \u0026\u0026 existing != \u0026q);\n        if !dominated {\n            // Also remove any existing entries that are prefixes of this\n            result.retain(|existing| !q.starts_with(existing) || q == *existing);\n            result.push(q);\n        }\n    }\n    result\n}\n```\n\n**Apply at** (tui.rs ~3419-3428):\n```rust\nquery_history: Some(dedupe_history(query_history.iter().cloned().collect())),\n```\n\n**Files to modify**:\n- src/ui/tui.rs: add dedupe_history function, apply in save_state\n\n**Testing**:\n- Manually add prefixes to history, verify deduped on next save","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:44:58.67719417Z","closed_at":"2025-11-29T06:44:58.67719417Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.2.3","depends_on_id":"coding_agent_session_search-sux.2.2","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3","title":"A3: Full Wildcard Support","description":"Epic for implementing full asterisk (*) wildcard support in search queries.","notes":"**Goal**: Support wildcards:\n- `*foo` - prefix wildcard (find 'barfoo', 'bazfoo')\n- `foo*` - suffix wildcard (find 'foobar', 'foobaz') - partially exists via prefix match mode\n- `*foo*` - both (find anything containing 'foo')\n- Explicit asterisks should override implicit behavior\n\n**Current State**:\n- Prefix match mode (F9) appends `*` to terms automatically (tui.rs:1148-1163)\n- query.rs sanitize_query() likely strips `*` as non-alphanumeric\n- Tantivy supports wildcards but may need WildcardQuery\n\n**Implementation Approach**:\n1. Preserve `*` in sanitize_query()\n2. Parse wildcards before Tantivy query construction\n3. Use appropriate Tantivy query types (WildcardQuery, PhraseQuery)\n4. Track which terms used wildcards for ranking purposes","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:01.335630954Z","closed_at":"2025-11-29T06:45:01.335630954Z"}
{"id":"coding_agent_session_search-sux.3.1","title":"A3.1: Preserve asterisks in query sanitization","description":"Modify query sanitization to preserve asterisk characters as wildcard markers.","notes":"**Current** (query.rs sanitize_query - need to locate exact implementation):\nLikely strips all non-alphanumeric characters.\n\n**Change**:\n- Preserve `*` character\n- Normalize multiple asterisks: `***foo` → `*foo`\n- Trim leading/trailing whitespace around asterisks\n\n**Implementation**:\n```rust\nfn sanitize_query(q: \u0026str) -\u003e String {\n    let mut result = String::with_capacity(q.len());\n    let mut last_was_asterisk = false;\n    for c in q.chars() {\n        if c == '*' {\n            if !last_was_asterisk {\n                result.push('*');\n            }\n            last_was_asterisk = true;\n        } else if c.is_alphanumeric() || c.is_whitespace() {\n            result.push(c);\n            last_was_asterisk = false;\n        } else {\n            result.push(' ');\n            last_was_asterisk = false;\n        }\n    }\n    result.split_whitespace().collect::\u003cVec\u003c_\u003e\u003e().join(\" \")\n}\n```\n\n**Files to modify**:\n- src/search/query.rs: sanitize_query function\n\n**Testing**:\n- `*foo` preserved\n- `foo*bar` preserved\n- `***foo` → `*foo`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:01.340742497Z","closed_at":"2025-11-29T06:45:01.340742497Z"}
{"id":"coding_agent_session_search-sux.3.2","title":"A3.2: Parse wildcard patterns from query terms","description":"Create term parser that identifies wildcard patterns and returns structured term info for query building.","notes":"**Pattern Types**:\n```rust\nenum WildcardPattern {\n    Exact(String),           // no wildcards\n    Prefix(String),          // foo* - ends with asterisk\n    Suffix(String),          // *foo - starts with asterisk  \n    Contains(String),        // *foo* - both ends\n    Infix(String, String),   // foo*bar - asterisk in middle\n}\n\nfn parse_term_pattern(term: \u0026str) -\u003e WildcardPattern {\n    let starts = term.starts_with('*');\n    let ends = term.ends_with('*');\n    let core = term.trim_matches('*');\n    \n    match (starts, ends) {\n        (false, false) =\u003e WildcardPattern::Exact(core.to_string()),\n        (false, true) =\u003e WildcardPattern::Prefix(core.to_string()),\n        (true, false) =\u003e WildcardPattern::Suffix(core.to_string()),\n        (true, true) =\u003e WildcardPattern::Contains(core.to_string()),\n    }\n}\n```\n\n**Files to modify**:\n- src/search/query.rs: add WildcardPattern enum and parser\n\n**Testing**:\n- Unit tests for each pattern type\n- Edge cases: `*`, `**`, `*a*b*`","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:01.345556339Z","closed_at":"2025-11-29T06:45:01.345556339Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3.2","depends_on_id":"coding_agent_session_search-sux.3.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3.3","title":"A3.3: Build Tantivy queries from wildcard patterns","description":"Construct appropriate Tantivy query types based on parsed wildcard patterns.","notes":"**Tantivy Query Mapping**:\n- `Exact` → TermQuery or edge-ngram prefix (existing behavior)\n- `Prefix` → Use existing edge-ngram or PhrasePrefix\n- `Suffix` → RegexQuery with `.*term$` or content_prefix ngram reversed\n- `Contains` → RegexQuery with `.*term.*`\n\n**Challenge**: Tantivy doesn't have native suffix/contains. Options:\n1. RegexQuery (slow but works)\n2. Reverse-indexed field (complex schema change)\n3. Filter post-search using SQLite FTS5 (has `*term*` support)\n\n**Recommended Approach**:\n1. For `*foo*` (contains): Use FTS5 fallback which supports `*term*`\n2. For `*foo` (suffix): Same FTS5 approach\n3. For `foo*` (prefix): Use existing edge-ngram approach\n\n**Files to modify**:\n- src/search/query.rs: build_tantivy_query function\n- May need to enhance FTS5 fallback path\n\n**Testing**:\n- `foo*` returns prefix matches\n- `*foo` returns suffix matches\n- `*foo*` returns contains matches","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:01.348927968Z","closed_at":"2025-11-29T06:45:01.348927968Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3.3","depends_on_id":"coding_agent_session_search-sux.3.2","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.3.4","title":"A3.4: Wildcard query tests","description":"Comprehensive tests for wildcard query functionality across all pattern types.","notes":"**Test Cases**:\n1. `foo` exact - finds 'foo' not 'foobar'\n2. `foo*` prefix - finds 'foobar', 'foobaz', not 'barfoo'\n3. `*foo` suffix - finds 'barfoo', not 'foobar'\n4. `*foo*` contains - finds 'barfoobaz', 'foobar', 'barfoo'\n5. Multiple terms: `*foo* bar*` - AND of patterns\n6. Edge cases: `*`, `**`, empty after trim\n\n**Integration Tests**:\n- Index fixture data with known patterns\n- Query with wildcards, assert correct results\n\n**Files to modify**:\n- tests/search_wildcards.rs (new)\n- Possibly update tests/util/mod.rs for fixtures\n\n**Dependency**: Needs A3.1-A3.3 complete","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:01.350766183Z","closed_at":"2025-11-29T06:45:01.350766183Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.3.4","depends_on_id":"coding_agent_session_search-sux.3.3","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.4","title":"A4: Implicit Wildcards","description":"Epic for auto-adding wildcards when search results are sparse or empty.","notes":"**Goal**: When query returns zero or few results, automatically try wildcards:\n1. First try `query*` (suffix wildcard)\n2. If still sparse, try `*query*` (contains)\n3. Indicate to user that wildcards were applied\n\n**Thresholds**:\n- Zero results → immediately try wildcards\n- \u003c 3 results → try wildcards for more\n- Keep explicit wildcard queries as-is\n\n**User Feedback**:\n- Footer/banner: 'Showing results for \"*query*\" (no exact matches)'\n- Option to dismiss and force exact search\n\n**Implementation Considerations**:\n- Don't apply implicit wildcards if query already has explicit `*`\n- Track whether results came from original or wildcard query for ranking\n- Cache both searches to allow quick toggle","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:03.790384519Z","closed_at":"2025-11-29T06:45:03.790384519Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.4","depends_on_id":"coding_agent_session_search-sux.3","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.4.1","title":"A4.1: Detect sparse results and trigger wildcard fallback","description":"After initial search, detect when results are sparse and automatically retry with wildcards.","notes":"**Implementation in SearchClient**:\n```rust\npub struct SearchResult {\n    pub hits: Vec\u003cSearchHit\u003e,\n    pub original_query: String,\n    pub effective_query: String,  // may differ if wildcards applied\n    pub wildcard_fallback: bool,  // true if wildcards were auto-added\n}\n\npub fn search_with_fallback(\n    \u0026self,\n    query: \u0026str,\n    filters: SearchFilters,\n    limit: usize,\n    offset: usize,\n) -\u003e Result\u003cSearchResult\u003e {\n    // Skip fallback if query has explicit wildcards\n    let has_explicit = query.contains('*');\n    \n    // Try original query\n    let hits = self.search(query, filters.clone(), limit, offset)?;\n    \n    if hits.len() \u003e= 3 || has_explicit {\n        return Ok(SearchResult {\n            hits,\n            original_query: query.to_string(),\n            effective_query: query.to_string(),\n            wildcard_fallback: false,\n        });\n    }\n    \n    // Try suffix wildcard\n    let suffix_q = add_suffix_wildcards(query);\n    let suffix_hits = self.search(\u0026suffix_q, filters.clone(), limit, offset)?;\n    \n    if suffix_hits.len() \u003e= 3 {\n        return Ok(SearchResult { hits: suffix_hits, ..., wildcard_fallback: true });\n    }\n    \n    // Try contains wildcard\n    let contains_q = add_contains_wildcards(query);\n    let contains_hits = self.search(\u0026contains_q, filters, limit, offset)?;\n    \n    Ok(SearchResult { hits: contains_hits, ..., wildcard_fallback: true })\n}\n```\n\n**Files to modify**:\n- src/search/query.rs: add search_with_fallback, SearchResult struct\n\n**Testing**:\n- Query with zero matches → wildcards applied\n- Query with 1-2 matches → wildcards tried for more\n- Query with 5+ matches → no fallback","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:03.794326853Z","closed_at":"2025-11-29T06:45:03.794326853Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.4.1","depends_on_id":"coding_agent_session_search-sux.3.3","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.4.2","title":"A4.2: UI indicator for wildcard fallback","description":"Show user when implicit wildcards were applied to their search.","notes":"**UI Indicators**:\n\n1. **Status bar message**:\n   - 'Showing results for \"*query*\" (no exact matches found)'\n   - Use distinct color (info blue or muted yellow)\n\n2. **Search bar modification** (optional):\n   - Show effective query in muted text below input\n   - '→ searching: *query*'\n\n3. **Hotkey to toggle**:\n   - Shift+F9 or similar to force exact search\n   - Status: 'Exact mode: no results'\n\n**Implementation in tui.rs**:\n- Track wildcard_fallback state\n- Render indicator in status or search bar area\n- Add toggle hotkey handler\n\n**Files to modify**:\n- src/ui/tui.rs: state tracking, render, hotkey\n- src/ui/components/widgets.rs: search bar enhancement\n\n**Testing**:\n- Verify indicator appears when fallback active\n- Toggle hotkey works","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:03.799474497Z","closed_at":"2025-11-29T06:45:03.799474497Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.4.2","depends_on_id":"coding_agent_session_search-sux.4.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5","title":"A5: Smarter Ranking","description":"Epic for improving search result ranking with recency, match quality, and configurable weighting.","notes":"**Current Ranking** (tui.rs:3321-3338):\n```rust\nlet alpha = match ranking_mode {\n    RankingMode::RecentHeavy =\u003e 1.0,\n    RankingMode::Balanced =\u003e 0.4,\n    RankingMode::RelevanceHeavy =\u003e 0.1,\n};\nlet score_a = a.score + alpha * recency(a);\n```\n\n**Problems**:\n1. Only considers Tantivy score + recency\n2. No match quality factor (exact vs wildcard)\n3. All wildcard matches treated equally\n\n**Improved Ranking Formula**:\n```\nfinal_score = tantivy_score * match_quality_factor + alpha * recency\n\nmatch_quality_factor:\n  - Exact match: 1.0\n  - Suffix wildcard only (foo*): 0.9\n  - Prefix wildcard only (*foo): 0.8\n  - Contains wildcard (*foo*): 0.7\n  - Implicit wildcard fallback: 0.6\n```\n\n**User-Configurable**:\n- F12 cycles: RecentHeavy / Balanced / RelevanceHeavy / MatchQualityHeavy","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-30T05:22:28.429341404Z","closed_at":"2025-11-30T05:22:28.429341404Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5","depends_on_id":"coding_agent_session_search-sux.4","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5.1","title":"A5.1: Track match type in SearchHit","description":"Extend SearchHit to include information about how the result matched (exact, wildcard type, implicit fallback).","notes":"**Extend SearchHit struct**:\n```rust\npub struct SearchHit {\n    // ... existing fields ...\n    pub match_type: MatchType,\n}\n\npub enum MatchType {\n    Exact,\n    SuffixWildcard,    // foo*\n    PrefixWildcard,    // *foo\n    ContainsWildcard,  // *foo*\n    ImplicitFallback,  // auto-added wildcards\n}\n```\n\n**Set during query execution**:\n- In search_with_fallback, tag hits with appropriate MatchType\n- Track which wildcard pattern(s) matched\n\n**Files to modify**:\n- src/search/query.rs: extend SearchHit, set match_type during search\n\n**Testing**:\n- Query 'foo' returns Exact matches\n- Query 'foo*' returns SuffixWildcard matches\n- Zero-result fallback returns ImplicitFallback","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T07:12:51.609617453Z","closed_at":"2025-11-29T07:12:51.609617453Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5.1","depends_on_id":"coding_agent_session_search-sux.4.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5.2","title":"A5.2: Implement match quality factor in ranking","description":"Add match quality factor to ranking formula based on MatchType.","notes":"**Implementation in tui.rs ranking** (around line 3326-3338):\n\n```rust\nfn match_quality_factor(hit: \u0026SearchHit) -\u003e f32 {\n    match hit.match_type {\n        MatchType::Exact =\u003e 1.0,\n        MatchType::SuffixWildcard =\u003e 0.9,\n        MatchType::PrefixWildcard =\u003e 0.8,\n        MatchType::ContainsWildcard =\u003e 0.7,\n        MatchType::ImplicitFallback =\u003e 0.6,\n    }\n}\n\n// In ranking:\nlet quality = match_quality_factor(a);\nlet score_a = a.score * quality + alpha * recency(a);\n```\n\n**Files to modify**:\n- src/ui/tui.rs: ranking logic around line 3326\n\n**Testing**:\n- Exact match ranks above wildcard match at same recency\n- Suffix wildcard ranks above prefix wildcard\n- Implicit fallback results rank lowest","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T19:49:58.75071127Z","closed_at":"2025-11-29T19:49:58.75071127Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5.2","depends_on_id":"coding_agent_session_search-sux.5.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.5.3","title":"A5.3: Add MatchQualityHeavy ranking mode","description":"Add new ranking mode option that prioritizes match quality over recency.","notes":"**Extend RankingMode enum**:\n```rust\nenum RankingMode {\n    RecentHeavy,\n    Balanced,\n    RelevanceHeavy,\n    MatchQualityHeavy,  // NEW\n}\n```\n\n**F12 cycle update**:\nRecentHeavy → Balanced → RelevanceHeavy → MatchQualityHeavy → RecentHeavy\n\n**Ranking formula for MatchQualityHeavy**:\n```rust\nRankingMode::MatchQualityHeavy =\u003e {\n    let quality = match_quality_factor(hit);\n    quality * 2.0 + hit.score * 0.5 + recency * 0.1\n}\n```\n\n**Files to modify**:\n- src/ui/tui.rs: RankingMode enum, F12 handler, ranking formula\n\n**Testing**:\n- F12 cycles through all 4 modes\n- MatchQualityHeavy strongly prefers exact matches","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:29.814906144Z","closed_at":"2025-11-29T06:45:29.814906144Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.5.3","depends_on_id":"coding_agent_session_search-sux.5.2","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6","title":"A6: Enhanced Result Display","description":"Epic for improving search result display: more context, highlighting, visual separation, borders, detail pane.","notes":"**Goals**:\n1. **More context**: 6-8 lines per result (currently 2)\n2. **Better highlighting**: Bold + conspicuous color for matches\n3. **Alternating stripes**: Visual separation between results\n4. **Unicode borders**: Toggleable decorative borders\n5. **Better detail pane**: More information, better layout\n6. **Other QoL**: Improved readability, information density\n\n**Current State**:\n- 2 lines per result: header (score bar + title) + location/snippet\n- Basic highlighting with accent color + bold\n- No alternating colors\n- Simple block borders\n- Detail pane has tabs but limited content visibility\n\n**Impact on Layout**:\n- More lines per result = fewer results visible\n- Need to balance context vs. scanability\n- Consider collapsible/expandable results","status":"closed","priority":1,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-30T05:22:16.894668906Z","closed_at":"2025-11-30T05:22:16.894668906Z"}
{"id":"coding_agent_session_search-sux.6.1","title":"A6.1: Expand result context to 3-4 lines (revised)","description":"Increase the amount of content shown per search result from 2 lines to 3-4 lines maximum. Extended metadata should remain in detail pane, not inline.","notes":"**REVISED from original 6-8 lines**\n\nOriginal proposal of 6-8 lines was too aggressive:\n- At 24-line terminal, only 3-4 results visible\n- Slower visual scanning\n- Information overload\n\n**New Layout (3-4 lines)**:\n```\nLine 1: [████] Title (bold) + Agent icon\nLine 2: Agent | Workspace (truncated) | Relative time\nLine 3: First line of matching content with highlights...\nLine 4: (optional) Second context line if space permits\n```\n\n**Key changes**:\n- Keep extended metadata (full path, tokens, etc.) in detail pane\n- Prioritize scanability over information density\n- Consider toggleable compact/expanded mode rather than always-expanded\n\n**Files to modify**:\n- src/ui/tui.rs: ListItem construction\n- Update calculate_pane_limit() for new lines per item\n\n**Testing**:\n- Verify 3-4 lines rendered per result\n- Ensure at least 5-6 results visible in typical terminal\n- Test scrolling behavior","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T20:07:29.942086407Z","closed_at":"2025-11-29T20:07:29.942086407Z"}
{"id":"coding_agent_session_search-sux.6.2","title":"A6.2: Enhanced match highlighting","description":"Improve search term highlighting with more conspicuous colors and bold styling.","notes":"**Current** (tui.rs:1166-1226):\n```rust\nspans.push(Span::styled(\n    text[start..end].to_string(),\n    base.patch(\n        Style::default()\n            .fg(palette.accent)  // Uses accent color\n            .add_modifier(Modifier::BOLD),\n    ),\n));\n```\n\n**Improvements**:\n1. **Background highlight**: Add background color for matched text\n2. **Distinct color**: Use high-contrast highlight color (e.g., yellow on dark bg)\n3. **Underline option**: Add underline for extra emphasis\n4. **Theme-aware**: Different highlight for dark/light themes\n\n**New highlight style**:\n```rust\nStyle::default()\n    .fg(palette.highlight_fg)  // High contrast text\n    .bg(palette.highlight_bg)  // Background color (e.g., dark yellow)\n    .add_modifier(Modifier::BOLD)\n```\n\n**Add to ThemePalette**:\n```rust\npub highlight_fg: Color,  // e.g., Black or dark text\npub highlight_bg: Color,  // e.g., Yellow or gold\n```\n\n**Files to modify**:\n- src/ui/components/theme.rs: add highlight colors\n- src/ui/tui.rs: update highlight_spans_owned\n\n**Testing**:\n- Verify highlights are highly visible\n- Test dark and light themes\n- Test with multiple matches in one line","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T20:11:41.974599819Z","closed_at":"2025-11-29T20:11:41.974599819Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.2","depends_on_id":"coding_agent_session_search-sux.6.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.3","title":"A6.3: Alternating color stripes for results","description":"Add alternating background colors to search results for better visual separation.","notes":"**Goal**: Zebra-striping like spreadsheets - alternating subtle background colors.\n\n**Implementation in result rendering** (tui.rs ~1772):\n```rust\nfor (idx, hit) in pane.hits.iter().enumerate() {\n    let is_odd = idx % 2 == 1;\n    let stripe_bg = if is_odd { palette.stripe_odd } else { palette.stripe_even };\n    \n    // Apply stripe_bg to all lines in this result\n    let base_style = Style::default().bg(stripe_bg);\n    // ... build lines with base_style ...\n}\n```\n\n**Add to ThemePalette**:\n```rust\npub stripe_even: Color,  // e.g., palette.bg (normal)\npub stripe_odd: Color,   // e.g., slightly lighter/darker\n```\n\n**Stripe colors**:\n- Dark theme: even=#1a1b26, odd=#1e2030\n- Light theme: even=#f0f0f5, odd=#e8e8f0\n\n**Files to modify**:\n- src/ui/components/theme.rs: add stripe colors\n- src/ui/tui.rs: apply alternating bg in result list\n\n**Testing**:\n- Verify alternating colors visible\n- Test with selected item (selection should override stripe)\n- Test both themes","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T22:12:59.696429368Z","closed_at":"2025-11-29T22:12:59.696429368Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.3","depends_on_id":"coding_agent_session_search-sux.6.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.4","title":"A6.4: Toggleable unicode borders for results","description":"Add decorative unicode borders around individual results that can be toggled on/off.","notes":"**Goal**: Optional decorative borders for each result (not just pane border).\n\n**Unicode border characters**:\n```\n┌──────────────────────────────────────┐\n│ Result content...                    │\n│ More content...                      │\n└──────────────────────────────────────┘\n```\n\n**Toggle mechanism**:\n- New state: `borders_enabled: bool`\n- Hotkey: F11 or Shift+B\n- Persist in tui_state.json\n\n**Implementation**:\n```rust\nif borders_enabled {\n    // Add top border line\n    lines.push(Line::from(\"┌\" + \"─\".repeat(width-2) + \"┐\"));\n    // Wrap content lines with │ prefix/suffix\n    for line in content_lines {\n        lines.push(Line::from(format!(\"│{}│\", pad_to_width(line, width-2))));\n    }\n    // Add bottom border line\n    lines.push(Line::from(\"└\" + \"─\".repeat(width-2) + \"┘\"));\n}\n```\n\n**Files to modify**:\n- src/ui/tui.rs: borders_enabled state, hotkey, render logic\n- src/ui/tui.rs: TuiStatePersisted struct, save/load\n\n**Testing**:\n- F11 toggles borders on/off\n- Borders persist across sessions\n- Layout adjusts correctly with borders","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:45:32.767427006Z","closed_at":"2025-11-29T06:45:32.767427006Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.4","depends_on_id":"coding_agent_session_search-sux.6.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.5","title":"A6.5: Enhanced detail pane content","description":"Improve the detail pane at the bottom to show more useful information and better layout.","notes":"**Current Detail Pane** (tui.rs:1895-2097):\n- Tabs: Messages | Snippets | Raw\n- Meta lines: Title, Agent, Workspace, Source, Score\n- Scrollable content area\n\n**Improvements**:\n\n1. **Expanded metadata section**:\n   - Add: Created timestamp, Duration, Token count\n   - Add: Match type indicator (Exact/Wildcard)\n   - Add: Quick stats (messages count, code blocks count)\n\n2. **Better messages tab**:\n   - Show message count in tab: 'Messages (42)'\n   - Add message separators with role icons\n   - Highlight search terms in message content\n   - Show timestamps for each message\n\n3. **Better snippets tab**:\n   - Group by file path\n   - Show line numbers prominently\n   - Syntax highlighting hints (language label)\n\n4. **Quick actions bar**:\n   - [c] Copy | [e] Edit | [o] Open file | [p] Print path\n   - Show in header or footer of detail pane\n\n**Files to modify**:\n- src/ui/tui.rs: detail pane rendering (~1895-2097)\n- src/ui/data.rs: potentially extend ConversationView\n\n**Testing**:\n- Verify all new metadata displays\n- Test tab switching with new content\n- Test quick actions work","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T22:04:05.197163083Z","closed_at":"2025-11-29T22:04:05.197163083Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.5","depends_on_id":"coding_agent_session_search-sux.6.2","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.6","title":"A6.6: QoL improvements bundle","description":"Collection of smaller quality-of-life improvements for search results display.","notes":"**Improvements**:\n\n1. **Truncation indicators**:\n   - Show '...' when content is truncated\n   - Different from current ellipsis (use styled indicator)\n\n2. **Word wrap for long lines**:\n   - Smart word wrap instead of cut-off\n   - Indent continuation lines\n\n3. **Relative timestamps**:\n   - '2 hours ago' instead of full timestamp\n   - Already partially implemented in format_relative_time()\n\n4. **Result numbering**:\n   - Show 1-indexed result numbers for quick reference\n   - '#1', '#2', etc. in small text\n\n5. **Match count per result**:\n   - Show how many times query matches in this result\n   - '(3 matches)' indicator\n\n6. **Agent icon/emoji**:\n   - 🤖 Claude | 🔷 Codex | 💎 Gemini | etc.\n   - Quick visual identification\n\n7. **Keyboard hint for expansion**:\n   - 'Enter for details' hint on selected result\n\n**Files to modify**:\n- src/ui/tui.rs: result rendering, helpers\n- src/ui/components/theme.rs: if new styles needed\n\n**Testing**:\n- Verify each improvement individually\n- Test edge cases (very long content, many matches)","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T06:51:13.188398384Z","closed_at":"2025-11-29T06:51:13.188398384Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.6","depends_on_id":"coding_agent_session_search-sux.6.5","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.6.6a","title":"Relative timestamps in results","description":"Show relative timestamps ('2h ago', 'yesterday') instead of full timestamps in search results. format_relative_time() already exists - use it in result rendering.","design":"Use existing format_relative_time() function. Apply to result header line. Keep full timestamp in detail pane.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-29T06:50:12.697519131Z","updated_at":"2025-11-29T19:45:42.50343071Z","closed_at":"2025-11-29T19:45:42.50343071Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.6a","depends_on_id":"coding_agent_session_search-sux.6","type":"parent-child","created_at":"2025-11-29T06:50:55.742244195Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-sux.6.6b","title":"Agent icons in results","description":"Add small agent-specific icons/emojis to result headers for quick visual identification. Example: Claude=robot, Codex=blue-diamond, Gemini=gem","design":"Map agent_slug to icon in theme or constants. Add icon before agent name in result header.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-29T06:50:17.506195789Z","updated_at":"2025-11-30T06:06:24.82793074Z","closed_at":"2025-11-30T06:06:24.82793074Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.6b","depends_on_id":"coding_agent_session_search-sux.6","type":"parent-child","created_at":"2025-11-29T06:50:55.903576475Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-sux.6.6c","title":"Match count per result","description":"Show count of query matches within each result, e.g., '(3 matches)' to help user gauge relevance at a glance.","design":"Count occurrences during snippet generation. Display in result header. Consider hiding for 1 match.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-29T06:50:20.664182893Z","updated_at":"2025-11-30T05:20:47.453791928Z","closed_at":"2025-11-30T05:20:47.453791928Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.6c","depends_on_id":"coding_agent_session_search-sux.6","type":"parent-child","created_at":"2025-11-29T06:50:56.108647029Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-sux.6.6d","title":"Smart word wrap for content","description":"Implement smart word wrap for long content lines instead of hard cut-off. Indent continuation lines for visual coherence.","design":"Use textwrap crate or manual word boundary detection. Indent wrapped lines by 2 spaces. Respect terminal width.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-29T06:50:28.434887448Z","updated_at":"2025-11-30T05:20:47.488748848Z","closed_at":"2025-11-30T05:20:47.488748848Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.6.6d","depends_on_id":"coding_agent_session_search-sux.6","type":"parent-child","created_at":"2025-11-29T06:50:56.295149524Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-sux.7","title":"A7: Testing and Polish","description":"Epic for comprehensive testing and final polish of all search UX improvements.","notes":"**Testing Scope (REVISED)**:\n\nNote: sux.1-4 (indexing status, history debounce, wildcards, implicit fallback) are DONE.\nTests for those features should already exist.\n\n**Remaining Testing**:\n\n1. **Unit tests for sux.5 (ranking)**:\n   - MatchType detection\n   - Quality factor calculation\n\n2. **UI tests for sux.6 (display)**:\n   - 3-4 line result layout\n   - Highlighting appearance\n   - Alternating stripes\n   - Detail pane layout\n\n3. **Performance tests**:\n   - Suffix/substring wildcard latency (uses RegexQuery)\n   - Ensure sub-80ms target maintained\n\n**Polish Scope**:\n- Update README with wildcard syntax (already in codebase)\n- Help overlay updates\n- Accessibility: WCAG contrast check\n\n**Dependencies Updated**: sux.1-4 closed, only sux.5 and sux.6 remain as blockers.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-30T05:23:29.270706179Z","closed_at":"2025-11-30T05:23:29.270706179Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.2","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.3","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.4","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.5","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7","depends_on_id":"coding_agent_session_search-sux.6","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.1","title":"A7.1: Unit tests for wildcard and ranking","description":"Add comprehensive unit tests for wildcard parsing, match type tracking, and ranking formula.","notes":"**Status**: UNBLOCKED - dependencies sux.3.4 and sux.5.3 are now closed.\n\n**Note**: sux.5.3 (MatchQualityHeavy ranking mode) was removed as unnecessary.\nFocus tests on:\n1. Existing WildcardPattern parsing (already has tests in query.rs:1853+)\n2. If sux.5.1/5.2 are implemented, add MatchType tests\n\n**Existing tests to verify**:\n- query.rs already has test_wildcard_pattern_parse() at line 1860\n- Check coverage is sufficient\n\n**Files to update if needed**:\n- tests/search_wildcards.rs (new)\n- tests/ranking.rs (new) - only if MatchType added","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-30T04:24:16.512924542Z","closed_at":"2025-11-30T04:24:16.512924542Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.1","depends_on_id":"coding_agent_session_search-sux.3.4","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7.1","depends_on_id":"coding_agent_session_search-sux.5.3","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.2","title":"A7.2: UI snapshot tests for new display features","description":"Add snapshot tests for the enhanced result display including highlighting, stripes, and borders.","notes":"**Status**: UNBLOCKED - dependency sux.6.6 is now closed (split into 6.6a-d).\n\n**Note**: sux.6.4 (toggleable borders) was removed as low-value.\nRemove border tests from scope.\n\n**Revised test scope**:\n- test_result_display_with_highlighting()\n- test_alternating_stripes()\n- test_3_line_result_layout() (revised from 6-8 lines)\n- test_relative_timestamps() (if sux.6.6a implemented)\n\n**Files to update**:\n- tests/ui_snap.rs: add new snapshot tests","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-29T22:15:17.338162494Z","closed_at":"2025-11-29T22:15:17.338162494Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.2","depends_on_id":"coding_agent_session_search-sux.6.6","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.3","title":"A7.3: Documentation updates","description":"Update README, help overlay, and inline comments to document all new features.","notes":"**Documentation updates**:\n\n1. **README.md**:\n   - Add section on wildcard search syntax\n   - Document implicit wildcard behavior\n   - Explain ranking modes\n   - Show new hotkeys (F11 borders, etc.)\n   - Screenshots of new result display\n\n2. **Help overlay** (tui.rs help_lines):\n   - Add Wildcards section: 'foo* prefix | *foo suffix | *foo* contains'\n   - Add Borders toggle hotkey\n   - Update display options section\n\n3. **Inline code comments**:\n   - Document WildcardPattern enum\n   - Document MatchType enum\n   - Document ranking formula\n\n4. **robot-docs update**:\n   - Include wildcard syntax in Commands topic\n   - Document new exit conditions\n\n**Files to modify**:\n- README.md\n- src/ui/tui.rs: help_lines function\n- src/search/query.rs: doc comments\n- src/lib.rs: robot-docs if needed","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-30T04:26:44.580474208Z","closed_at":"2025-11-30T04:26:44.580474208Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.3","depends_on_id":"coding_agent_session_search-sux.7.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"},{"issue_id":"coding_agent_session_search-sux.7.3","depends_on_id":"coding_agent_session_search-sux.7.2","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-sux.7.4","title":"A7.4: Performance validation","description":"Benchmark and validate that new features don't significantly impact search latency or rendering performance.","notes":"**Benchmarks to run/add**:\n\n1. **Wildcard query latency**:\n   - `foo*` vs `foo` (should be similar with edge-ngram)\n   - `*foo` (may be slower without reverse index)\n   - `*foo*` (may need FTS5 fallback, measure impact)\n\n2. **Fallback overhead**:\n   - Time for original + suffix + contains searches\n   - Cache hit rates with fallback\n\n3. **Rendering performance**:\n   - FPS with 6-8 lines per result vs 2 lines\n   - Stripe rendering overhead\n   - Border rendering overhead\n\n**Target budgets**:\n- Search latency: \u003c80ms (existing target)\n- Fallback total: \u003c150ms\n- Render FPS: 60fps (existing)\n\n**Files to update**:\n- benches/search_perf.rs: add wildcard benchmarks\n- benches/runtime_perf.rs: if needed\n\n**If performance issues found**:\n- Document in notes\n- Consider caching strategies\n- Consider async fallback","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-28T22:00:00Z","updated_at":"2025-11-30T04:20:58.171279293Z","closed_at":"2025-11-30T04:20:58.171279293Z","dependencies":[{"issue_id":"coding_agent_session_search-sux.7.4","depends_on_id":"coding_agent_session_search-sux.7.1","type":"blocks","created_at":"2025-11-28T22:00:00Z","created_by":"agent"}]}
{"id":"coding_agent_session_search-t7f","title":"Make TUI test helpers public","description":"Expose private functions and types in tui.rs for integration testing.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-01T22:26:15.333221-05:00","updated_at":"2025-12-01T22:28:54.687713-05:00","closed_at":"2025-12-01T22:28:54.687713-05:00"}
{"id":"coding_agent_session_search-tc1","title":"QA: testing, benchmarking, and lint gates","description":"Unit/integration tests across connectors, search, TUI; benchmarks for search latency and indexing; clippy/fmt/check gating.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-21T01:27:43.461279696Z","updated_at":"2025-11-23T14:36:56.948818554Z","closed_at":"2025-11-23T14:36:56.948818554Z","dependencies":[{"issue_id":"coding_agent_session_search-tc1","depends_on_id":"coding_agent_session_search-lz1","type":"blocks","created_at":"2025-11-21T01:27:43.479583744Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1","depends_on_id":"coding_agent_session_search-7ew","type":"blocks","created_at":"2025-11-21T01:27:43.480831347Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-21T01:27:43.482123351Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-tc1.1","title":"Connector fixtures + unit tests","description":"Create sample logs/DBs for Codex/Cline/Gemini/Claude/OpenCode/Amp and unit tests verifying normalization outputs.","notes":"Added Codex connector fixture test; TUI detail pane with selection and hotkeys (j/k, arrows) and pagination-aware selection.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:30:04.592390794Z","updated_at":"2025-11-21T18:46:26.960819415Z","closed_at":"2025-11-21T18:46:26.960819415Z","dependencies":[{"issue_id":"coding_agent_session_search-tc1.1","depends_on_id":"coding_agent_session_search-7ew.2","type":"blocks","created_at":"2025-11-21T01:30:04.593748506Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1.1","depends_on_id":"coding_agent_session_search-7ew.3","type":"blocks","created_at":"2025-11-21T01:30:04.59527532Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1.1","depends_on_id":"coding_agent_session_search-7ew.4","type":"blocks","created_at":"2025-11-21T01:30:04.59645333Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1.1","depends_on_id":"coding_agent_session_search-7ew.5","type":"blocks","created_at":"2025-11-21T01:30:04.597888443Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1.1","depends_on_id":"coding_agent_session_search-7ew.6","type":"blocks","created_at":"2025-11-21T01:30:04.600554366Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1.1","depends_on_id":"coding_agent_session_search-7ew.7","type":"blocks","created_at":"2025-11-21T01:30:04.601985279Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-tc1.2","title":"End-to-end indexing + search integration tests","description":"Spin temp home dirs with sample logs, run index --full, execute search queries, assert results \u0026 filters.","notes":"Filters UI + pagination wired in TUI; SQLite FTS5 mirror with migration/backfill + insert hooks; added Tantivy search integration test covering filters/pagination.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:30:10.025332211Z","updated_at":"2025-11-21T18:41:04.631776292Z","closed_at":"2025-11-21T18:41:04.631782792Z","dependencies":[{"issue_id":"coding_agent_session_search-tc1.2","depends_on_id":"coding_agent_session_search-974.1","type":"blocks","created_at":"2025-11-21T01:30:10.027705431Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1.2","depends_on_id":"coding_agent_session_search-lz1.4","type":"blocks","created_at":"2025-11-21T01:30:10.028537538Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-tc1.3","title":"TUI interaction tests (snapshot/help/hotkeys)","description":"Use ratatui testing harness or scripted input to snapshot help screen, hotkey handling, empty/error states.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:30:13.251343357Z","updated_at":"2025-11-23T14:36:12.48502369Z","closed_at":"2025-11-23T14:36:12.48502369Z","dependencies":[{"issue_id":"coding_agent_session_search-tc1.3","depends_on_id":"coding_agent_session_search-6hx.2","type":"blocks","created_at":"2025-11-21T01:30:13.252115063Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-tc1.4","title":"Performance benchmarks (search latency, indexing throughput)","description":"Criterion/hyperfine benchmarks for search-as-you-type, full index build time, memory footprint, with target budgets (\u003c80ms).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-21T01:30:16.652183469Z","updated_at":"2025-11-23T14:36:04.163833834Z","closed_at":"2025-11-23T14:36:04.163833834Z","dependencies":[{"issue_id":"coding_agent_session_search-tc1.4","depends_on_id":"coding_agent_session_search-lz1.2","type":"blocks","created_at":"2025-11-21T01:30:16.65396028Z","created_by":"daemon"},{"issue_id":"coding_agent_session_search-tc1.4","depends_on_id":"coding_agent_session_search-974.1","type":"blocks","created_at":"2025-11-21T01:30:16.656398195Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-tc1.5","title":"Lint/format/check gating (nightly)","description":"Set up cargo fmt --check, cargo clippy --all-targets -D warnings, cargo check --all-targets on nightly; add CI jobs.","status":"closed","priority":1,"issue_type":"task","created_at":"2025-11-21T01:30:22.444966077Z","updated_at":"2025-11-23T14:34:52.211534721Z","closed_at":"2025-11-23T14:34:52.211534721Z","dependencies":[{"issue_id":"coding_agent_session_search-tc1.5","depends_on_id":"coding_agent_session_search-acz.1","type":"blocks","created_at":"2025-11-21T01:30:22.447617177Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-tst","title":"Comprehensive Test Coverage Epic","description":"Master epic for achieving comprehensive test coverage across the entire codebase.\n\n## Goals\n- Unit tests for all modules without mocks (real fixture data)\n- E2E integration tests with detailed logging\n- Property-based testing for parser edge cases\n- Performance baseline tests\n\n## Dependencies\n- All tst.* beads depend on tst.inf (infrastructure)\n- E2E tests depend on unit tests being stable\n\n## Success Criteria\n- \u003e80% line coverage\n- All critical paths have E2E tests\n- Tests run in \u003c2 minutes total","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.339620797Z","updated_at":"2025-11-30T15:05:19.339620797Z"}
{"id":"coding_agent_session_search-tst.cli","title":"CLI Command Tests","description":"Integration tests for CLI subcommands. Coverage: all subcommands tested, argument parsing edge cases, exit codes correct, output format validation.","status":"in_progress","priority":0,"issue_type":"task","assignee":"WhiteCreek","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-01T02:21:29.48301031Z","comments":[{"id":11,"issue_id":"coding_agent_session_search-tst.cli","author":"ubuntu","text":"Starting CLI command tests bead: goal is to broaden coverage beyond search to stats/diag/status/view with JSON/robot output and error paths. Will reuse cli_robot suite; will keep TUI untouched.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-tst.cli.index","title":"Index Command Tests","description":"Test cass index CLI behavior. Cases: full index creates DB, --force rebuilds, --watch starts watch mode, --connectors filters, progress output, error handling. Exit codes: 0 success, 1 error.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T19:34:44.092811996Z","closed_at":"2025-12-01T19:34:44.092811996Z"}
{"id":"coding_agent_session_search-tst.cli.misc","title":"View/Stats/Diag Command Tests","description":"Test miscellaneous CLI commands. Commands: cass view \u003cid\u003e, cass stats, cass diag. Cases: view existing/non-existent, stats empty/populated index, diag detects common issues.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:46:46.61106-05:00","closed_at":"2025-12-01T18:46:46.61106-05:00"}
{"id":"coding_agent_session_search-tst.cli.search","title":"Search Command Tests","description":"Test cass search CLI behavior. Cases: basic search returns results, --json valid JSON, --limit respected, filter flags work, empty results empty array, invalid query shows error. Exit codes: 0 success, 1 error.","status":"in_progress","priority":0,"issue_type":"task","assignee":"WhiteCreek","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T00:21:09.378724558Z","comments":[{"id":12,"issue_id":"coding_agent_session_search-tst.cli.search","author":"ubuntu","text":"Implemented agent-filter and offset coverage in CLI search tests (tests/cli_robot.rs); reused existing fixture index, clippy/check clean.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-tst.con","title":"Connector Unit Tests","description":"Unit tests for each connector's parsing logic. Coverage: every connector type, edge cases (empty, malformed, missing fields), timestamp parsing. 13 subtasks for each connector type.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-01T19:15:54.172753649Z","closed_at":"2025-12-01T19:15:54.172753649Z"}
{"id":"coding_agent_session_search-tst.con.aider","title":"Aider Connector Tests","description":"Unit tests for Aider session parsing. Cases: markdown chat format, code blocks, git commit refs, timestamp from filename, multiple chat files. Edge: malformed markdown, missing markers, binary in code blocks.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:40:28.92946-05:00","closed_at":"2025-12-01T18:40:28.92946-05:00"}
{"id":"coding_agent_session_search-tst.con.amazon","title":"Amazon Q Connector Tests","description":"Unit tests for Amazon Q session parsing. Cases: Q chat format, code suggestions, AWS metadata. Edge: missing credentials context, truncated responses.","notes":"BLOCKED: Amazon Q connector not yet implemented","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:03:22.17844-05:00"}
{"id":"coding_agent_session_search-tst.con.amp","title":"Amp Connector Tests","description":"Unit tests for Amp (Sourcegraph) parsing. Cases: Amp conversation format, codebase context, search results. Edge: large codebase contexts, missing repo metadata.","status":"closed","priority":0,"issue_type":"task","assignee":"Claude","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:40:56.75609-05:00","closed_at":"2025-12-01T18:40:56.75609-05:00"}
{"id":"coding_agent_session_search-tst.con.chatgpt","title":"ChatGPT Connector Tests","description":"Unit tests for ChatGPT export parsing. Cases: conversations.json, multi-turn, timestamps, attachments metadata, custom instructions. Edge: empty conversations, deleted messages, old export formats.","notes":"BLOCKED: ChatGPT connector not yet implemented","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:03:27.303289-05:00"}
{"id":"coding_agent_session_search-tst.con.claude","title":"Claude Code Connector Tests","description":"Unit tests for Claude Code session parsing. Cases: valid session, minimal fields, missing createdAt, unicode, long messages \u003e100KB, empty conversation, date directory structure. Edge: system-only, malformed JSON, permission errors.","status":"closed","priority":0,"issue_type":"task","assignee":"Claude","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:41:01.887126-05:00","closed_at":"2025-12-01T18:41:01.887126-05:00"}
{"id":"coding_agent_session_search-tst.con.cline","title":"Cline Connector Tests","description":"Unit tests for Cline/Continue session parsing. Cases: VS Code extension format, tool results, file contexts. Edge: missing tool responses, very long contexts.","status":"closed","priority":0,"issue_type":"task","assignee":"Claude","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:41:07.012368-05:00","closed_at":"2025-12-01T18:41:07.012368-05:00"}
{"id":"coding_agent_session_search-tst.con.codex","title":"Codex Connector Tests","description":"Unit tests for Codex session parsing. Cases: JSONL format, streaming format, timestamp formats, multi-file sessions, tool use messages. Edge: incomplete JSONL, mixed formats, large sessions \u003e1000 messages.","status":"closed","priority":0,"issue_type":"task","assignee":"Claude","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:41:12.154152-05:00","closed_at":"2025-12-01T18:41:12.154152-05:00"}
{"id":"coding_agent_session_search-tst.con.cursor","title":"Cursor Connector Tests","description":"Unit tests for Cursor session parsing. Cases: workspace state format, inline completions, chat sessions, file context. Edge: corrupted state, missing workspace context.","notes":"Cursor connector not yet implemented - tests blocked until connector exists","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:48:41.597741-05:00"}
{"id":"coding_agent_session_search-tst.con.gemini","title":"Gemini Connector Tests","description":"Unit tests for Gemini CLI parsing. Cases: Gemini chat format, multi-modal responses, safety ratings. Edge: blocked responses, empty turns.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:35:53.558755-05:00","closed_at":"2025-12-01T18:35:53.558755-05:00"}
{"id":"coding_agent_session_search-tst.con.goose","title":"Goose Connector Tests","description":"Unit tests for Goose AI parsing. Cases: Goose session format, tool executions, timestamps. Edge: failed tool executions, nested tool calls.","notes":"BLOCKED: Goose connector not yet implemented","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:03:32.444862-05:00"}
{"id":"coding_agent_session_search-tst.con.kodu","title":"Kodu Connector Tests","description":"Unit tests for Kodu AI parsing. Cases: Kodu chat format, code generation results, project context. Edge: incomplete generations, large contexts.","notes":"BLOCKED: Kodu connector not yet implemented","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:03:37.569093-05:00"}
{"id":"coding_agent_session_search-tst.con.xcode","title":"Xcode Connector Tests","description":"Unit tests for Xcode AI parsing. Cases: Xcode assistant format, Swift/ObjC context, build errors. Edge: missing project context, binary plist formats.","notes":"BLOCKED: Xcode connector not yet implemented","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:03:42.689917-05:00"}
{"id":"coding_agent_session_search-tst.con.zed","title":"Zed Connector Tests","description":"Unit tests for Zed assistant parsing. Cases: conversation format, context attachments, timestamps. Edge: empty state, invalid JSON.","notes":"BLOCKED: Zed connector not yet implemented","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:03:47.811793-05:00"}
{"id":"coding_agent_session_search-tst.e2e","title":"E2E Pipeline Tests","description":"End-to-end tests covering the full index-\u003esearch-\u003edisplay pipeline. Each E2E test: create fixture data in temp dir, run cass index with logging, run cass search and verify, clean up. Subtasks: multi-connector, incremental, filter combos, cache behavior, watch mode extended.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-01T23:03:41.010614-05:00","closed_at":"2025-12-01T23:03:41.010614-05:00"}
{"id":"coding_agent_session_search-tst.e2e.cache","title":"Query Cache E2E Test","description":"Test query caching behavior with detailed logging. Scenario: index, search twice (cache hit), modify session, search again (cache invalidated). Log assertions for cache miss/hit/invalidation messages.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:48:23.710909-05:00","closed_at":"2025-12-01T18:48:23.710909-05:00"}
{"id":"coding_agent_session_search-tst.e2e.filt","title":"Filter Combinations E2E Test","description":"Test all filter combinations work correctly end-to-end. Create sessions with known connectors, timestamps, working dirs. Test: connector:claude, after:date, before:date, path:dir, combined filters. Assert correct counts and session IDs.","status":"in_progress","priority":0,"issue_type":"task","assignee":"BlackPond","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T21:33:38.041134-05:00"}
{"id":"coding_agent_session_search-tst.e2e.incr","title":"Incremental Indexing E2E Test","description":"Test that incremental indexing only processes new/modified sessions. Scenario: create 5 sessions, full index, add 2 new, run again. Verify: only 2 re-indexed, existing untouched, search returns all 7.","notes":"Writing platform-independent incremental indexing E2E test","status":"in_progress","priority":0,"issue_type":"task","assignee":"GreenMountain","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T19:33:20.924793-05:00"}
{"id":"coding_agent_session_search-tst.e2e.multi","title":"Multi-Connector E2E Test","description":"Test indexing sessions from multiple connectors simultaneously. Scenario: 3 Claude Code + 2 Codex + 2 Aider + 1 ChatGPT sessions. Verify: all 8 indexed, search works across all, connector filter returns correct subsets. Log assertions for per-connector counts.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:02:29.460944-05:00","closed_at":"2025-12-02T00:02:29.460944-05:00"}
{"id":"coding_agent_session_search-tst.e2e.watch","title":"Watch Mode E2E Tests (Extended)","description":"Extend existing watch_e2e.rs with more scenarios: multiple rapid file changes (debounce), cross-connector watch, delete detection/removal, error recovery on corrupt file. Build on existing basic smoke test.","notes":"Added extended watch-mode E2E coverage: multi-connector watch_once (Codex+Claude), rapid consecutive change handling (timestamp monotonic), corrupt file resilience, and state file assertions. Tests in tests/watch_e2e.rs; ran cargo test --test watch_e2e.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T22:22:39.105924-05:00","closed_at":"2025-12-01T22:22:39.105927-05:00"}
{"id":"coding_agent_session_search-tst.err","title":"Error Handling Tests","description":"Tests for graceful error handling throughout. Coverage: all error paths tested, user-friendly messages, no panics on bad input, proper cleanup on errors.","status":"in_progress","priority":0,"issue_type":"task","assignee":"WhiteCreek","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-01T01:39:42.903091501Z","comments":[{"id":13,"issue_id":"coding_agent_session_search-tst.err","author":"ubuntu","text":"Starting error-handling tests bead: will add CLI/error-path coverage for missing index, bad paths, and JSON error contracts; targeting existing cli_robot and possibly new small tests if needed.","created_at":"2025-12-01T23:22:10Z"},{"id":14,"issue_id":"coding_agent_session_search-tst.err","author":"ubuntu","text":"Added error-path coverage in tests/cli_robot.rs: missing-index JSON error contracts for search and stats using empty data-dir. All CLI robot tests passing (31/31).","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-tst.err.fs","title":"Filesystem Error Tests","description":"Test handling of filesystem errors. Cases: permission denied, disk full during index, file deleted mid-read, symlink loops, network filesystem timeouts. Expected: clear error message with path, skip problematic file, log warning don't crash.","status":"closed","priority":0,"issue_type":"task","assignee":"PinkPond","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T23:05:29.524027-05:00","closed_at":"2025-12-01T23:05:29.524027-05:00"}
{"id":"coding_agent_session_search-tst.err.parse","title":"Parsing Error Tests","description":"Test handling of malformed input files. Cases: invalid JSON, missing required fields, wrong field types, truncated files, binary in text fields, invalid UTF-8. Expected: parse error logged with context, session skipped, summary shows skipped count.","notes":"Added 18 comprehensive parsing error tests in tests/parse_errors.rs. Tests cover: Claude Code (invalid JSON, missing fields, wrong types, truncated, binary content, invalid UTF-8, empty files, whitespace-only), Gemini (invalid JSON, missing messages, wrong types), Codex (invalid JSON, missing events), Cline (invalid JSON, missing task history), and cross-connector tests (recovery from bad files, extremely long content, deeply nested JSON). All tests passing.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T19:03:03.398052-05:00","closed_at":"2025-12-01T19:03:03.398054-05:00"}
{"id":"coding_agent_session_search-tst.idx","title":"Indexer/Tantivy Tests","description":"Unit tests for Tantivy full-text index operations. Coverage: index creation/schema, document insertion, incremental updates, corruption recovery.","status":"in_progress","priority":0,"issue_type":"task","assignee":"WhiteCreek","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-01T01:45:02.050190388Z","comments":[{"id":15,"issue_id":"coding_agent_session_search-tst.idx","author":"ubuntu","text":"Added Tantivy index tests in tests/indexer_tantivy.rs: schema hash write, reuse when hash matches (no dir wipe), rebuild on mismatch. Tests pass. Note: clippy currently failing due to update_check placeholders in src/ui/tui.rs (bead 018) — left untouched.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-tst.idx.corrupt","title":"Index Corruption Handling Tests","description":"Test graceful handling of corrupted index files. Cases: truncated segment, missing meta.json, invalid checksums, locked directory. Expected: detect on open, clear error log, offer rebuild, no panic.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T22:48:10.220858-05:00","closed_at":"2025-12-01T22:48:10.220858-05:00"}
{"id":"coding_agent_session_search-tst.idx.incr","title":"Incremental Index Tests","description":"Test incremental index update logic. Cases: add new docs, update existing, delete docs, mixed add/update/delete batch. Assert: only changed docs re-indexed, search reflects updates, no orphans.","status":"in_progress","priority":0,"issue_type":"task","assignee":"WhiteCreek","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T02:34:25.27703971Z"}
{"id":"coding_agent_session_search-tst.idx.rebuild","title":"Full Index Rebuild Tests","description":"Test complete index rebuild scenarios. Cases: build from empty, rebuild existing (--force), verify all docs searchable, schema consistency. Assert: doc count matches sessions, all fields indexed, commit completes.","status":"closed","priority":0,"issue_type":"task","assignee":"PinkPond","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T22:57:41.467483-05:00","closed_at":"2025-12-01T22:57:41.467483-05:00"}
{"id":"coding_agent_session_search-tst.inf","title":"Test Infrastructure Foundation","description":"Build reusable test infrastructure before writing specific tests.\n\n## Components Needed\n1. **Fixture Factory** (tst.inf.fix)\n   - Deterministic session generators for each connector\n   - Configurable message counts, timestamps, content patterns\n   \n2. **Log Assertion Macros** (tst.inf.log)\n   - Capture tracing spans during test execution\n   - Assert on log messages, levels, and structured fields\n   \n3. **Result Assertion Helpers** (tst.inf.res)\n   - Fluent API for checking SearchHit fields\n   - Batch assertions for result ordering\n   \n4. **Documentation** (tst.inf.doc)\n   - Test writing guide with examples\n   - Coverage tracking dashboard","status":"in_progress","priority":0,"issue_type":"task","assignee":"WhiteCreek","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-01T00:06:26.806502476Z","comments":[{"id":16,"issue_id":"coding_agent_session_search-tst.inf","author":"ubuntu","text":"Starting implementation: extending tests/util/mod.rs with fixture builder for conversations/messages plus SearchHit assertion helpers and improved log capture helpers.","created_at":"2025-12-01T23:22:10Z"},{"id":17,"issue_id":"coding_agent_session_search-tst.inf","author":"ubuntu","text":"Progress update: added ConversationFixtureBuilder snippet support (Normalized+storage), connector preset helpers, SearchHit assertion helpers, and log assertion macros; clippy now clean. Fixed pre-existing animation warnings in ui/tui.rs.","created_at":"2025-12-01T23:22:10Z"}]}
{"id":"coding_agent_session_search-tst.inf.doc","title":"Test Documentation","description":"Document test patterns and coverage tracking. Deliverables: docs/testing.md with fixture factory usage, log assertions, E2E test patterns. CI: add cargo-llvm-cov, generate coverage badges, track trends.","status":"open","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-11-30T15:05:19.350975688Z"}
{"id":"coding_agent_session_search-tst.inf.fix","title":"Fixture Factory Module","description":"Create deterministic session generators for all connector types. Implementation: FixtureBuilder with claude_code(), codex(), aider() etc. methods, with_messages(count), with_timestamp_range(start, end), build_temp_dir(). Tests: verify fixtures parse correctly, timestamps deterministic, content matches patterns.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T19:35:47.495995-05:00","closed_at":"2025-12-01T19:35:47.495995-05:00"}
{"id":"coding_agent_session_search-tst.inf.log","title":"Log Assertion Macros","description":"Create macros for asserting on tracing output during tests. Implementation: LogCapture struct with assert_contains(level, msg), assert_span_entered(name), assert_field(span, field, value). Macro assert_logged!(capture, level, msg).","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:45:43.932092-05:00","closed_at":"2025-12-01T18:45:43.932092-05:00"}
{"id":"coding_agent_session_search-tst.inf.res","title":"Result Assertion Helpers","description":"Create fluent API for checking SearchHit results. Trait SearchResultAssertions with assert_count(n), assert_first_contains(text), assert_ordered_by_score(), assert_all_from_connector(conn), assert_timestamps_in_range(start, end).","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:46:06.281623-05:00","closed_at":"2025-12-01T18:46:06.281623-05:00"}
{"id":"coding_agent_session_search-tst.perf","title":"Performance Baseline Tests","description":"Establish and verify performance baselines. Coverage: indexing speed benchmarks, search latency benchmarks, memory usage limits, regression detection. Use criterion for benchmarks, store baselines in repo.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-02T00:02:34.599064-05:00","closed_at":"2025-12-02T00:02:34.599064-05:00"}
{"id":"coding_agent_session_search-tst.perf.idx","title":"Indexing Performance Benchmarks","description":"Establish baseline for indexing performance. Benchmarks: 100 sessions \u003c1s, 1000 sessions \u003c5s, 10000 sessions \u003c30s, memory \u003c500MB. Use criterion with FixtureBuilder.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:02:39.718454-05:00","closed_at":"2025-12-02T00:02:39.718454-05:00"}
{"id":"coding_agent_session_search-tst.perf.srch","title":"Search Latency Benchmarks","description":"Establish baseline for search performance. Benchmarks: simple term \u003c10ms, phrase \u003c20ms, wildcard \u003c50ms, complex filter \u003c30ms, cold cache \u003c100ms. Use criterion.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:02:44.844093-05:00","closed_at":"2025-12-02T00:02:44.844093-05:00"}
{"id":"coding_agent_session_search-tst.srch","title":"Search/Query Tests","description":"Unit tests for search query parsing and execution. Coverage: query parser edge cases, wildcard fallback, concurrent search, FTS5 query generation.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-02T00:02:14.07815-05:00","closed_at":"2025-12-02T00:02:14.07815-05:00"}
{"id":"coding_agent_session_search-tst.srch.conc","title":"Concurrent Search Tests","description":"Test search behavior under concurrent load. Cases: 10 simultaneous searches, search during indexing, cache contention, reader handle exhaustion. Assert: all return correct results, no deadlocks, reasonable latency.","status":"closed","priority":0,"issue_type":"task","assignee":"PurpleHill","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T21:27:09.981303-05:00","closed_at":"2025-12-01T21:27:09.981303-05:00"}
{"id":"coding_agent_session_search-tst.srch.fts","title":"FTS5 Query Generation Tests","description":"Test SQL/FTS5 query generation from search input. Cases: simple term, phrase, boolean AND/OR, prefix search, filter integration, special char escape. Assert: valid SQL, injection escaped, complex queries parse.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:57:36.79196-05:00","closed_at":"2025-12-01T18:57:36.79196-05:00"}
{"id":"coding_agent_session_search-tst.srch.wild","title":"Wildcard Fallback Tests","description":"Test implicit wildcard fallback for sparse results (sux.4). Cases: exact match returns results (no fallback), exact empty (fallback triggered), explicit wildcard (no double), multi-word fallback, filter+wildcard combo.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T18:29:11.107526-05:00","closed_at":"2025-12-01T18:29:11.107526-05:00"}
{"id":"coding_agent_session_search-tst.sto","title":"Storage/SQLite Tests","description":"Unit tests for SQLite storage layer. Coverage: schema migrations, concurrent access, large batch operations, FTS5 behavior.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-02T00:02:19.201236-05:00","closed_at":"2025-12-02T00:02:19.201236-05:00"}
{"id":"coding_agent_session_search-tst.sto.batch","title":"Large Batch Operation Tests","description":"Test performance and correctness of large batch operations. Cases: insert 10K sessions in single tx, bulk update, bulk delete with cascades, FTS5 re-index. Assert: \u003c5s completion, no memory leaks, all persisted.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:03:17.026241-05:00","closed_at":"2025-12-02T00:03:17.026241-05:00"}
{"id":"coding_agent_session_search-tst.sto.conc","title":"Concurrent Access Tests","description":"Test database behavior under concurrent access. Cases: multiple readers + single writer, write contention, transaction isolation, connection pool behavior. Assert: all operations complete, no deadlocks.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-02T00:02:49.989942-05:00","closed_at":"2025-12-02T00:02:49.989942-05:00"}
{"id":"coding_agent_session_search-tst.sto.schema","title":"Schema Migration Tests","description":"Test database schema creation and migrations. Cases: fresh DB creation, v1-\u003ev2 migration, schema validation after migration, rollback on failure. Assert: tables/columns exist, indexes created, FTS5 configured.","notes":"Added 12 schema migration tests to tests/storage.rs. Tests cover: fresh DB creation (all 9 tables including FTS5), index creation (3 indexes), column validation for agents/conversations/messages tables, FTS5 virtual table configuration with porter tokenizer, migration from v1 to v3, migration from v2 to v3, foreign key enforcement, unique constraint enforcement, and pragma verification (WAL journal mode, foreign keys ON). All 19 storage tests passing.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T19:35:05.676523-05:00","closed_at":"2025-12-01T19:35:05.676525-05:00"}
{"id":"coding_agent_session_search-tst.ui","title":"UI/TUI Tests","description":"Tests for terminal UI components (non-interactive). Coverage: state machine transitions, render output verification, keyboard events, state persistence. Note: test state transitions and render buffer, not actual terminal.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.348006464Z","updated_at":"2025-12-02T00:02:24.324358-05:00","closed_at":"2025-12-02T00:02:24.324358-05:00"}
{"id":"coding_agent_session_search-tst.ui.bulk","title":"Bulk Selection Tests","description":"Test multi-select and bulk actions (bead 015). Cases: space toggles, Ctrl+A selects/deselects all, selection persists across panes, cleared on new search, 'A' opens bulk modal, actions execute. Assert: HashSet contents, checkmark rendered, footer count.","status":"closed","priority":0,"issue_type":"task","assignee":"PinkPond","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T22:55:03.164591-05:00","closed_at":"2025-12-01T22:55:03.164591-05:00"}
{"id":"coding_agent_session_search-tst.ui.det","title":"Detail Panel Tests","description":"Test detail view and find-in-detail functionality. Cases: opening sets correct state, find highlights matches, n/N navigate, escape closes, scroll preserved on close/reopen. Also 'o'/'p'/'s' handlers from bead 007.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T22:30:07.516593-05:00","closed_at":"2025-12-01T22:30:07.516593-05:00"}
{"id":"coding_agent_session_search-tst.ui.nav","title":"Navigation State Tests","description":"Test TUI navigation state machine. Cases: initial state first pane/item, down increments, up at top wraps, tab switches panes, page up/down by page size, home/end jump. Approach: test TuiState methods in isolation.","notes":"Added 17 navigation state tests in src/ui/tui.rs. Tests cover: context window cycling (Small→Medium→Large→XLarge→Small), density mode cycling (Compact→Cozy→Spacious→Compact), ranking mode variants, agent pane building (grouping, per-pane limit, empty input, selection initialization), pane rebuild with filter (selection maintenance, fallback behavior, scroll offset adjustment), active hit retrieval, focus region enum, match mode enum, and agent suggestions (prefix matching, case insensitivity, empty prefix). All 22 TUI tests pass.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T19:09:13.249825-05:00","closed_at":"2025-12-01T19:09:13.249827-05:00"}
{"id":"coding_agent_session_search-tst.ui.pers","title":"UI State Persistence Tests","description":"Test saving and restoring UI state. Cases: save/restore query history, save window dimensions, save last search, handle corrupted state file. Assert: valid JSON, missing fields use defaults, corrupted doesn't crash.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-11-30T15:05:19.350975688Z","updated_at":"2025-12-01T22:24:32.033529-05:00","closed_at":"2025-12-01T22:24:32.033529-05:00"}
{"id":"coding_agent_session_search-tu5","title":"bd-logging-coverage","description":"Tracing spans + log assertions for connectors/indexer/search","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:35:46.759713184Z","updated_at":"2025-11-23T20:05:45.377473529Z","closed_at":"2025-11-23T20:05:45.377473529Z","dependencies":[{"issue_id":"coding_agent_session_search-tu5","depends_on_id":"coding_agent_session_search-vbf","type":"blocks","created_at":"2025-11-23T17:35:46.761015455Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-uha","title":"P3 Density \u0026 scope controls","description":"Controls for pane density, ranking weighting, and scope presets (agents/time).","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-24T13:57:39.075699412Z","updated_at":"2025-12-01T22:19:32.001379-05:00","closed_at":"2025-12-01T22:19:32.001379-05:00","dependencies":[{"issue_id":"coding_agent_session_search-uha","depends_on_id":"coding_agent_session_search-1z2","type":"blocks","created_at":"2025-11-24T13:57:59.958866559Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-uha.1","title":"B3.1 Pane count +/-","description":"Add +/- hotkeys to change per-pane item cap; status/footer update.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:57:43.294957546Z","updated_at":"2025-11-24T14:10:05.780481913Z","closed_at":"2025-11-24T14:10:05.780481913Z"}
{"id":"coding_agent_session_search-uha.2","title":"B3.2 Recency vs score preset","description":"F12 cycles recent-heavy/balanced/relevance-heavy weighting; badge update.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:57:47.629753407Z","updated_at":"2025-11-24T14:10:05.782683638Z","closed_at":"2025-11-24T14:10:05.782683638Z"}
{"id":"coding_agent_session_search-uha.3","title":"B3.3 Scope presets","description":"Shift+F3/F4 all-agents vs active-only; Shift+F5/F6 time windows 24h/7d/30d/all.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-24T13:57:52.475697399Z","updated_at":"2025-11-24T14:10:05.784248155Z","closed_at":"2025-11-24T14:10:05.784248155Z","dependencies":[{"issue_id":"coding_agent_session_search-uha.3","depends_on_id":"coding_agent_session_search-uha.1","type":"blocks","created_at":"2025-11-24T13:57:55.599152554Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-vbf","title":"bd-tests-foundation: Test coverage gap report","description":"PLAN_TEST_GAPS.md gap doc; baseline done.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T17:34:58.091205831Z","updated_at":"2025-11-23T20:06:14.673297846Z","closed_at":"2025-11-23T20:06:14.673297846Z"}
{"id":"coding_agent_session_search-vdm","title":"P7.9 Test robot-docs provenance output","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T12:56:44.762755-05:00","updated_at":"2025-12-16T12:56:44.762755-05:00","dependencies":[{"issue_id":"coding_agent_session_search-vdm","depends_on_id":"coding_agent_session_search-yqb","type":"blocks","created_at":"2025-12-16T12:57:19.149011-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-vhw","title":"Implement Agent-Friendly CLI Fuzzy Matching","description":"Add logic to intercept CLI parsing errors, attempt to correct typos/syntax (fuzzy flags, implicit search), and execute with a guidance note.","status":"closed","priority":0,"issue_type":"task","created_at":"2025-12-01T23:04:01.840057-05:00","updated_at":"2025-12-01T23:05:30.671851-05:00","closed_at":"2025-12-01T23:05:30.671851-05:00"}
{"id":"coding_agent_session_search-xgx","title":"bd-first-run-index","description":"Add --quickstart flag to run index --full after install (optional prompt in normal mode); use demo fixtures or detected roots; respect easy-mode auto-run.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:31.835906666Z","updated_at":"2025-11-23T20:20:34.31961958Z","closed_at":"2025-11-23T20:20:34.31961958Z","dependencies":[{"issue_id":"coding_agent_session_search-xgx","depends_on_id":"coding_agent_session_search-2d0","type":"blocks","created_at":"2025-11-23T20:14:31.837948186Z","created_by":"daemon"}]}
{"id":"coding_agent_session_search-xxu","title":"TUI performance polish","description":"Debounce tuning, skeleton loaders, async conversation fetch, and search-in-progress indicator for smoother UX.","status":"closed","priority":3,"issue_type":"task","created_at":"2025-11-23T07:51:34.343271699Z","updated_at":"2025-11-23T07:55:57.029724965Z","closed_at":"2025-11-23T07:55:57.029724965Z","labels":["performance","ui"],"dependencies":[{"issue_id":"coding_agent_session_search-xxu","depends_on_id":"coding_agent_session_search-6hx","type":"blocks","created_at":"2025-11-23T07:51:34.353039745Z","created_by":"ubuntu"}]}
{"id":"coding_agent_session_search-y79","title":"P5.3 cass sources list command","description":"# P5.3 cass sources list command\n\n## Overview\nImplement the `cass sources list` command to display configured sources\nand their sync status.\n\n## Implementation Details\n\n### CLI Definition\n```rust\n#[derive(Parser)]\npub enum SourcesCommand {\n    /// List configured sources\n    List {\n        /// Show detailed information\n        #[arg(long, short)]\n        verbose: bool,\n        \n        /// Output format (table, json, robot)\n        #[arg(long, default_value = \"table\")]\n        format: OutputFormat,\n    },\n    // ...\n}\n```\n\n### Table Output\n```\nNAME         TYPE   HOST                 PATHS  LAST SYNC            STATUS\nlaptop       ssh    user@laptop.local    3      2024-01-15 10:30     ✓ synced\nworkstation  ssh    user@work.example    2      2024-01-14 15:00     ! stale\nlocal        local  -                    5      -                    ✓ active\n```\n\n### Sync Status Tracking\nStore last sync info in a separate file:\n```rust\n// ~/.local/share/cass/sync_status.json\n#[derive(Serialize, Deserialize)]\nstruct SyncStatus {\n    sources: HashMap\u003cString, SourceSyncInfo\u003e,\n}\n\n#[derive(Serialize, Deserialize)]\nstruct SourceSyncInfo {\n    last_sync: Option\u003cDateTime\u003cUtc\u003e\u003e,\n    last_result: SyncResult,\n    sessions_synced: u32,\n}\n\n#[derive(Serialize, Deserialize)]\nenum SyncResult {\n    Success,\n    PartialFailure(String),\n    Failed(String),\n}\n```\n\n### Verbose Output\n```\nSource: laptop\n  Type: ssh\n  Host: user@laptop.local\n  Paths:\n    - ~/.claude/projects (exists)\n    - ~/.cursor/projects (exists)\n    - ~/.config/goose (not found)\n  Last Sync: 2024-01-15 10:30:00 UTC\n  Sessions Synced: 47\n  Local Storage: ~/.local/share/cass/remotes/laptop/\n  Status: ✓ synced\n```\n\n## Dependencies\n- Requires P5.1 (config types)\n\n## Acceptance Criteria\n- [ ] List shows all configured sources\n- [ ] Sync status accurate and timestamped\n- [ ] JSON output for scripting\n- [ ] Verbose mode shows full details","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:07:37.422446-05:00","updated_at":"2025-12-16T14:23:04.83925-05:00","closed_at":"2025-12-16T14:23:04.83925-05:00","close_reason":"Implemented sources list command with table, verbose, and JSON output modes","dependencies":[{"issue_id":"coding_agent_session_search-y79","depends_on_id":"coding_agent_session_search-luj","type":"blocks","created_at":"2025-12-16T01:08:57.534431-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-yb4","title":"P5.4 rsync-based sync engine","description":"# P5.4 rsync-based sync engine\n\n## Overview\nImplement the core sync engine that pulls sessions from remote sources\nusing rsync over SSH for efficient delta transfer, with SFTP fallback.\n\n## IMPORTANT SAFETY RULE\n**NEVER use rsync `--delete` by default** - this could accidentally delete\nlocal data if the remote is misconfigured or temporarily empty.\n\n## Implementation Details\n\n### Sync Engine Structure\nCreate `src/sources/sync.rs`:\n```rust\npub struct SyncEngine {\n    config: SourcesConfig,\n    local_store: PathBuf,  // ~/.local/share/cass/remotes/\n}\n\npub enum SyncMethod {\n    Rsync,  // Preferred when available\n    Sftp,   // Fallback for Windows or when rsync unavailable\n}\n\nimpl SyncEngine {\n    pub fn new(config: SourcesConfig) -\u003e Self {\n        let local_store = dirs::data_local_dir()\n            .unwrap_or_else(|| PathBuf::from(\"~/.local/share\"))\n            .join(\"cass/remotes\");\n        Self { config, local_store }\n    }\n    \n    /// Detect available sync method\n    fn detect_sync_method() -\u003e SyncMethod {\n        if Command::new(\"rsync\").arg(\"--version\").output().is_ok() {\n            SyncMethod::Rsync\n        } else {\n            SyncMethod::Sftp\n        }\n    }\n    \n    async fn sync_path_rsync(\n        \u0026self,\n        source: \u0026SourceDefinition,\n        remote_path: \u0026str,\n        dest_dir: \u0026Path,\n    ) -\u003e Result\u003cPathSyncResult, SyncError\u003e {\n        let host = source.host.as_ref().ok_or(SyncError::NoHost)?;\n        let remote_spec = format!(\"{}:{}\", host, remote_path);\n        let local_path = dest_dir.join(path_to_safe_dirname(remote_path));\n        \n        // NOTE: NO --delete flag! Safe additive sync only.\n        let output = Command::new(\"rsync\")\n            .args([\n                \"-avz\",           // Archive, verbose, compress\n                \"--stats\",        // Show transfer stats\n                \"--timeout=30\",   // Connection timeout\n                \"-e\", \"ssh -o BatchMode=yes -o ConnectTimeout=10\",\n                \u0026remote_spec,\n                local_path.to_str().unwrap(),\n            ])\n            .output()\n            .await?;\n        \n        if !output.status.success() {\n            return Err(SyncError::RsyncFailed(\n                String::from_utf8_lossy(\u0026output.stderr).to_string()\n            ));\n        }\n        \n        let stats = parse_rsync_stats(\u0026String::from_utf8_lossy(\u0026output.stdout));\n        Ok(PathSyncResult {\n            files_transferred: stats.files_transferred,\n            bytes_transferred: stats.bytes_transferred,\n        })\n    }\n    \n    async fn sync_path_sftp(\n        \u0026self,\n        source: \u0026SourceDefinition,\n        remote_path: \u0026str,\n        dest_dir: \u0026Path,\n    ) -\u003e Result\u003cPathSyncResult, SyncError\u003e {\n        // SFTP fallback using russh or ssh2 crate\n        // Implementation for Windows/no-rsync environments\n        todo!(\"Implement SFTP fallback\")\n    }\n}\n```\n\n### Sync Method Selection\n```rust\npub async fn sync_source(\u0026self, source: \u0026SourceDefinition) -\u003e Result\u003cSyncReport, SyncError\u003e {\n    let method = Self::detect_sync_method();\n    let dest_dir = self.local_store.join(\u0026source.name);\n    std::fs::create_dir_all(\u0026dest_dir)?;\n    \n    let mut report = SyncReport::new(\u0026source.name, method);\n    \n    for remote_path in \u0026source.paths {\n        let result = match method {\n            SyncMethod::Rsync =\u003e self.sync_path_rsync(source, remote_path, \u0026dest_dir).await,\n            SyncMethod::Sftp =\u003e self.sync_path_sftp(source, remote_path, \u0026dest_dir).await,\n        };\n        report.add_path_result(remote_path.clone(), result);\n    }\n    \n    report\n}\n```\n\n### Error Recovery\n```rust\nimpl SyncEngine {\n    /// Sync continues even if individual paths fail\n    pub async fn sync_all(\u0026self) -\u003e Vec\u003cSyncReport\u003e {\n        let mut reports = Vec::new();\n        \n        for source in \u0026self.config.sources {\n            match self.sync_source(source).await {\n                Ok(report) =\u003e reports.push(report),\n                Err(e) =\u003e reports.push(SyncReport::failed(\u0026source.name, e)),\n            }\n        }\n        \n        reports\n    }\n}\n```\n\n## Dependencies\n- Requires P5.1 (config types)\n- Foundation for P5.5 (sync command)\n\n## Acceptance Criteria\n- [ ] rsync invoked WITHOUT --delete (safe additive sync)\n- [ ] SFTP fallback when rsync unavailable\n- [ ] Delta transfer works (only changed files transferred)\n- [ ] Progress shown during sync\n- [ ] Individual path failures don't abort entire sync\n- [ ] Transfer stats captured and reported\n- [ ] Timeouts prevent hanging on unreachable hosts","status":"open","priority":1,"issue_type":"task","created_at":"2025-12-16T01:07:43.837391-05:00","updated_at":"2025-12-16T01:25:38.593953-05:00","dependencies":[{"issue_id":"coding_agent_session_search-yb4","depends_on_id":"coding_agent_session_search-luj","type":"blocks","created_at":"2025-12-16T01:09:02.789611-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-yln","title":"TST Epic: Full test coverage (unit+e2e, no mocks)","description":"Establish comprehensive test coverage without mocks/fakes; strengthen e2e scripts with detailed logging across CLI/TUI/index/install/watch.","status":"closed","priority":2,"issue_type":"epic","created_at":"2025-11-30T06:50:07.460749535Z","updated_at":"2025-12-01T23:59:26.610556-05:00","closed_at":"2025-12-01T23:59:26.610556-05:00"}
{"id":"coding_agent_session_search-yln.1","title":"TST.1 Coverage inventory + gaps (no mocks)","description":"Map modules→tests, identify untested paths, mock usage; propose real-fixture replacements; output coverage table and prioritized gaps.","notes":"Coverage inventory completed: added module→tests/mocks/gaps table and prioritized yln.2-6 actions in PLAN_TEST_GAPS.md. Clippy kept clean (fixed search_filters.rs lint).","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T06:50:17.6761251Z","updated_at":"2025-12-01T22:58:07.578794-05:00","closed_at":"2025-12-01T22:58:07.578796-05:00"}
{"id":"coding_agent_session_search-yln.2","title":"TST.2 Unit: search/query + detail find (real fixtures)","description":"Add unit coverage for search pipeline incl. cache shards, filters, wildcard fallback, detail-find highlight; use real data fixtures (no mocks) and assert logs/metrics.","notes":"Part of tst epic. Search/query + detail find unit tests with real fixtures.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-11-30T06:50:32.501941587Z","updated_at":"2025-12-01T23:59:31.738361-05:00","dependencies":[{"issue_id":"coding_agent_session_search-yln.2","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-11-30T06:50:32.516957509Z","created_by":"BrownDog"}]}
{"id":"coding_agent_session_search-yln.3","title":"TST.3 Unit: UI interactions (detail find, hotkeys, breadcrumbs)","description":"Headless ratatui snapshot/interaction tests for detail find (/ n/N), focus toggles, breadcrumbs/pane filters; ensure no mocks, rely on fixture conversations.","notes":"Part of tst epic. UI interactions (detail find, hotkeys, breadcrumbs) tests.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T06:50:43.40219962Z","updated_at":"2025-12-02T00:06:02.808446-05:00","closed_at":"2025-12-02T00:06:02.808446-05:00","dependencies":[{"issue_id":"coding_agent_session_search-yln.3","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-11-30T06:50:43.413852341Z","created_by":"BrownDog"}]}
{"id":"coding_agent_session_search-yln.4","title":"TST.4 Unit: connectors + storage (real edge fixtures)","description":"Extend connector/storage tests with real fixture logs (no mocks): malformed/partial sessions, workspace inference, timestamp parsing, append-only invariants, migration safety.","notes":"Part of tst epic. Connector/storage tests with real edge fixtures.","status":"in_progress","priority":2,"issue_type":"task","created_at":"2025-11-30T06:50:54.465984771Z","updated_at":"2025-12-01T23:59:41.983202-05:00","dependencies":[{"issue_id":"coding_agent_session_search-yln.4","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-11-30T06:50:54.475485673Z","created_by":"BrownDog"}]}
{"id":"coding_agent_session_search-yln.5","title":"TST.5 E2E: CLI/TUI flows with rich logging","description":"End-to-end scripts (robot/headless) covering query, detail find, bulk actions, filters; produce detailed logging/traces; assert outputs not mocks.","notes":"Part of tst epic. E2E CLI/TUI flows with rich logging.","status":"open","priority":2,"issue_type":"task","created_at":"2025-11-30T06:51:05.880033694Z","updated_at":"2025-12-01T23:59:47.113144-05:00","dependencies":[{"issue_id":"coding_agent_session_search-yln.5","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-11-30T06:51:05.88814398Z","created_by":"BrownDog"}]}
{"id":"coding_agent_session_search-yln.6","title":"TST.6 E2E: Install/index/watch pipeline logging","description":"Full-path e2e covering install script, index --full, watch reindex, data_dir overrides; capture detailed logs + failure traces; verify no mocks/fakes.","notes":"Part of tst epic. E2E Install/index/watch pipeline logging.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-30T06:51:20.364501984Z","updated_at":"2025-12-02T00:05:32.692671-05:00","closed_at":"2025-12-02T00:05:32.692671-05:00","dependencies":[{"issue_id":"coding_agent_session_search-yln.6","depends_on_id":"coding_agent_session_search-yln.1","type":"blocks","created_at":"2025-11-30T06:51:20.378207037Z","created_by":"BrownDog"}]}
{"id":"coding_agent_session_search-yqb","title":"P3.4 Update robot-docs output format with provenance","description":"# P3.4 Update robot-docs output format with provenance\n\n## Overview\nExtend the robot-docs output format to include provenance information so AI agents\nconsuming CASS output can understand session origins.\n\n## Implementation Details\n\n### Robot Output Extension\nThe robot-docs format produces machine-readable search results. Extend it:\n\n```markdown\n# Search Results for \"authentication bug\"\n\n## Result 1\n- **Conversation ID**: conv_abc123\n- **Agent**: claude-code\n- **Workspace**: /Users/me/projects/myapp\n- **Score**: 0.95\n- **Timestamp**: 2024-01-15T10:30:00Z\n- **Source**: laptop.local (remote)\n- **Synced At**: 2024-01-15T12:00:00Z\n\n### Snippet\n...code snippet here...\n```\n\n### Format Function Update\nIn the robot-docs formatting code:\n```rust\nfn format_robot_doc_result(hit: \u0026SearchHit) -\u003e String {\n    let mut output = String::new();\n    // ... existing fields\n    \n    // Add provenance\n    let source_label = match (\u0026hit.source_hostname, \u0026hit.source_type) {\n        (Some(host), SourceType::Remote) =\u003e format!(\"{} (remote)\", host),\n        (Some(host), SourceType::Local) =\u003e format!(\"{} (local)\", host),\n        (None, _) =\u003e \"local\".to_string(),\n    };\n    output.push_str(\u0026format!(\"- **Source**: {}\\n\", source_label));\n    \n    if let Some(synced) = \u0026hit.sync_timestamp {\n        output.push_str(\u0026format!(\"- **Synced At**: {}\\n\", synced.to_rfc3339()));\n    }\n    \n    output\n}\n```\n\n### JSON Output Extension\nFor `--format json`:\n```rust\n#[derive(Serialize)]\nstruct RobotJsonResult {\n    // ... existing\n    source_hostname: Option\u003cString\u003e,\n    source_type: String,\n    sync_timestamp: Option\u003cString\u003e,\n}\n```\n\n## Dependencies\n- Requires P3.3 (SearchHit has provenance fields)\n\n## Acceptance Criteria\n- [ ] Robot markdown output includes Source line\n- [ ] Robot JSON output includes provenance fields\n- [ ] Format consistent with existing robot-docs style\n- [ ] Backward compatible (old tools can ignore new fields)","status":"closed","priority":1,"issue_type":"task","created_at":"2025-12-16T01:03:11.261844-05:00","updated_at":"2025-12-16T12:43:39.910647-05:00","closed_at":"2025-12-16T12:43:39.910647-05:00","close_reason":"Implemented provenance fields in robot-docs output: added source_id, origin_kind, origin_host to known_fields and JSON schema, added provenance preset","dependencies":[{"issue_id":"coding_agent_session_search-yqb","depends_on_id":"coding_agent_session_search-alb","type":"blocks","created_at":"2025-12-16T01:04:27.630374-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-zcw","title":"P7.8 Test timeline --source filtering","description":"","status":"open","priority":2,"issue_type":"task","created_at":"2025-12-16T12:56:05.272064-05:00","updated_at":"2025-12-16T12:56:05.272064-05:00","dependencies":[{"issue_id":"coding_agent_session_search-zcw","depends_on_id":"coding_agent_session_search-b8b","type":"blocks","created_at":"2025-12-16T12:57:13.845886-05:00","created_by":"jemanuel"}]}
{"id":"coding_agent_session_search-zwe","title":"bd-installer-windows","description":"PowerShell installer mirroring Bash UX: easy/normal, checksum required, supports -ArtifactUrl/-Checksum/-ChecksumUrl, installs rustup nightly if missing, PATH guidance.","status":"closed","priority":2,"issue_type":"task","created_at":"2025-11-23T20:14:16.080132027Z","updated_at":"2025-11-23T20:20:26.727874223Z","closed_at":"2025-11-23T20:20:26.727874223Z","dependencies":[{"issue_id":"coding_agent_session_search-zwe","depends_on_id":"coding_agent_session_search-0mn","type":"blocks","created_at":"2025-11-23T20:14:16.081526941Z","created_by":"daemon"}]}
